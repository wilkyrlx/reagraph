import{j as re}from"./jsx-runtime-9c4ae004.js";import{g as Vt,r as I,R as yc}from"./index-1b03fe98.js";import{e as Md,T as Rd,u as Vm,c as Fm,d as Gm,i as Nm,E as jm,B as zm,f as qm,g as Bm,V as Ee,Q as Wm,L as $m,h as xt,j as De,P as Hm,k as zo,D as yt,O as Id,l as Ld,a as Ym,m as Km,n as Yl,o as Ud,F as Xm,p as Zm,q as Qm,M as ir,S as Jm,r as eg,s as tg,t as Cs,v as Qa,w as Jn,U as ng,x as rg,R as ig,y as ag,z as og,A as Cr,C as sg,G as Xt,H as lg,I as cl,J as ug,K as Vd,N as Kl,W as cg,X as fg,Y as fl,Z as dg,_ as Fd,$ as Xl,a0 as hg,a1 as pg,a2 as mg,a3 as Gd,a4 as gg,a5 as vg,a6 as dl,a7 as yg,a8 as hl,a9 as Nd,aa as bg,ab as _g,ac as wg}from"./index-27578f8f.esm-24d23efb.js";import{_ as yn}from"./extends-98964cd2.js";import{a as Eg}from"./client-449ccf6c.js";function pl(t,e,n){var r,i,a,o,s;e==null&&(e=100);function l(){var c=Date.now()-o;c<e&&c>=0?r=setTimeout(l,e-c):(r=null,n||(s=t.apply(a,i),a=i=null))}var u=function(){a=this,i=arguments,o=Date.now();var c=n&&!r;return r||(r=setTimeout(l,e)),c&&(s=t.apply(a,i),a=i=null),s};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(s=t.apply(a,i),a=i=null,clearTimeout(r),r=null)},u}pl.debounce=pl;var xg=pl;const bc=Vt(xg);function Tg(t){let{debounce:e,scroll:n,polyfill:r,offsetSize:i}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const a=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,s]=I.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=I.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),u=e?typeof e=="number"?e:e.scroll:null,c=e?typeof e=="number"?e:e.resize:null,f=I.useRef(!1);I.useEffect(()=>(f.current=!0,()=>void(f.current=!1)));const[d,h,p]=I.useMemo(()=>{const _=()=>{if(!l.current.element)return;const{left:w,top:y,width:b,height:S,bottom:E,right:x,x:A,y:V}=l.current.element.getBoundingClientRect(),F={left:w,top:y,width:b,height:S,bottom:E,right:x,x:A,y:V};l.current.element instanceof HTMLElement&&i&&(F.height=l.current.element.offsetHeight,F.width=l.current.element.offsetWidth),Object.freeze(F),f.current&&!Og(l.current.lastBounds,F)&&s(l.current.lastBounds=F)};return[_,c?bc(_,c):_,u?bc(_,u):_]},[s,i,u,c]);function g(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(_=>_.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function m(){l.current.element&&(l.current.resizeObserver=new a(p),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach(_=>_.addEventListener("scroll",p,{capture:!0,passive:!0})))}const v=_=>{!_||_===l.current.element||(g(),l.current.element=_,l.current.scrollContainers=jd(_),m())};return Ag(p,!!n),Sg(h),I.useEffect(()=>{g(),m()},[n,p,h]),I.useEffect(()=>g,[]),[v,o,d]}function Sg(t){I.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function Ag(t,e){I.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function jd(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(t);return[n,r,i].some(a=>a==="auto"||a==="scroll")&&e.push(t),[...e,...jd(t.parentElement)]}const kg=["x","y","top","bottom","left","right","width","height"],Og=(t,e)=>kg.every(n=>t[n]===e[n]);var Dg=Object.defineProperty,Cg=Object.defineProperties,Pg=Object.getOwnPropertyDescriptors,_c=Object.getOwnPropertySymbols,Mg=Object.prototype.hasOwnProperty,Rg=Object.prototype.propertyIsEnumerable,wc=(t,e,n)=>e in t?Dg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ec=(t,e)=>{for(var n in e||(e={}))Mg.call(e,n)&&wc(t,n,e[n]);if(_c)for(var n of _c(e))Rg.call(e,n)&&wc(t,n,e[n]);return t},Ig=(t,e)=>Cg(t,Pg(e));function zd(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const i=zd(r,e,n);if(i)return i;r=e?null:r.sibling}}function qd(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const Zl=qd(I.createContext(null));class Bd extends I.Component{render(){return I.createElement(Zl.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:xc,ReactCurrentDispatcher:Tc}=I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Lg(){const t=I.useContext(Zl);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=I.useId();return I.useMemo(()=>{for(const r of[xc==null?void 0:xc.current,t,t==null?void 0:t.alternate]){if(!r)continue;const i=zd(r,!1,a=>{let o=a.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[t,e])}function Ug(){var t,e;const n=Lg(),[r]=I.useState(()=>new Map);r.clear();let i=n;for(;i;){const a=(t=i.type)==null?void 0:t._context;a&&a!==Zl&&!r.has(a)&&r.set(a,(e=Tc==null?void 0:Tc.current)==null?void 0:e.readContext(qd(a))),i=i.return}return r}function Vg(){const t=Ug();return I.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>I.createElement(e,null,I.createElement(n.Provider,Ig(Ec({},r),{value:t.get(n)}))),e=>I.createElement(Bd,Ec({},e))),[t])}const Ps={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Fg(t){const{handlePointer:e}=Bm(t);return{priority:1,enabled:!0,compute(n,r,i){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Ps).reduce((n,r)=>({...n,[r]:e(r)}),{}),update:()=>{var n;const{events:r,internal:i}=t.getState();(n=i.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:n=>{var r;const{set:i,events:a}=t.getState();a.disconnect==null||a.disconnect(),i(o=>({events:{...o.events,connected:n}})),Object.entries((r=a.handlers)!=null?r:[]).forEach(([o,s])=>{const[l,u]=Ps[o];n.addEventListener(l,s,{passive:u})})},disconnect:()=>{const{set:n,events:r}=t.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([a,o])=>{if(r&&r.connected instanceof HTMLElement){const[s]=Ps[a];r.connected.removeEventListener(s,o)}}),n(a=>({events:{...a.events,connected:void 0}}))}}}}const Gg=I.forwardRef(function({children:e,fallback:n,resize:r,style:i,gl:a,events:o=Fg,eventSource:s,eventPrefix:l,shadows:u,linear:c,flat:f,legacy:d,orthographic:h,frameloop:p,dpr:g,performance:m,raycaster:v,camera:_,onPointerMissed:w,onCreated:y,...b},S){I.useMemo(()=>Md(Rd),[]);const E=Vg(),[x,A]=Tg({scroll:!0,debounce:{scroll:50,resize:0},...r}),V=I.useRef(null),F=I.useRef(null);I.useImperativeHandle(S,()=>V.current);const P=Vm(w),[N,W]=I.useState(!1),[H,L]=I.useState(!1);if(N)throw N;if(H)throw H;const G=I.useRef(null);Fm(()=>{const q=V.current;A.width>0&&A.height>0&&q&&(G.current||(G.current=Gm(q)),G.current.configure({gl:a,events:o,shadows:u,linear:c,flat:f,legacy:d,orthographic:h,frameloop:p,dpr:g,performance:m,raycaster:v,camera:_,size:A,onPointerMissed:(...$)=>P.current==null?void 0:P.current(...$),onCreated:$=>{$.events.connect==null||$.events.connect(s?Nm(s)?s.current:s:F.current),l&&$.setEvents({compute:(R,O)=>{const D=R[l+"X"],T=R[l+"Y"];O.pointer.set(D/O.size.width*2-1,-(T/O.size.height)*2+1),O.raycaster.setFromCamera(O.pointer,O.camera)}}),y==null||y($)}}),G.current.render(I.createElement(E,null,I.createElement(jm,{set:L},I.createElement(I.Suspense,{fallback:I.createElement(zm,{set:W})},e)))))}),I.useEffect(()=>{const q=V.current;if(q)return()=>qm(q)},[]);const B=s?"none":"auto";return I.createElement("div",yn({ref:F,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:B,...i}},b),I.createElement("div",{ref:x,style:{width:"100%",height:"100%"}},I.createElement("canvas",{ref:V,style:{display:"block"}},n)))}),Ng=I.forwardRef(function(e,n){return I.createElement(Bd,null,I.createElement(Gg,yn({},e,{ref:n})))});function jg(t){const e=+this._x.call(null,t);return Wd(this.cover(e),e,t)}function Wd(t,e,n){if(isNaN(e))return t;var r,i=t._root,a={data:n},o=t._x0,s=t._x1,l,u,c,f,d;if(!i)return t._root=a,t;for(;i.length;)if((c=e>=(l=(o+s)/2))?o=l:s=l,r=i,!(i=i[f=+c]))return r[f]=a,t;if(u=+t._x.call(null,i.data),e===u)return a.next=i,r?r[f]=a:t._root=a,t;do r=r?r[f]=new Array(2):t._root=new Array(2),(c=e>=(l=(o+s)/2))?o=l:s=l;while((f=+c)==(d=+(u>=l)));return r[d]=i,r[f]=a,t}function zg(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e);let r=1/0,i=-1/0;for(let a=0,o;a<e;++a)isNaN(o=+this._x.call(null,t[a]))||(n[a]=o,o<r&&(r=o),o>i&&(i=o));if(r>i)return this;this.cover(r).cover(i);for(let a=0;a<e;++a)Wd(this,n[a],t[a]);return this}function qg(t){if(isNaN(t=+t))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(t))+1;else{for(var r=n-e||1,i=this._root,a,o;e>t||t>=n;)switch(o=+(t<e),a=new Array(2),a[o]=i,i=a,r*=2,o){case 0:n=e+r;break;case 1:e=n-r;break}this._root&&this._root.length&&(this._root=i)}return this._x0=e,this._x1=n,this}function Bg(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Wg(t){return arguments.length?this.cover(+t[0][0]).cover(+t[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Cn(t,e,n){this.node=t,this.x0=e,this.x1=n}function $g(t,e){var n,r=this._x0,i,a,o=this._x1,s=[],l=this._root,u,c;for(l&&s.push(new Cn(l,r,o)),e==null?e=1/0:(r=t-e,o=t+e);u=s.pop();)if(!(!(l=u.node)||(i=u.x0)>o||(a=u.x1)<r))if(l.length){var f=(i+a)/2;s.push(new Cn(l[1],f,a),new Cn(l[0],i,f)),(c=+(t>=f))&&(u=s[s.length-1],s[s.length-1]=s[s.length-1-c],s[s.length-1-c]=u)}else{var d=Math.abs(t-+this._x.call(null,l.data));d<e&&(e=d,r=t-d,o=t+d,n=l.data)}return n}function Hg(t){if(isNaN(l=+this._x.call(null,t)))return this;var e,n=this._root,r,i,a,o=this._x0,s=this._x1,l,u,c,f,d;if(!n)return this;if(n.length)for(;;){if((c=l>=(u=(o+s)/2))?o=u:s=u,e=n,!(n=n[f=+c]))return this;if(!n.length)break;e[f+1&1]&&(r=e,d=f)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[f]=a:delete e[f],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(r?r[d]=n:this._root=n),this):(this._root=a,this)}function Yg(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Kg(){return this._root}function Xg(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Zg(t){var e=[],n,r=this._root,i,a,o;for(r&&e.push(new Cn(r,this._x0,this._x1));n=e.pop();)if(!t(r=n.node,a=n.x0,o=n.x1)&&r.length){var s=(a+o)/2;(i=r[1])&&e.push(new Cn(i,s,o)),(i=r[0])&&e.push(new Cn(i,a,s))}return this}function Qg(t){var e=[],n=[],r;for(this._root&&e.push(new Cn(this._root,this._x0,this._x1));r=e.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.x1,l=(o+s)/2;(a=i[0])&&e.push(new Cn(a,o,l)),(a=i[1])&&e.push(new Cn(a,l,s))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.x1);return this}function Jg(t){return t[0]}function ev(t){return arguments.length?(this._x=t,this):this._x}function Ql(t,e){var n=new Jl(e??Jg,NaN,NaN);return t==null?n:n.addAll(t)}function Jl(t,e,n){this._x=t,this._x0=e,this._x1=n,this._root=void 0}function Sc(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Pt=Ql.prototype=Jl.prototype;Pt.copy=function(){var t=new Jl(this._x,this._x0,this._x1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=Sc(e),t;for(n=[{source:e,target:t._root=new Array(2)}];e=n.pop();)for(var i=0;i<2;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(2)}):e.target[i]=Sc(r));return t};Pt.add=jg;Pt.addAll=zg;Pt.cover=qg;Pt.data=Bg;Pt.extent=Wg;Pt.find=$g;Pt.remove=Hg;Pt.removeAll=Yg;Pt.root=Kg;Pt.size=Xg;Pt.visit=Zg;Pt.visitAfter=Qg;Pt.x=ev;function tv(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return $d(this.cover(e,n),e,n,t)}function $d(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a=t._root,o={data:r},s=t._x0,l=t._y0,u=t._x1,c=t._y1,f,d,h,p,g,m,v,_;if(!a)return t._root=o,t;for(;a.length;)if((g=e>=(f=(s+u)/2))?s=f:u=f,(m=n>=(d=(l+c)/2))?l=d:c=d,i=a,!(a=a[v=m<<1|g]))return i[v]=o,t;if(h=+t._x.call(null,a.data),p=+t._y.call(null,a.data),e===h&&n===p)return o.next=a,i?i[v]=o:t._root=o,t;do i=i?i[v]=new Array(4):t._root=new Array(4),(g=e>=(f=(s+u)/2))?s=f:u=f,(m=n>=(d=(l+c)/2))?l=d:c=d;while((v=m<<1|g)===(_=(p>=d)<<1|h>=f));return i[_]=a,i[v]=o,t}function nv(t){var e,n,r=t.length,i,a,o=new Array(r),s=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=i,s[n]=a,i<l&&(l=i),i>c&&(c=i),a<u&&(u=a),a>f&&(f=a));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)$d(this,o[n],s[n],t[n]);return this}function rv(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o=i-n||1,s=this._root,l,u;n>t||t>=i||r>e||e>=a;)switch(u=(e<r)<<1|t<n,l=new Array(4),l[u]=s,s=l,o*=2,u){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function iv(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function av(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Tt(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function ov(t,e,n){var r,i=this._x0,a=this._y0,o,s,l,u,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Tt(h,i,a,c,f)),n==null?n=1/0:(i=t-n,a=e-n,c=t+n,f=e+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(s=p.y0)>f||(l=p.x1)<i||(u=p.y1)<a))if(h.length){var m=(o+l)/2,v=(s+u)/2;d.push(new Tt(h[3],m,v,l,u),new Tt(h[2],o,v,m,u),new Tt(h[1],m,s,l,v),new Tt(h[0],o,s,m,v)),(g=(e>=v)<<1|t>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var _=t-+this._x.call(null,h.data),w=e-+this._y.call(null,h.data),y=_*_+w*w;if(y<n){var b=Math.sqrt(n=y);i=t-b,a=e-b,c=t+b,f=e+b,r=h.data}}return r}function sv(t){if(isNaN(c=+this._x.call(null,t))||isNaN(f=+this._y.call(null,t)))return this;var e,n=this._root,r,i,a,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,f,d,h,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+l)/2))?o=d:l=d,(g=f>=(h=(s+u)/2))?s=h:u=h,e=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,v=m)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[m]=a:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function lv(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function uv(){return this._root}function cv(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function fv(t){var e=[],n,r=this._root,i,a,o,s,l;for(r&&e.push(new Tt(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,a=n.x0,o=n.y0,s=n.x1,l=n.y1)&&r.length){var u=(a+s)/2,c=(o+l)/2;(i=r[3])&&e.push(new Tt(i,u,c,s,l)),(i=r[2])&&e.push(new Tt(i,a,c,u,l)),(i=r[1])&&e.push(new Tt(i,u,o,s,c)),(i=r[0])&&e.push(new Tt(i,a,o,u,c))}return this}function dv(t){var e=[],n=[],r;for(this._root&&e.push(new Tt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,l=r.x1,u=r.y1,c=(o+l)/2,f=(s+u)/2;(a=i[0])&&e.push(new Tt(a,o,s,c,f)),(a=i[1])&&e.push(new Tt(a,c,s,l,f)),(a=i[2])&&e.push(new Tt(a,o,f,c,u)),(a=i[3])&&e.push(new Tt(a,c,f,l,u))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function hv(t){return t[0]}function pv(t){return arguments.length?(this._x=t,this):this._x}function mv(t){return t[1]}function gv(t){return arguments.length?(this._y=t,this):this._y}function eu(t,e,n){var r=new tu(e??hv,n??mv,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function tu(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Ac(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var St=eu.prototype=tu.prototype;St.copy=function(){var t=new tu(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=Ac(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=Ac(r));return t};St.add=tv;St.addAll=nv;St.cover=rv;St.data=iv;St.extent=av;St.find=ov;St.remove=sv;St.removeAll=lv;St.root=uv;St.size=cv;St.visit=fv;St.visitAfter=dv;St.x=pv;St.y=gv;function vv(t){const e=+this._x.call(null,t),n=+this._y.call(null,t),r=+this._z.call(null,t);return Hd(this.cover(e,n,r),e,n,r,t)}function Hd(t,e,n,r,i){if(isNaN(e)||isNaN(n)||isNaN(r))return t;var a,o=t._root,s={data:i},l=t._x0,u=t._y0,c=t._z0,f=t._x1,d=t._y1,h=t._z1,p,g,m,v,_,w,y,b,S,E,x;if(!o)return t._root=s,t;for(;o.length;)if((y=e>=(p=(l+f)/2))?l=p:f=p,(b=n>=(g=(u+d)/2))?u=g:d=g,(S=r>=(m=(c+h)/2))?c=m:h=m,a=o,!(o=o[E=S<<2|b<<1|y]))return a[E]=s,t;if(v=+t._x.call(null,o.data),_=+t._y.call(null,o.data),w=+t._z.call(null,o.data),e===v&&n===_&&r===w)return s.next=o,a?a[E]=s:t._root=s,t;do a=a?a[E]=new Array(8):t._root=new Array(8),(y=e>=(p=(l+f)/2))?l=p:f=p,(b=n>=(g=(u+d)/2))?u=g:d=g,(S=r>=(m=(c+h)/2))?c=m:h=m;while((E=S<<2|b<<1|y)===(x=(w>=m)<<2|(_>=g)<<1|v>=p));return a[x]=o,a[E]=s,t}function yv(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e),r=new Float64Array(e),i=new Float64Array(e);let a=1/0,o=1/0,s=1/0,l=-1/0,u=-1/0,c=-1/0;for(let f=0,d,h,p,g;f<e;++f)isNaN(h=+this._x.call(null,d=t[f]))||isNaN(p=+this._y.call(null,d))||isNaN(g=+this._z.call(null,d))||(n[f]=h,r[f]=p,i[f]=g,h<a&&(a=h),h>l&&(l=h),p<o&&(o=p),p>u&&(u=p),g<s&&(s=g),g>c&&(c=g));if(a>l||o>u||s>c)return this;this.cover(a,o,s).cover(l,u,c);for(let f=0;f<e;++f)Hd(this,n[f],r[f],i[f],t[f]);return this}function bv(t,e,n){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._z0,o=this._x1,s=this._y1,l=this._z1;if(isNaN(r))o=(r=Math.floor(t))+1,s=(i=Math.floor(e))+1,l=(a=Math.floor(n))+1;else{for(var u=o-r||1,c=this._root,f,d;r>t||t>=o||i>e||e>=s||a>n||n>=l;)switch(d=(n<a)<<2|(e<i)<<1|t<r,f=new Array(8),f[d]=c,c=f,u*=2,d){case 0:o=r+u,s=i+u,l=a+u;break;case 1:r=o-u,s=i+u,l=a+u;break;case 2:o=r+u,i=s-u,l=a+u;break;case 3:r=o-u,i=s-u,l=a+u;break;case 4:o=r+u,s=i+u,a=l-u;break;case 5:r=o-u,s=i+u,a=l-u;break;case 6:o=r+u,i=s-u,a=l-u;break;case 7:r=o-u,i=s-u,a=l-u;break}this._root&&this._root.length&&(this._root=c)}return this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this}function _v(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function wv(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function We(t,e,n,r,i,a,o){this.node=t,this.x0=e,this.y0=n,this.z0=r,this.x1=i,this.y1=a,this.z1=o}function Ev(t,e,n,r){var i,a=this._x0,o=this._y0,s=this._z0,l,u,c,f,d,h,p=this._x1,g=this._y1,m=this._z1,v=[],_=this._root,w,y;for(_&&v.push(new We(_,a,o,s,p,g,m)),r==null?r=1/0:(a=t-r,o=e-r,s=n-r,p=t+r,g=e+r,m=n+r,r*=r);w=v.pop();)if(!(!(_=w.node)||(l=w.x0)>p||(u=w.y0)>g||(c=w.z0)>m||(f=w.x1)<a||(d=w.y1)<o||(h=w.z1)<s))if(_.length){var b=(l+f)/2,S=(u+d)/2,E=(c+h)/2;v.push(new We(_[7],b,S,E,f,d,h),new We(_[6],l,S,E,b,d,h),new We(_[5],b,u,E,f,S,h),new We(_[4],l,u,E,b,S,h),new We(_[3],b,S,c,f,d,E),new We(_[2],l,S,c,b,d,E),new We(_[1],b,u,c,f,S,E),new We(_[0],l,u,c,b,S,E)),(y=(n>=E)<<2|(e>=S)<<1|t>=b)&&(w=v[v.length-1],v[v.length-1]=v[v.length-1-y],v[v.length-1-y]=w)}else{var x=t-+this._x.call(null,_.data),A=e-+this._y.call(null,_.data),V=n-+this._z.call(null,_.data),F=x*x+A*A+V*V;if(F<r){var P=Math.sqrt(r=F);a=t-P,o=e-P,s=n-P,p=t+P,g=e+P,m=n+P,i=_.data}}return i}function xv(t){if(isNaN(d=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t))||isNaN(p=+this._z.call(null,t)))return this;var e,n=this._root,r,i,a,o=this._x0,s=this._y0,l=this._z0,u=this._x1,c=this._y1,f=this._z1,d,h,p,g,m,v,_,w,y,b,S;if(!n)return this;if(n.length)for(;;){if((_=d>=(g=(o+u)/2))?o=g:u=g,(w=h>=(m=(s+c)/2))?s=m:c=m,(y=p>=(v=(l+f)/2))?l=v:f=v,e=n,!(n=n[b=y<<2|w<<1|_]))return this;if(!n.length)break;(e[b+1&7]||e[b+2&7]||e[b+3&7]||e[b+4&7]||e[b+5&7]||e[b+6&7]||e[b+7&7])&&(r=e,S=b)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[b]=a:delete e[b],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[S]=n:this._root=n),this):(this._root=a,this)}function Tv(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Sv(){return this._root}function Av(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function kv(t){var e=[],n,r=this._root,i,a,o,s,l,u,c;for(r&&e.push(new We(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!t(r=n.node,a=n.x0,o=n.y0,s=n.z0,l=n.x1,u=n.y1,c=n.z1)&&r.length){var f=(a+l)/2,d=(o+u)/2,h=(s+c)/2;(i=r[7])&&e.push(new We(i,f,d,h,l,u,c)),(i=r[6])&&e.push(new We(i,a,d,h,f,u,c)),(i=r[5])&&e.push(new We(i,f,o,h,l,d,c)),(i=r[4])&&e.push(new We(i,a,o,h,f,d,c)),(i=r[3])&&e.push(new We(i,f,d,s,l,u,h)),(i=r[2])&&e.push(new We(i,a,d,s,f,u,h)),(i=r[1])&&e.push(new We(i,f,o,s,l,d,h)),(i=r[0])&&e.push(new We(i,a,o,s,f,d,h))}return this}function Ov(t){var e=[],n=[],r;for(this._root&&e.push(new We(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=e.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,l=r.z0,u=r.x1,c=r.y1,f=r.z1,d=(o+u)/2,h=(s+c)/2,p=(l+f)/2;(a=i[0])&&e.push(new We(a,o,s,l,d,h,p)),(a=i[1])&&e.push(new We(a,d,s,l,u,h,p)),(a=i[2])&&e.push(new We(a,o,h,l,d,c,p)),(a=i[3])&&e.push(new We(a,d,h,l,u,c,p)),(a=i[4])&&e.push(new We(a,o,s,p,d,h,f)),(a=i[5])&&e.push(new We(a,d,s,p,u,h,f)),(a=i[6])&&e.push(new We(a,o,h,p,d,c,f)),(a=i[7])&&e.push(new We(a,d,h,p,u,c,f))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function Dv(t){return t[0]}function Cv(t){return arguments.length?(this._x=t,this):this._x}function Pv(t){return t[1]}function Mv(t){return arguments.length?(this._y=t,this):this._y}function Rv(t){return t[2]}function Iv(t){return arguments.length?(this._z=t,this):this._z}function nu(t,e,n,r){var i=new ru(e??Dv,n??Pv,r??Rv,NaN,NaN,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function ru(t,e,n,r,i,a,o,s,l){this._x=t,this._y=e,this._z=n,this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this._root=void 0}function kc(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var bt=nu.prototype=ru.prototype;bt.copy=function(){var t=new ru(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=kc(e),t;for(n=[{source:e,target:t._root=new Array(8)}];e=n.pop();)for(var i=0;i<8;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(8)}):e.target[i]=kc(r));return t};bt.add=vv;bt.addAll=yv;bt.cover=bv;bt.data=_v;bt.extent=wv;bt.find=Ev;bt.remove=xv;bt.removeAll=Tv;bt.root=Sv;bt.size=Av;bt.visit=kv;bt.visitAfter=Ov;bt.x=Cv;bt.y=Mv;bt.z=Iv;function Qe(t){return function(){return t}}function Bt(t){return(t()-.5)*1e-6}function Ms(t){return t.x+t.vx}function Oc(t){return t.y+t.vy}function Lv(t){return t.z+t.vz}function Yd(t){var e,n,r,i,a=1,o=1;typeof t!="function"&&(t=Qe(t==null?1:+t));function s(){for(var c,f=e.length,d,h,p,g,m,v,_,w=0;w<o;++w)for(d=(n===1?Ql(e,Ms):n===2?eu(e,Ms,Oc):n===3?nu(e,Ms,Oc,Lv):null).visitAfter(l),c=0;c<f;++c)h=e[c],v=r[h.index],_=v*v,p=h.x+h.vx,n>1&&(g=h.y+h.vy),n>2&&(m=h.z+h.vz),d.visit(y);function y(b,S,E,x,A,V,F){var P=[S,E,x,A,V,F],N=P[0],W=P[1],H=P[2],L=P[n],G=P[n+1],B=P[n+2],q=b.data,$=b.r,R=v+$;if(q){if(q.index>h.index){var O=p-q.x-q.vx,D=n>1?g-q.y-q.vy:0,T=n>2?m-q.z-q.vz:0,C=O*O+D*D+T*T;C<R*R&&(O===0&&(O=Bt(i),C+=O*O),n>1&&D===0&&(D=Bt(i),C+=D*D),n>2&&T===0&&(T=Bt(i),C+=T*T),C=(R-(C=Math.sqrt(C)))/C*a,h.vx+=(O*=C)*(R=($*=$)/(_+$)),n>1&&(h.vy+=(D*=C)*R),n>2&&(h.vz+=(T*=C)*R),q.vx-=O*(R=1-R),n>1&&(q.vy-=D*R),n>2&&(q.vz-=T*R))}return}return N>p+R||L<p-R||n>1&&(W>g+R||G<g-R)||n>2&&(H>m+R||B<m-R)}}function l(c){if(c.data)return c.r=r[c.data.index];for(var f=c.r=0;f<Math.pow(2,n);++f)c[f]&&c[f].r>c.r&&(c.r=c[f].r)}function u(){if(e){var c,f=e.length,d;for(r=new Array(f),c=0;c<f;++c)d=e[c],r[d.index]=+t(d,c,e)}}return s.initialize=function(c,...f){e=c,i=f.find(d=>typeof d=="function")||Math.random,n=f.find(d=>[1,2,3].includes(d))||2,u()},s.iterations=function(c){return arguments.length?(o=+c,s):o},s.strength=function(c){return arguments.length?(a=+c,s):a},s.radius=function(c){return arguments.length?(t=typeof c=="function"?c:Qe(+c),u(),s):t},s}function Uv(t){return t.index}function Dc(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function Kd(t){var e=Uv,n=d,r,i=Qe(30),a,o,s,l,u,c,f=1;t==null&&(t=[]);function d(v){return 1/Math.min(l[v.source.index],l[v.target.index])}function h(v){for(var _=0,w=t.length;_<f;++_)for(var y=0,b,S,E,x=0,A=0,V=0,F,P;y<w;++y)b=t[y],S=b.source,E=b.target,x=E.x+E.vx-S.x-S.vx||Bt(c),s>1&&(A=E.y+E.vy-S.y-S.vy||Bt(c)),s>2&&(V=E.z+E.vz-S.z-S.vz||Bt(c)),F=Math.sqrt(x*x+A*A+V*V),F=(F-a[y])/F*v*r[y],x*=F,A*=F,V*=F,E.vx-=x*(P=u[y]),s>1&&(E.vy-=A*P),s>2&&(E.vz-=V*P),S.vx+=x*(P=1-P),s>1&&(S.vy+=A*P),s>2&&(S.vz+=V*P)}function p(){if(o){var v,_=o.length,w=t.length,y=new Map(o.map((S,E)=>[e(S,E,o),S])),b;for(v=0,l=new Array(_);v<w;++v)b=t[v],b.index=v,typeof b.source!="object"&&(b.source=Dc(y,b.source)),typeof b.target!="object"&&(b.target=Dc(y,b.target)),l[b.source.index]=(l[b.source.index]||0)+1,l[b.target.index]=(l[b.target.index]||0)+1;for(v=0,u=new Array(w);v<w;++v)b=t[v],u[v]=l[b.source.index]/(l[b.source.index]+l[b.target.index]);r=new Array(w),g(),a=new Array(w),m()}}function g(){if(o)for(var v=0,_=t.length;v<_;++v)r[v]=+n(t[v],v,t)}function m(){if(o)for(var v=0,_=t.length;v<_;++v)a[v]=+i(t[v],v,t)}return h.initialize=function(v,..._){o=v,c=_.find(w=>typeof w=="function")||Math.random,s=_.find(w=>[1,2,3].includes(w))||2,p()},h.links=function(v){return arguments.length?(t=v,p(),h):t},h.id=function(v){return arguments.length?(e=v,h):e},h.iterations=function(v){return arguments.length?(f=+v,h):f},h.strength=function(v){return arguments.length?(n=typeof v=="function"?v:Qe(+v),g(),h):n},h.distance=function(v){return arguments.length?(i=typeof v=="function"?v:Qe(+v),m(),h):i},h}var Vv={value:()=>{}};function Xd(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ja(n)}function Ja(t){this._=t}function Fv(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ja.prototype=Xd.prototype={constructor:Ja,on:function(t,e){var n=this._,r=Fv(t+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(t=r[a]).type)&&(i=Gv(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(t=r[a]).type)n[i]=Cc(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Cc(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ja(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};function Gv(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Cc(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Vv,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Lr=0,Ii=0,si=0,Zd=1e3,oo,Li,so=0,cr=0,qo=0,Wi=typeof performance=="object"&&performance.now?performance:Date,Qd=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Jd(){return cr||(Qd(Nv),cr=Wi.now()+qo)}function Nv(){cr=0}function ml(){this._call=this._time=this._next=null}ml.prototype=eh.prototype={constructor:ml,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Jd():+n)+(e==null?0:+e),!this._next&&Li!==this&&(Li?Li._next=this:oo=this,Li=this),this._call=t,this._time=n,gl()},stop:function(){this._call&&(this._call=null,this._time=1/0,gl())}};function eh(t,e,n){var r=new ml;return r.restart(t,e,n),r}function jv(){Jd(),++Lr;for(var t=oo,e;t;)(e=cr-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Lr}function Pc(){cr=(so=Wi.now())+qo,Lr=Ii=0;try{jv()}finally{Lr=0,qv(),cr=0}}function zv(){var t=Wi.now(),e=t-so;e>Zd&&(qo-=e,so=t)}function qv(){for(var t,e=oo,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:oo=n);Li=t,gl(r)}function gl(t){if(!Lr){Ii&&(Ii=clearTimeout(Ii));var e=t-cr;e>24?(t<1/0&&(Ii=setTimeout(Pc,t-Wi.now()-qo)),si&&(si=clearInterval(si))):(si||(so=Wi.now(),si=setInterval(zv,Zd)),Lr=1,Qd(Pc))}}const Bv=1664525,Wv=1013904223,Mc=4294967296;function $v(){let t=1;return()=>(t=(Bv*t+Wv)%Mc)/Mc}var Rc=3;function Rs(t){return t.x}function Ic(t){return t.y}function Hv(t){return t.z}var Yv=10,Kv=Math.PI*(3-Math.sqrt(5)),Xv=Math.PI*20/(9+Math.sqrt(221));function th(t,e){e=e||2;var n=Math.min(Rc,Math.max(1,Math.round(e))),r,i=1,a=.001,o=1-Math.pow(a,1/300),s=0,l=.6,u=new Map,c=eh(h),f=Xd("tick","end"),d=$v();t==null&&(t=[]);function h(){p(),f.call("tick",r),i<a&&(c.stop(),f.call("end",r))}function p(v){var _,w=t.length,y;v===void 0&&(v=1);for(var b=0;b<v;++b)for(i+=(s-i)*o,u.forEach(function(S){S(i)}),_=0;_<w;++_)y=t[_],y.fx==null?y.x+=y.vx*=l:(y.x=y.fx,y.vx=0),n>1&&(y.fy==null?y.y+=y.vy*=l:(y.y=y.fy,y.vy=0)),n>2&&(y.fz==null?y.z+=y.vz*=l:(y.z=y.fz,y.vz=0));return r}function g(){for(var v=0,_=t.length,w;v<_;++v){if(w=t[v],w.index=v,w.fx!=null&&(w.x=w.fx),w.fy!=null&&(w.y=w.fy),w.fz!=null&&(w.z=w.fz),isNaN(w.x)||n>1&&isNaN(w.y)||n>2&&isNaN(w.z)){var y=Yv*(n>2?Math.cbrt(.5+v):n>1?Math.sqrt(.5+v):v),b=v*Kv,S=v*Xv;n===1?w.x=y:n===2?(w.x=y*Math.cos(b),w.y=y*Math.sin(b)):(w.x=y*Math.sin(b)*Math.cos(S),w.y=y*Math.cos(b),w.z=y*Math.sin(b)*Math.sin(S))}(isNaN(w.vx)||n>1&&isNaN(w.vy)||n>2&&isNaN(w.vz))&&(w.vx=0,n>1&&(w.vy=0),n>2&&(w.vz=0))}}function m(v){return v.initialize&&v.initialize(t,d,n),v}return g(),r={tick:p,restart:function(){return c.restart(h),r},stop:function(){return c.stop(),r},numDimensions:function(v){return arguments.length?(n=Math.min(Rc,Math.max(1,Math.round(v))),u.forEach(m),r):n},nodes:function(v){return arguments.length?(t=v,g(),u.forEach(m),r):t},alpha:function(v){return arguments.length?(i=+v,r):i},alphaMin:function(v){return arguments.length?(a=+v,r):a},alphaDecay:function(v){return arguments.length?(o=+v,r):+o},alphaTarget:function(v){return arguments.length?(s=+v,r):s},velocityDecay:function(v){return arguments.length?(l=1-v,r):1-l},randomSource:function(v){return arguments.length?(d=v,u.forEach(m),r):d},force:function(v,_){return arguments.length>1?(_==null?u.delete(v):u.set(v,m(_)),r):u.get(v)},find:function(){var v=Array.prototype.slice.call(arguments),_=v.shift()||0,w=(n>1?v.shift():null)||0,y=(n>2?v.shift():null)||0,b=v.shift()||1/0,S=0,E=t.length,x,A,V,F,P,N;for(b*=b,S=0;S<E;++S)P=t[S],x=_-P.x,A=w-(P.y||0),V=y-(P.z||0),F=x*x+A*A+V*V,F<b&&(N=P,b=F);return N},on:function(v,_){return arguments.length>1?(f.on(v,_),r):f.on(v)}}}function nh(){var t,e,n,r,i,a=Qe(-30),o,s=1,l=1/0,u=.81;function c(p){var g,m=t.length,v=(e===1?Ql(t,Rs):e===2?eu(t,Rs,Ic):e===3?nu(t,Rs,Ic,Hv):null).visitAfter(d);for(i=p,g=0;g<m;++g)n=t[g],v.visit(h)}function f(){if(t){var p,g=t.length,m;for(o=new Array(g),p=0;p<g;++p)m=t[p],o[m.index]=+a(m,p,t)}}function d(p){var g=0,m,v,_=0,w,y,b,S,E=p.length;if(E){for(w=y=b=S=0;S<E;++S)(m=p[S])&&(v=Math.abs(m.value))&&(g+=m.value,_+=v,w+=v*(m.x||0),y+=v*(m.y||0),b+=v*(m.z||0));g*=Math.sqrt(4/E),p.x=w/_,e>1&&(p.y=y/_),e>2&&(p.z=b/_)}else{m=p,m.x=m.data.x,e>1&&(m.y=m.data.y),e>2&&(m.z=m.data.z);do g+=o[m.data.index];while(m=m.next)}p.value=g}function h(p,g,m,v,_){if(!p.value)return!0;var w=[m,v,_][e-1],y=p.x-n.x,b=e>1?p.y-n.y:0,S=e>2?p.z-n.z:0,E=w-g,x=y*y+b*b+S*S;if(E*E/u<x)return x<l&&(y===0&&(y=Bt(r),x+=y*y),e>1&&b===0&&(b=Bt(r),x+=b*b),e>2&&S===0&&(S=Bt(r),x+=S*S),x<s&&(x=Math.sqrt(s*x)),n.vx+=y*p.value*i/x,e>1&&(n.vy+=b*p.value*i/x),e>2&&(n.vz+=S*p.value*i/x)),!0;if(p.length||x>=l)return;(p.data!==n||p.next)&&(y===0&&(y=Bt(r),x+=y*y),e>1&&b===0&&(b=Bt(r),x+=b*b),e>2&&S===0&&(S=Bt(r),x+=S*S),x<s&&(x=Math.sqrt(s*x)));do p.data!==n&&(E=o[p.data.index]*i/x,n.vx+=y*E,e>1&&(n.vy+=b*E),e>2&&(n.vz+=S*E));while(p=p.next)}return c.initialize=function(p,...g){t=p,r=g.find(m=>typeof m=="function")||Math.random,e=g.find(m=>[1,2,3].includes(m))||2,f()},c.strength=function(p){return arguments.length?(a=typeof p=="function"?p:Qe(+p),f(),c):a},c.distanceMin=function(p){return arguments.length?(s=p*p,c):Math.sqrt(s)},c.distanceMax=function(p){return arguments.length?(l=p*p,c):Math.sqrt(l)},c.theta=function(p){return arguments.length?(u=p*p,c):Math.sqrt(u)},c}function Zv(t,e,n,r){var i,a,o=Qe(.1),s,l;typeof t!="function"&&(t=Qe(+t)),e==null&&(e=0),n==null&&(n=0),r==null&&(r=0);function u(f){for(var d=0,h=i.length;d<h;++d){var p=i[d],g=p.x-e||1e-6,m=(p.y||0)-n||1e-6,v=(p.z||0)-r||1e-6,_=Math.sqrt(g*g+m*m+v*v),w=(l[d]-_)*s[d]*f/_;p.vx+=g*w,a>1&&(p.vy+=m*w),a>2&&(p.vz+=v*w)}}function c(){if(i){var f,d=i.length;for(s=new Array(d),l=new Array(d),f=0;f<d;++f)l[f]=+t(i[f],f,i),s[f]=isNaN(l[f])?0:+o(i[f],f,i)}}return u.initialize=function(f,...d){i=f,a=d.find(h=>[1,2,3].includes(h))||2,c()},u.strength=function(f){return arguments.length?(o=typeof f=="function"?f:Qe(+f),c(),u):o},u.radius=function(f){return arguments.length?(t=typeof f=="function"?f:Qe(+f),c(),u):t},u.x=function(f){return arguments.length?(e=+f,u):e},u.y=function(f){return arguments.length?(n=+f,u):n},u.z=function(f){return arguments.length?(r=+f,u):r},u}function rh(t){var e=Qe(.1),n,r,i;typeof t!="function"&&(t=Qe(t==null?0:+t));function a(s){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*s}function o(){if(n){var s,l=n.length;for(r=new Array(l),i=new Array(l),s=0;s<l;++s)r[s]=isNaN(i[s]=+t(n[s],s,n))?0:+e(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:Qe(+s),o(),a):e},a.x=function(s){return arguments.length?(t=typeof s=="function"?s:Qe(+s),o(),a):t},a}function ih(t){var e=Qe(.1),n,r,i;typeof t!="function"&&(t=Qe(t==null?0:+t));function a(s){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*s}function o(){if(n){var s,l=n.length;for(r=new Array(l),i=new Array(l),s=0;s<l;++s)r[s]=isNaN(i[s]=+t(n[s],s,n))?0:+e(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:Qe(+s),o(),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:Qe(+s),o(),a):t},a}function Qv(t){var e=Qe(.1),n,r,i;typeof t!="function"&&(t=Qe(t==null?0:+t));function a(s){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vz+=(i[l]-c.z)*r[l]*s}function o(){if(n){var s,l=n.length;for(r=new Array(l),i=new Array(l),s=0;s<l;++s)r[s]=isNaN(i[s]=+t(n[s],s,n))?0:+e(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:Qe(+s),o(),a):e},a.z=function(s){return arguments.length?(t=typeof s=="function"?s:Qe(+s),o(),a):t},a}function ah(t,e=[]){const n=e.length;for(const r of t){const i=e.indexOf(r);if(i>-1){const a=[...e.slice(i),r].map(o=>o.data.id);throw new Error(`Invalid Graph: Circular node path detected: ${a.join(" -> ")}.`)}n>r.depth&&(r.depth=n,ah(r.out,[...e,r]))}}function oh(t,e){let n=!1;const r=t.reduce((o,s)=>({...o,[s.id]:{data:s,out:[],depth:-1,ins:[]}}),{});try{for(const o of e){const s=o.source,l=o.target;if(!r.hasOwnProperty(s))throw new Error(`Missing source Node ${s}`);if(!r.hasOwnProperty(l))throw new Error(`Missing target Node ${l}`);const u=r[s],c=r[l];c.ins.push(u),u.out.push(c)}ah(Object.values(r))}catch{n=!0}const i=Object.keys(r).map(o=>r[o].depth),a=Math.max(...i);return{invalid:n,depths:r,maxDepth:a||1}}const Lc=["radialin","radialout"];function Jv({nodes:t,edges:e,mode:n="lr",nodeLevelRatio:r=2}){const{depths:i,maxDepth:a,invalid:o}=oh(t,e);if(o)return null;const s=Lc.includes(n)?1:5,l=t.length/a*r*s;if(n){const u=(h,p)=>g=>h?(i[g.id].depth-a/2)*l*(p?-1:1):void 0,c=u(["lr","rl"].includes(n),n==="rl"),f=u(["td","bu"].includes(n),n==="td"),d=u(["zin","zout"].includes(n),n==="zout");t.forEach(h=>{h.fx=c(h),h.fy=f(h),h.fz=d(h)})}return Lc.includes(n)?Zv(u=>{const c=i[u.id];return(n==="radialin"?a-c.depth:c.depth)*l}).strength(1):null}function ey(t,e){let n;function r(){n?e(n):(n=t.step(),r())}r()}function aa(t){const e=[],n=[];return t.forEachNode((r,i)=>{e.push({...i,id:r,radius:i.size||1})}),t.forEachEdge((r,i)=>{n.push({...i,id:r})}),{nodes:e,edges:n}}function ty(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function ny(){return this.eachAfter(ty)}function ry(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function iy(t,e){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(t.call(e,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function ay(t,e){for(var n=this,r=[n],i=[],a,o,s,l=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)t.call(e,n,++l,this);return this}function oy(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function sy(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function ly(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function uy(t){for(var e=this,n=cy(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function cy(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function fy(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function dy(){return Array.from(this)}function hy(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function py(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*my(){var t=this,e,n=[t],r,i,a;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function Bo(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=yy)):e===void 0&&(e=vy);for(var n=new Ur(t),r,i=[n],a,o,s,l;r=i.pop();)if((o=e(r.data))&&(l=(o=Array.from(o)).length))for(r.children=o,s=l-1;s>=0;--s)i.push(a=o[s]=new Ur(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(sh)}function gy(){return Bo(this).eachBefore(by)}function vy(t){return t.children}function yy(t){return Array.isArray(t)?t[1]:null}function by(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function sh(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Ur(t){this.data=t,this.depth=this.height=0,this.parent=null}Ur.prototype=Bo.prototype={constructor:Ur,count:ny,each:ry,eachAfter:ay,eachBefore:iy,find:oy,sum:sy,sort:ly,path:uy,ancestors:fy,descendants:dy,leaves:hy,links:py,copy:gy,[Symbol.iterator]:my};function Is(t){return t==null?null:lh(t)}function lh(t){if(typeof t!="function")throw new Error;return t}function li(){return 0}function ui(t){return function(){return t}}function _y(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function wy(t,e,n,r,i){for(var a=t.children,o,s=-1,l=a.length,u=t.value&&(r-e)/t.value;++s<l;)o=a[s],o.y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}var Ey={depth:-1},Uc={},Ls={};function xy(t){return t.id}function Ty(t){return t.parentId}function Sy(){var t=xy,e=Ty,n;function r(i){var a=Array.from(i),o=t,s=e,l,u,c,f,d,h,p,g,m=new Map;if(n!=null){const v=a.map((y,b)=>Ay(n(y,b,i))),_=v.map(Vc),w=new Set(v).add("");for(const y of _)w.has(y)||(w.add(y),v.push(y),_.push(Vc(y)),a.push(Ls));o=(y,b)=>v[b],s=(y,b)=>_[b]}for(c=0,l=a.length;c<l;++c)u=a[c],h=a[c]=new Ur(u),(p=o(u,c,i))!=null&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?Uc:h)),(p=s(u,c,i))!=null&&(p+="")&&(h.parent=p);for(c=0;c<l;++c)if(h=a[c],p=h.parent){if(d=m.get(p),!d)throw new Error("missing: "+p);if(d===Uc)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===Ls&&f.children.length===1;)f=f.children[0],--l;for(let v=a.length-1;v>=0&&(h=a[v],h.data===Ls);--v)h.data=null}if(f.parent=Ey,f.eachBefore(function(v){v.depth=v.parent.depth+1,--l}).eachBefore(sh),f.parent=null,l>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(t=Is(i),r):t},r.parentId=function(i){return arguments.length?(e=Is(i),r):e},r.path=function(i){return arguments.length?(n=Is(i),r):n},r}function Ay(t){t=`${t}`;let e=t.length;return vl(t,e-1)&&!vl(t,e-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:`/${t}`}function Vc(t){let e=t.length;if(e<2)return"";for(;--e>1&&!vl(t,e););return t.slice(0,e)}function vl(t,e){if(t[e]==="/"){let n=0;for(;e>0&&t[--e]==="\\";)++n;if(!(n&1))return!0}return!1}function ky(t,e){return t.parent===e.parent?1:2}function Us(t){var e=t.children;return e?e[0]:t.t}function Vs(t){var e=t.children;return e?e[e.length-1]:t.t}function Oy(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Dy(t){for(var e=0,n=0,r=t.children,i=r.length,a;--i>=0;)a=r[i],a.z+=e,a.m+=e,e+=a.s+(n+=a.c)}function Cy(t,e,n){return t.a.parent===e.parent?t.a:n}function eo(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}eo.prototype=Object.create(Ur.prototype);function Py(t){for(var e=new eo(t,0),n,r=[e],i,a,o,s;n=r.pop();)if(a=n._.children)for(n.children=new Array(s=a.length),o=s-1;o>=0;--o)r.push(i=n.children[o]=new eo(a[o],o)),i.parent=n;return(e.parent=new eo(null,0)).children=[e],e}function My(){var t=ky,e=1,n=1,r=null;function i(u){var c=Py(u);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)u.eachBefore(l);else{var f=u,d=u,h=u;u.eachBefore(function(_){_.x<f.x&&(f=_),_.x>d.x&&(d=_),_.depth>h.depth&&(h=_)});var p=f===d?1:t(f,d)/2,g=p-f.x,m=e/(d.x+p+g),v=n/(h.depth||1);u.eachBefore(function(_){_.x=(_.x+g)*m,_.y=_.depth*v})}return u}function a(u){var c=u.children,f=u.parent.children,d=u.i?f[u.i-1]:null;if(c){Dy(u);var h=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+t(u._,d._),u.m=u.z-h):u.z=h}else d&&(u.z=d.z+t(u._,d._));u.parent.A=s(u,d,u.parent.A||f[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function s(u,c,f){if(c){for(var d=u,h=u,p=c,g=d.parent.children[0],m=d.m,v=h.m,_=p.m,w=g.m,y;p=Vs(p),d=Us(d),p&&d;)g=Us(g),h=Vs(h),h.a=u,y=p.z+_-d.z-m+t(p._,d._),y>0&&(Oy(Cy(p,u,f),u,y),m+=y,v+=y),_+=p.m,m+=d.m,w+=g.m,v+=h.m;p&&!Vs(h)&&(h.t=p,h.m+=_-v),d&&!Us(g)&&(g.t=d,g.m+=m-w,f=u)}return f}function l(u){u.x*=e,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(t=u,i):t},i.size=function(u){return arguments.length?(r=!1,e=+u[0],n=+u[1],i):r?null:[e,n]},i.nodeSize=function(u){return arguments.length?(r=!0,e=+u[0],n=+u[1],i):r?[e,n]:null},i}function Ry(t,e,n,r,i){for(var a=t.children,o,s=-1,l=a.length,u=t.value&&(i-n)/t.value;++s<l;)o=a[s],o.x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}var Iy=(1+Math.sqrt(5))/2;function Ly(t,e,n,r,i,a){for(var o=[],s=e.children,l,u,c=0,f=0,d=s.length,h,p,g=e.value,m,v,_,w,y,b,S;c<d;){h=i-n,p=a-r;do m=s[f++].value;while(!m&&f<d);for(v=_=m,b=Math.max(p/h,h/p)/(g*t),S=m*m*b,y=Math.max(_/S,S/v);f<d;++f){if(m+=u=s[f].value,u<v&&(v=u),u>_&&(_=u),S=m*m*b,w=Math.max(_/S,S/v),w>y){m-=u;break}y=w}o.push(l={value:m,dice:h<p,children:s.slice(c,f)}),l.dice?wy(l,n,r,i,g?r+=p*m/g:a):Ry(l,n,r,g?n+=h*m/g:i,a),g-=m,c=f}return o}const Uy=function t(e){function n(r,i,a,o,s){Ly(e,r,i,a,o,s)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(Iy);function Vy(){var t=Uy,e=!1,n=1,r=1,i=[0],a=li,o=li,s=li,l=li,u=li;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],e&&d.eachBefore(_y),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=a(d)/2,p+=u(d)-h,g+=o(d)-h,m-=s(d)-h,v-=l(d)-h,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),t(d,p,g,m,v))}return c.round=function(d){return arguments.length?(e=!!d,c):e},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(t=lh(d),c):t},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:ui(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:ui(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:ui(+d),c):s},c.paddingBottom=function(d){return arguments.length?(l=typeof d=="function"?d:ui(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u=typeof d=="function"?d:ui(+d),c):u},c}function Fy(){function t(L){return()=>L}function e(L){return L.index}let n=e,r=[],i=[],a,o=[100,100],s=t(1),l=t(-1),u=t(100),c=t(.1),f={},d=.1,h=.001,p=[],g=[0,0],m,v=L=>L.cluster,_="treemap",w=!0,y=.1;function b(L){if(!w)return b;_==="force"&&(m.tick(),P());for(let G=0,B=r.length,q,$=L*y;G<B;++G)q=r[G],q.vx+=(f[v(q)].x-q.x)*$,q.vy+=(f[v(q)].y-q.y)*$}function S(){r&&(_==="treemap"?N():H())}b.initialize=function(L){r=L,S()};function E(L){let G=v(L.source),B=v(L.target);return G<=B?G+"~"+B:B+"~"+G}function x(L){let G=new Map,B={};return L.forEach(function(q){G.has(v(q))||G.set(v(q),{count:0,sumforceNodeSize:0})}),L.forEach(function(q){B=G.get(v(q)),B.count=B.count+1,B.sumforceNodeSize=B.sumforceNodeSize+Math.PI*(s(q)*s(q))*1.3,G.set(v(q),B)}),G}function A(L){let G=new Map,B=[];return L.forEach(function(q){let $=E(q),R;G.has($)?R=G.get($):R=0,R+=1,G.set($,R)}),G.forEach(function(q,$){let R,O;R=$.split("~")[0],O=$.split("~")[1],R!==void 0&&O!==void 0&&B.push({source:R,target:O,count:q})}),B}function V(){let L=[],G=[],B=new Map,q,$,R,O,D;O=x(r),D=A(i);for(q of O.keys())R=O.get(q),L.push({id:q,size:R.count,r:Math.sqrt(R.sumforceNodeSize/Math.PI)}),B.set(q,$);return D.forEach(function(T){let C=B.get(T.source),j=B.get(T.target);C!==void 0&&j!==void 0&&G.push({source:C,target:j,count:T.count})}),{nodes:L,links:G}}function F(){let L=[],G,B,q;q=x(b.nodes());for(G of q.keys())B=q.get(G),L.push({id:G,size:B.count});return{id:"clustersTree",children:L}}function P(){return f.none={x:0,y:0},p.forEach(function(L){_==="treemap"?f[L.data.id]={x:L.x0+(L.x1-L.x0)/2-g[0],y:L.y0+(L.y1-L.y0)/2-g[1]}:f[L.id]={x:L.x-g[0],y:L.y-g[1]}}),f}function N(){let L=Vy().size(b.size());a=Bo(F()).sum(G=>G.radius).sort(function(G,B){return B.height-G.height||B.value-G.value}),p=L(a).leaves(),P()}function W(){let L=0;r.length!==0&&i.forEach(function(G){let B,q;if(r){if(B=G.source,q=G.target,typeof G.source!="object"&&(B=r.find($=>$.id===G.source)),typeof G.target!="object"&&(q=r.find($=>$.id===G.target)),B===void 0||q===void 0)throw Error("Error setting links, couldnt find nodes for a link (see it on the console)");G.source=B,G.target=q,G.index=L++}})}function H(){let L;if(!(!r||!r.length)){if(r&&r.length>0&&v(r[0])===void 0)throw Error('Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy("clusterAttr") before calling .links()');W(),L=V(),m=th(L.nodes).force("x",rh(o[0]/2).strength(.1)).force("y",ih(o[1]/2).strength(.1)).force("collide",Yd(G=>G.r).iterations(4)).force("charge",nh().strength(l)).force("links",Kd(L.nodes.length?L.links:[]).distance(u).strength(c)),p=m.nodes(),P()}}return b.template=function(L){return arguments.length?(_=L,S(),b):_},b.groupBy=function(L){return arguments.length?typeof L=="string"?(v=function(G){return G[L]},b):(v=L,b):v},b.enableGrouping=function(L){return arguments.length?(w=L,b):w},b.strength=function(L){return arguments.length?(y=L,b):y},b.getLinkStrength=function(L){return w?v(L.source)===v(L.target)?typeof d=="function"?d(L):d:typeof h=="function"?h(L):h:typeof d=="function"?d(L):d},b.id=function(L){return arguments.length?(n=L,b):n},b.size=function(L){return arguments.length?(o=L,b):o},b.linkStrengthInterCluster=function(L){return arguments.length?(h=L,b):h},b.linkStrengthIntraCluster=function(L){return arguments.length?(d=L,b):d},b.nodes=function(L){return arguments.length?(r=L,b):r},b.links=function(L){return arguments.length?(L===null?i=[]:i=L,S(),b):i},b.template=function(L){return arguments.length?(_=L,S(),b):_},b.forceNodeSize=function(L){return arguments.length?(s=typeof L=="function"?L:t(+L),S(),b):s},b.nodeSize=b.forceNodeSize,b.forceCharge=function(L){return arguments.length?(l=typeof L=="function"?L:t(+L),S(),b):l},b.forceLinkDistance=function(L){return arguments.length?(u=typeof L=="function"?L:t(+L),S(),b):u},b.forceLinkStrength=function(L){return arguments.length?(c=typeof L=="function"?L:t(+L),S(),b):c},b.offset=function(L){return arguments.length?(g=typeof L=="function"?L:t(+L),b):g},b.getFocis=P,b}const Gy=100;function Gn({graph:t,nodeLevelRatio:e=2,mode:n=null,dimensions:r=2,nodeStrength:i=-250,linkDistance:a=50,clusterStrength:o=.5,linkStrengthInterCluster:s=.01,linkStrengthIntraCluster:l=.5,forceLinkDistance:u=100,forceLinkStrength:c=.1,clusterType:f="force",forceCharge:d=-700,getNodePosition:h,drags:p,clusterAttribute:g}){const{nodes:m,edges:v}=aa(t),w=r===2&&v.length>25?i*2:i,y=th().force("link",Kd()).force("charge",nh().strength(w)).force("x",rh(1200/2).strength(.05)).force("y",ih(1200/2).strength(.05)).force("z",Qv()).force("collide",Yd(x=>x.radius)).force("dagRadial",Jv({nodes:m,edges:v,mode:n,nodeLevelRatio:e})).stop();let b;g&&(b=Fy().strength(o).template(f).groupBy(x=>x.data[g]).links(v).size([100,100]).linkStrengthInterCluster(s).linkStrengthIntraCluster(l).forceLinkDistance(u).forceLinkStrength(c).forceCharge(d).forceNodeSize(x=>x.radius));let S=y.numDimensions(r).nodes(m);if(b&&(S=S.force("group",b)),a){let x=S.force("link");x&&(x.id(A=>A.id).links(v).distance(a),b&&(x=x.strength((b==null?void 0:b.getLinkStrength)??.1)))}const E=new Map(m.map(x=>[x.id,x]));return{step(){return y.tick(Gy),!0},getNodePosition(x){var A,V;if(h){const F=h(x,{graph:t,drags:p,nodes:m,edges:v});if(F)return F}return(A=p==null?void 0:p[x])!=null&&A.position?(V=p==null?void 0:p[x])==null?void 0:V.position:E.get(x)}}}function Ny(t){return!t||typeof t!="object"||typeof t=="function"||Array.isArray(t)||t instanceof Set||t instanceof Map||t instanceof RegExp||t instanceof Date}function uh(t,e){t=t||{};var n={};for(var r in e){var i=t[r],a=e[r];if(!Ny(a)){n[r]=uh(i,a);continue}i===void 0?n[r]=a:n[r]=i}return n}var iu=uh,Kn=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},jy=iu,zy=Kn,qy={dimensions:["x","y"],center:.5,scale:1};function ch(t,e,n){if(!zy(e))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");n=jy(n,qy);var r=n.dimensions;if(!Array.isArray(r)||r.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var i=n.center,a=n.scale,o=Math.PI*2,s=(i-.5)*a,l=e.order,u=r[0],c=r[1];function f(p,g){return g[u]=a*Math.cos(p*o/l)+s,g[c]=a*Math.sin(p*o/l)+s,g}var d=0;if(!t){var h={};return e.forEachNode(function(p){h[p]=f(d++,{})}),h}e.updateEachNodeAttributes(function(p,g){return f(d++,g),g},{attributes:r})}var fh=ch.bind(null,!1);fh.assign=ch.bind(null,!0);var By=fh;const Wy=Vt(By);function $y({graph:t,radius:e,drags:n,getNodePosition:r}){const i=Wy(t,{scale:e}),{nodes:a,edges:o}=aa(t);return{step(){return!0},getNodePosition(s){var l,u;if(r){const c=r(s,{graph:t,drags:n,nodes:a,edges:o});if(c)return c}return(l=n==null?void 0:n[s])!=null&&l.position?(u=n==null?void 0:n[s])==null?void 0:u.position:i==null?void 0:i[s]}}}const Hy={td:{x:"x",y:"y",factor:-1},lr:{x:"y",y:"x",factor:1}};function Fc({graph:t,drags:e,mode:n="td",getNodePosition:r}){const{nodes:i,edges:a}=aa(t),{depths:o}=oh(i,a),s=Object.keys(o).map(h=>o[h]),l=Sy().id(h=>h.data.id).parentId(h=>{var p,g,m;return(m=(g=(p=h.ins)==null?void 0:p[0])==null?void 0:g.data)==null?void 0:m.id})(s),c=My().separation(()=>1).nodeSize([50,50])(Bo(l)).descendants(),f=Hy[n],d=new Map(i.map(h=>{const{x:p,y:g}=c.find(m=>m.data.id===h.id);return[h.id,{...h,[f.x]:p*f.factor,[f.y]:g*f.factor,z:0}]}));return{step(){return!0},getNodePosition(h){var p,g;if(r){const m=r(h,{graph:t,drags:e,nodes:i,edges:a});if(m)return m}return(p=e==null?void 0:e[h])!=null&&p.position?(g=e==null?void 0:e[h])==null?void 0:g.position:d.get(h)}}}var ci=0,fi=1,Ra=2,di=3;function Yy(t,e){return t+""+e}function Gc(){return .01*(.5-Math.random())}var Ky=function(e,n){var r=e.margin,i=e.ratio,a=e.expansion,o=e.gridSize,s=e.speed,l,u,c,f,d,h,p=!0,g=n.length,m=g/di|0,v=new Float32Array(m),_=new Float32Array(m),w=1/0,y=1/0,b=-1/0,S=-1/0;for(l=0;l<g;l+=di)c=n[l+ci],f=n[l+fi],h=n[l+Ra]*i+r,w=Math.min(w,c-h),b=Math.max(b,c+h),y=Math.min(y,f-h),S=Math.max(S,f+h);var E=b-w,x=S-y,A=(w+b)/2,V=(y+S)/2;w=A-a*E/2,b=A+a*E/2,y=V-a*x/2,S=V+a*x/2;var F=new Array(o*o),P=F.length,N;for(N=0;N<P;N++)F[N]=[];var W,H,L,G,B,q,$,R,O,D;for(l=0;l<g;l+=di)for(c=n[l+ci],f=n[l+fi],h=n[l+Ra]*i+r,W=c-h,H=c+h,L=f-h,G=f+h,B=Math.floor(o*(W-w)/(b-w)),q=Math.floor(o*(H-w)/(b-w)),$=Math.floor(o*(L-y)/(S-y)),R=Math.floor(o*(G-y)/(S-y)),O=B;O<=q;O++)for(D=$;D<=R;D++)F[O*o+D].push(l);var T,C=new Set,j,k,z,J,Q,X,Y,ae,te,K,U,M,Z;for(N=0;N<P;N++)for(T=F[N],l=0,d=T.length;l<d;l++)for(j=T[l],z=n[j+ci],Q=n[j+fi],Y=n[j+Ra],u=l+1;u<d;u++)k=T[u],te=Yy(j,k),!(P>1&&C.has(te))&&(P>1&&C.add(te),J=n[k+ci],X=n[k+fi],ae=n[k+Ra],K=J-z,U=X-Q,M=Math.sqrt(K*K+U*U),Z=M<Y*i+r+(ae*i+r),Z&&(p=!1,k=k/di|0,M>0?(v[k]+=K/M*(1+Y),_[k]+=U/M*(1+Y)):(v[k]+=E*Gc(),_[k]+=x*Gc())));for(l=0,u=0;l<g;l+=di,u++)n[l+ci]+=v[u]*.1*s,n[l+fi]+=_[u]*.1*s;return{converged:p}},qr={},lo=3;qr.validateSettings=function(t){return"gridSize"in t&&typeof t.gridSize!="number"||t.gridSize<=0?{message:"the `gridSize` setting should be a positive number."}:"margin"in t&&typeof t.margin!="number"||t.margin<0?{message:"the `margin` setting should be 0 or a positive number."}:"expansion"in t&&typeof t.expansion!="number"||t.expansion<=0?{message:"the `expansion` setting should be a positive number."}:"ratio"in t&&typeof t.ratio!="number"||t.ratio<=0?{message:"the `ratio` setting should be a positive number."}:"speed"in t&&typeof t.speed!="number"||t.speed<=0?{message:"the `speed` setting should be a positive number."}:null};qr.graphToByteArray=function(t,e){var n=t.order,r=new Float32Array(n*lo),i=0;return t.forEachNode(function(a,o){typeof e=="function"&&(o=e(a,o)),r[i]=o.x,r[i+1]=o.y,r[i+2]=o.size||1,i+=lo}),r};qr.assignLayoutChanges=function(t,e,n){var r=0;t.forEachNode(function(i){var a={x:e[r],y:e[r+1]};typeof n=="function"&&(a=n(i,a)),t.mergeNodeAttributes(i,a),r+=lo})};qr.collectLayoutChanges=function(t,e,n){var r={},i=0;return t.forEachNode(function(a){var o={x:e[i],y:e[i+1]};typeof n=="function"&&(o=n(a,o)),r[a]=o,i+=lo}),r};qr.createWorker=function(e){var n=window.URL||window.webkitURL,r=e.toString(),i=n.createObjectURL(new Blob(["("+r+").call(this);"],{type:"text/javascript"})),a=new Worker(i);return n.revokeObjectURL(i),a};var Xy={gridSize:20,margin:5,expansion:1.1,ratio:1,speed:3},Zy=Kn,Qy=Ky,Ia=qr,Jy=Xy,e0=500;function dh(t,e,n){if(!Zy(e))throw new Error("graphology-layout-noverlap: the given graph is not a valid graphology instance.");typeof n=="number"?n={maxIterations:n}:n=n||{};var r=n.maxIterations||e0;if(typeof r!="number"||r<=0)throw new Error("graphology-layout-force: you should provide a positive number of maximum iterations.");var i=Object.assign({},Jy,n.settings),a=Ia.validateSettings(i);if(a)throw new Error("graphology-layout-noverlap: "+a.message);var o=Ia.graphToByteArray(e,n.inputReducer),s=!1,l;for(l=0;l<r&&!s;l++)s=Qy(i,o).converged;if(t){Ia.assignLayoutChanges(e,o,n.outputReducer);return}return Ia.collectLayoutChanges(e,o,n.outputReducer)}var hh=dh.bind(null,!1);hh.assign=dh.bind(null,!0);var t0=hh;const n0=Vt(t0);function r0({graph:t,margin:e,drags:n,getNodePosition:r,ratio:i,gridSize:a,maxIterations:o}){const{nodes:s,edges:l}=aa(t),u=n0(t,{maxIterations:o,inputReducer:(c,f)=>({...f,x:f.x||0,y:f.y||0}),settings:{ratio:i,margin:e,gridSize:a}});return{step(){return!0},getNodePosition(c){var f,d;if(r){const h=r(c,{graph:t,drags:n,nodes:s,edges:l});if(h)return h}return(f=n==null?void 0:n[c])!=null&&f.position?(d=n==null?void 0:n[c])==null?void 0:d.position:u==null?void 0:u[c]}}}var Br={};function i0(t){return typeof t!="number"||isNaN(t)?1:t}function a0(t,e){var n={},r=function(o){return typeof o>"u"?e:o};typeof e=="function"&&(r=e);var i=function(o){return r(o[t])},a=function(){return r(void 0)};return typeof t=="string"?(n.fromAttributes=i,n.fromGraph=function(o,s){return i(o.getNodeAttributes(s))},n.fromEntry=function(o,s){return i(s)}):typeof t=="function"?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},n.fromGraph=function(o,s){return r(t(s,o.getNodeAttributes(s)))},n.fromEntry=function(o,s){return r(t(o,s))}):(n.fromAttributes=a,n.fromGraph=a,n.fromEntry=a),n}function ph(t,e){var n={},r=function(o){return typeof o>"u"?e:o};typeof e=="function"&&(r=e);var i=function(o){return r(o[t])},a=function(){return r(void 0)};return typeof t=="string"?(n.fromAttributes=i,n.fromGraph=function(o,s){return i(o.getEdgeAttributes(s))},n.fromEntry=function(o,s){return i(s)},n.fromPartialEntry=n.fromEntry,n.fromMinimalEntry=n.fromEntry):typeof t=="function"?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},n.fromGraph=function(o,s){var l=o.extremities(s);return r(t(s,o.getEdgeAttributes(s),l[0],l[1],o.getNodeAttributes(l[0]),o.getNodeAttributes(l[1]),o.isUndirected(s)))},n.fromEntry=function(o,s,l,u,c,f,d){return r(t(o,s,l,u,c,f,d))},n.fromPartialEntry=function(o,s,l,u){return r(t(o,s,l,u))},n.fromMinimalEntry=function(o,s){return r(t(o,s))}):(n.fromAttributes=a,n.fromGraph=a,n.fromEntry=a,n.fromMinimalEntry=a),n}Br.createNodeValueGetter=a0;Br.createEdgeValueGetter=ph;Br.createEdgeWeightGetter=function(t){return ph(t,i0)};var st=0,Xe=1,Ie=2,Le=3,Tn=4,Sn=5,Ve=6,Nc=7,La=8,jc=9,o0=0,s0=1,l0=2,ft=0,Nt=1,Et=2,er=3,Nn=4,nt=5,Ot=6,cn=7,fn=8,zc=3,nn=10,u0=3,vt=9,Fs=10,c0=function(e,n,r){var i,a,o,s,l,u,c,f,d,h,p=n.length,g=r.length,m=e.adjustSizes,v=e.barnesHutTheta*e.barnesHutTheta,_,w,y,b,S,E,x,A=[];for(o=0;o<p;o+=nn)n[o+Tn]=n[o+Ie],n[o+Sn]=n[o+Le],n[o+Ie]=0,n[o+Le]=0;if(e.outboundAttractionDistribution){for(_=0,o=0;o<p;o+=nn)_+=n[o+Ve];_/=p/nn}if(e.barnesHutOptimize){var V=1/0,F=-1/0,P=1/0,N=-1/0,W,H,L;for(o=0;o<p;o+=nn)V=Math.min(V,n[o+st]),F=Math.max(F,n[o+st]),P=Math.min(P,n[o+Xe]),N=Math.max(N,n[o+Xe]);var G=F-V,B=N-P;for(G>B?(P-=(G-B)/2,N=P+G):(V-=(B-G)/2,F=V+B),A[0+ft]=-1,A[0+Nt]=(V+F)/2,A[0+Et]=(P+N)/2,A[0+er]=Math.max(F-V,N-P),A[0+Nn]=-1,A[0+nt]=-1,A[0+Ot]=0,A[0+cn]=0,A[0+fn]=0,i=1,o=0;o<p;o+=nn)for(a=0,L=zc;;)if(A[a+nt]>=0){n[o+st]<A[a+Nt]?n[o+Xe]<A[a+Et]?W=A[a+nt]:W=A[a+nt]+vt:n[o+Xe]<A[a+Et]?W=A[a+nt]+vt*2:W=A[a+nt]+vt*3,A[a+cn]=(A[a+cn]*A[a+Ot]+n[o+st]*n[o+Ve])/(A[a+Ot]+n[o+Ve]),A[a+fn]=(A[a+fn]*A[a+Ot]+n[o+Xe]*n[o+Ve])/(A[a+Ot]+n[o+Ve]),A[a+Ot]+=n[o+Ve],a=W;continue}else if(A[a+ft]<0){A[a+ft]=o;break}else{if(A[a+nt]=i*vt,f=A[a+er]/2,d=A[a+nt],A[d+ft]=-1,A[d+Nt]=A[a+Nt]-f,A[d+Et]=A[a+Et]-f,A[d+er]=f,A[d+Nn]=d+vt,A[d+nt]=-1,A[d+Ot]=0,A[d+cn]=0,A[d+fn]=0,d+=vt,A[d+ft]=-1,A[d+Nt]=A[a+Nt]-f,A[d+Et]=A[a+Et]+f,A[d+er]=f,A[d+Nn]=d+vt,A[d+nt]=-1,A[d+Ot]=0,A[d+cn]=0,A[d+fn]=0,d+=vt,A[d+ft]=-1,A[d+Nt]=A[a+Nt]+f,A[d+Et]=A[a+Et]-f,A[d+er]=f,A[d+Nn]=d+vt,A[d+nt]=-1,A[d+Ot]=0,A[d+cn]=0,A[d+fn]=0,d+=vt,A[d+ft]=-1,A[d+Nt]=A[a+Nt]+f,A[d+Et]=A[a+Et]+f,A[d+er]=f,A[d+Nn]=A[a+Nn],A[d+nt]=-1,A[d+Ot]=0,A[d+cn]=0,A[d+fn]=0,i+=4,n[A[a+ft]+st]<A[a+Nt]?n[A[a+ft]+Xe]<A[a+Et]?W=A[a+nt]:W=A[a+nt]+vt:n[A[a+ft]+Xe]<A[a+Et]?W=A[a+nt]+vt*2:W=A[a+nt]+vt*3,A[a+Ot]=n[A[a+ft]+Ve],A[a+cn]=n[A[a+ft]+st],A[a+fn]=n[A[a+ft]+Xe],A[W+ft]=A[a+ft],A[a+ft]=-1,n[o+st]<A[a+Nt]?n[o+Xe]<A[a+Et]?H=A[a+nt]:H=A[a+nt]+vt:n[o+Xe]<A[a+Et]?H=A[a+nt]+vt*2:H=A[a+nt]+vt*3,W===H)if(L--){a=W;continue}else{L=zc;break}A[H+ft]=o;break}}if(e.barnesHutOptimize)for(w=e.scalingRatio,o=0;o<p;o+=nn)for(a=0;;)if(A[a+nt]>=0)if(E=Math.pow(n[o+st]-A[a+cn],2)+Math.pow(n[o+Xe]-A[a+fn],2),h=A[a+er],4*h*h/E<v){if(y=n[o+st]-A[a+cn],b=n[o+Xe]-A[a+fn],m===!0?E>0?(x=w*n[o+Ve]*A[a+Ot]/E,n[o+Ie]+=y*x,n[o+Le]+=b*x):E<0&&(x=-w*n[o+Ve]*A[a+Ot]/Math.sqrt(E),n[o+Ie]+=y*x,n[o+Le]+=b*x):E>0&&(x=w*n[o+Ve]*A[a+Ot]/E,n[o+Ie]+=y*x,n[o+Le]+=b*x),a=A[a+Nn],a<0)break;continue}else{a=A[a+nt];continue}else{if(u=A[a+ft],u>=0&&u!==o&&(y=n[o+st]-n[u+st],b=n[o+Xe]-n[u+Xe],E=y*y+b*b,m===!0?E>0?(x=w*n[o+Ve]*n[u+Ve]/E,n[o+Ie]+=y*x,n[o+Le]+=b*x):E<0&&(x=-w*n[o+Ve]*n[u+Ve]/Math.sqrt(E),n[o+Ie]+=y*x,n[o+Le]+=b*x):E>0&&(x=w*n[o+Ve]*n[u+Ve]/E,n[o+Ie]+=y*x,n[o+Le]+=b*x)),a=A[a+Nn],a<0)break;continue}else for(w=e.scalingRatio,s=0;s<p;s+=nn)for(l=0;l<s;l+=nn)y=n[s+st]-n[l+st],b=n[s+Xe]-n[l+Xe],m===!0?(E=Math.sqrt(y*y+b*b)-n[s+La]-n[l+La],E>0?(x=w*n[s+Ve]*n[l+Ve]/E/E,n[s+Ie]+=y*x,n[s+Le]+=b*x,n[l+Ie]-=y*x,n[l+Le]-=b*x):E<0&&(x=100*w*n[s+Ve]*n[l+Ve],n[s+Ie]+=y*x,n[s+Le]+=b*x,n[l+Ie]-=y*x,n[l+Le]-=b*x)):(E=Math.sqrt(y*y+b*b),E>0&&(x=w*n[s+Ve]*n[l+Ve]/E/E,n[s+Ie]+=y*x,n[s+Le]+=b*x,n[l+Ie]-=y*x,n[l+Le]-=b*x));for(d=e.gravity/e.scalingRatio,w=e.scalingRatio,o=0;o<p;o+=nn)x=0,y=n[o+st],b=n[o+Xe],E=Math.sqrt(Math.pow(y,2)+Math.pow(b,2)),e.strongGravityMode?E>0&&(x=w*n[o+Ve]*d):E>0&&(x=w*n[o+Ve]*d/E),n[o+Ie]-=y*x,n[o+Le]-=b*x;for(w=1*(e.outboundAttractionDistribution?_:1),c=0;c<g;c+=u0)s=r[c+o0],l=r[c+s0],f=r[c+l0],S=Math.pow(f,e.edgeWeightInfluence),y=n[s+st]-n[l+st],b=n[s+Xe]-n[l+Xe],m===!0?(E=Math.sqrt(y*y+b*b)-n[s+La]-n[l+La],e.linLogMode?e.outboundAttractionDistribution?E>0&&(x=-w*S*Math.log(1+E)/E/n[s+Ve]):E>0&&(x=-w*S*Math.log(1+E)/E):e.outboundAttractionDistribution?E>0&&(x=-w*S/n[s+Ve]):E>0&&(x=-w*S)):(E=Math.sqrt(Math.pow(y,2)+Math.pow(b,2)),e.linLogMode?e.outboundAttractionDistribution?E>0&&(x=-w*S*Math.log(1+E)/E/n[s+Ve]):E>0&&(x=-w*S*Math.log(1+E)/E):e.outboundAttractionDistribution?(E=1,x=-w*S/n[s+Ve]):(E=1,x=-w*S)),E>0&&(n[s+Ie]+=y*x,n[s+Le]+=b*x,n[l+Ie]-=y*x,n[l+Le]-=b*x);var q,$,R,O,D,T;if(m===!0)for(o=0;o<p;o+=nn)n[o+jc]!==1&&(q=Math.sqrt(Math.pow(n[o+Ie],2)+Math.pow(n[o+Le],2)),q>Fs&&(n[o+Ie]=n[o+Ie]*Fs/q,n[o+Le]=n[o+Le]*Fs/q),$=n[o+Ve]*Math.sqrt((n[o+Tn]-n[o+Ie])*(n[o+Tn]-n[o+Ie])+(n[o+Sn]-n[o+Le])*(n[o+Sn]-n[o+Le])),R=Math.sqrt((n[o+Tn]+n[o+Ie])*(n[o+Tn]+n[o+Ie])+(n[o+Sn]+n[o+Le])*(n[o+Sn]+n[o+Le]))/2,O=.1*Math.log(1+R)/(1+Math.sqrt($)),D=n[o+st]+n[o+Ie]*(O/e.slowDown),n[o+st]=D,T=n[o+Xe]+n[o+Le]*(O/e.slowDown),n[o+Xe]=T);else for(o=0;o<p;o+=nn)n[o+jc]!==1&&($=n[o+Ve]*Math.sqrt((n[o+Tn]-n[o+Ie])*(n[o+Tn]-n[o+Ie])+(n[o+Sn]-n[o+Le])*(n[o+Sn]-n[o+Le])),R=Math.sqrt((n[o+Tn]+n[o+Ie])*(n[o+Tn]+n[o+Ie])+(n[o+Sn]+n[o+Le])*(n[o+Sn]+n[o+Le]))/2,O=n[o+Nc]*Math.log(1+R)/(1+Math.sqrt($)),n[o+Nc]=Math.min(1,Math.sqrt(O*(Math.pow(n[o+Ie],2)+Math.pow(n[o+Le],2))/(1+Math.sqrt($)))),D=n[o+st]+n[o+Ie]*(O/e.slowDown),n[o+st]=D,T=n[o+Xe]+n[o+Le]*(O/e.slowDown),n[o+Xe]=T);return{}},Xn={},$i=10,qc=3;Xn.assign=function(t){t=t||{};var e=Array.prototype.slice.call(arguments).slice(1),n,r,i;for(n=0,i=e.length;n<i;n++)if(e[n])for(r in e[n])t[r]=e[n][r];return t};Xn.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null};Xn.graphToByteArrays=function(t,e){var n=t.order,r=t.size,i={},a,o=new Float32Array(n*$i),s=new Float32Array(r*qc);return a=0,t.forEachNode(function(l,u){i[l]=a,o[a]=u.x,o[a+1]=u.y,o[a+2]=0,o[a+3]=0,o[a+4]=0,o[a+5]=0,o[a+6]=1,o[a+7]=1,o[a+8]=u.size||1,o[a+9]=u.fixed?1:0,a+=$i}),a=0,t.forEachEdge(function(l,u,c,f,d,h,p){var g=i[c],m=i[f],v=e(l,u,c,f,d,h,p);o[g+6]+=v,o[m+6]+=v,s[a]=g,s[a+1]=m,s[a+2]=v,a+=qc}),{nodes:o,edges:s}};Xn.assignLayoutChanges=function(t,e,n){var r=0;t.updateEachNodeAttributes(function(i,a){return a.x=e[r],a.y=e[r+1],r+=$i,n?n(i,a):a})};Xn.readGraphPositions=function(t,e){var n=0;t.forEachNode(function(r,i){e[n]=i.x,e[n+1]=i.y,n+=$i})};Xn.collectLayoutChanges=function(t,e,n){for(var r=t.nodes(),i={},a=0,o=0,s=e.length;a<s;a+=$i){if(n){var l=Object.assign({},t.getNodeAttributes(r[o]));l.x=e[a],l.y=e[a+1],l=n(r[o],l),i[r[o]]={x:l.x,y:l.y}}else i[r[o]]={x:e[a],y:e[a+1]};o++}return i};Xn.createWorker=function(e){var n=window.URL||window.webkitURL,r=e.toString(),i=n.createObjectURL(new Blob(["("+r+").call(this);"],{type:"text/javascript"})),a=new Worker(i);return n.revokeObjectURL(i),a};var f0={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},d0=Kn,h0=Br.createEdgeWeightGetter,p0=c0,hi=Xn,m0=f0;function mh(t,e,n){if(!d0(e))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof n=="number"&&(n={iterations:n});var r=n.iterations;if(typeof r!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(r<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var i=h0("getEdgeWeight"in n?n.getEdgeWeight:"weight").fromEntry,a=typeof n.outputReducer=="function"?n.outputReducer:null,o=hi.assign({},m0,n.settings),s=hi.validateSettings(o);if(s)throw new Error("graphology-layout-forceatlas2: "+s.message);var l=hi.graphToByteArrays(e,i),u;for(u=0;u<r;u++)p0(o,l.nodes,l.edges);if(t){hi.assignLayoutChanges(e,l.nodes,a);return}return hi.collectLayoutChanges(e,l.nodes)}function g0(t){var e=typeof t=="number"?t:t.order;return{barnesHutOptimize:e>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(e)}}var au=mh.bind(null,!1);au.assign=mh.bind(null,!0);au.inferSettings=g0;var v0=au;const y0=Vt(v0);var b0=iu,_0=Kn,w0={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function gh(t,e,n){if(!_0(e))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");n=b0(n,w0);var r=n.dimensions;if(!Array.isArray(r)||r.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var i=r.length,a=n.center,o=n.rng,s=n.scale,l=(a-.5)*s;function u(f){for(var d=0;d<i;d++)f[r[d]]=o()*s+l;return f}if(!t){var c={};return e.forEachNode(function(f){c[f]=u({})}),c}e.updateEachNodeAttributes(function(f,d){return u(d),d},{attributes:r})}var vh=gh.bind(null,!1);vh.assign=gh.bind(null,!0);var E0=vh;const x0=Vt(E0);function T0({graph:t,drags:e,iterations:n,...r}){x0.assign(t);const i=y0(t,{iterations:n,settings:r});return{step(){return!0},getNodePosition(a){var o;return((o=e==null?void 0:e[a])==null?void 0:o.position)||(i==null?void 0:i[a])}}}function S0({graph:t,drags:e,getNodePosition:n}){const{nodes:r,edges:i}=aa(t);return{step(){return!0},getNodePosition(a){return n(a,{graph:t,drags:e,nodes:r,edges:i})}}}const A0=["forceDirected2d","treeTd2d","treeLr2d","radialOut2d","treeTd3d","treeLr3d","radialOut3d","forceDirected3d"];function k0({type:t,...e}){if(A0.includes(t)){const{nodeStrength:n,linkDistance:r,nodeLevelRatio:i}=e;if(t==="forceDirected2d")return Gn({...e,dimensions:2,nodeLevelRatio:i||2,nodeStrength:n||-250,linkDistance:r});if(t==="treeTd2d")return Gn({...e,mode:"td",dimensions:2,nodeLevelRatio:i||5,nodeStrength:n||-250,linkDistance:r||50});if(t==="treeLr2d")return Gn({...e,mode:"lr",dimensions:2,nodeLevelRatio:i||5,nodeStrength:n||-250,linkDistance:r||50});if(t==="radialOut2d")return Gn({...e,mode:"radialout",dimensions:2,nodeLevelRatio:i||5,nodeStrength:n||-500,linkDistance:r||100});if(t==="treeTd3d")return Gn({...e,mode:"td",dimensions:3,nodeLevelRatio:i||2,nodeStrength:n||-500,linkDistance:r||50});if(t==="treeLr3d")return Gn({...e,mode:"lr",dimensions:3,nodeLevelRatio:i||2,nodeStrength:n||-500,linkDistance:r||50});if(t==="radialOut3d")return Gn({...e,mode:"radialout",dimensions:3,nodeLevelRatio:i||2,nodeStrength:n||-500,linkDistance:r||100});if(t==="forceDirected3d")return Gn({...e,dimensions:3,nodeLevelRatio:i||2,nodeStrength:n||-250,linkDistance:r})}else if(t==="circular2d"){const{radius:n}=e;return $y({...e,radius:n||300})}else{if(t==="hierarchicalTd")return Fc({...e,mode:"td"});if(t==="hierarchicalLr")return Fc({...e,mode:"lr"});if(t==="nooverlap"){const{graph:n,maxIterations:r,ratio:i,margin:a,gridSize:o,...s}=e;return r0({type:"nooverlap",graph:n,margin:a||10,maxIterations:r||50,ratio:i||10,gridSize:o||20,...s})}else if(t==="forceatlas2"){const{graph:n,iterations:r,gravity:i,scalingRatio:a,...o}=e;return T0({type:"forceatlas2",graph:n,...o,scalingRatio:a||100,gravity:i||10,iterations:r||50})}else if(t==="custom")return S0({type:"custom",...e})}throw new Error(`Layout ${t} not found.`)}var ou={},su={};(function(t){var e=Math.pow(2,8)-1,n=Math.pow(2,16)-1,r=Math.pow(2,32)-1,i=Math.pow(2,7)-1,a=Math.pow(2,15)-1,o=Math.pow(2,31)-1;t.getPointerArray=function(l){var u=l-1;if(u<=e)return Uint8Array;if(u<=n)return Uint16Array;if(u<=r)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},t.getSignedPointerArray=function(l){var u=l-1;return u<=i?Int8Array:u<=a?Int16Array:u<=o?Int32Array:Float64Array},t.getNumberType=function(l){return l===(l|0)?Math.sign(l)===-1?l<=127&&l>=-128?Int8Array:l<=32767&&l>=-32768?Int16Array:Int32Array:l<=255?Uint8Array:l<=65535?Uint16Array:Uint32Array:Float64Array};var s={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};t.getMinimalRepresentation=function(l,u){var c=null,f=0,d,h,p,g,m;for(g=0,m=l.length;g<m;g++)p=u?u(l[g]):l[g],h=t.getNumberType(p),d=s[h.name],d>f&&(f=d,c=h);return c},t.isTypedArray=function(l){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(l)},t.concat=function(){var l=0,u,c,f;for(u=0,f=arguments.length;u<f;u++)l+=arguments[u].length;var d=new arguments[0].constructor(l);for(u=0,c=0;u<f;u++)d.set(arguments[u],c),c+=arguments[u].length;return d},t.indices=function(l){for(var u=t.getPointerArray(l),c=new u(l),f=0;f<l;f++)c[f]=f;return c}})(su);var uo=su,O0=Br.createEdgeWeightGetter;function yh(t,e){return t==="outbound"||t==="inbound"?e.directedSize+e.undirectedSize*2:t==="in"||t==="out"||t==="directed"?e.directedSize:e.undirectedSize*2}function Rn(t,e){e=e||"outbound";var n=t[e+"Neighbors"].bind(t),r=yh(e,t),i=uo.getPointerArray(r),a=uo.getPointerArray(t.order);this.graph=t,this.neighborhood=new a(r),this.starts=new i(t.order+1),this.nodes=t.nodes();var o={},s,l,u,c,f,d,h=0;for(s=0,l=t.order;s<l;s++)o[this.nodes[s]]=s;for(s=0,l=t.order;s<l;s++)for(f=this.nodes[s],d=n(f),this.starts[s]=h,u=0,c=d.length;u<c;u++)this.neighborhood[h++]=o[d[u]];this.starts[s]=r}Rn.prototype.bounds=function(t){return[this.starts[t],this.starts[t+1]]};Rn.prototype.project=function(){var t=this,e={};return t.nodes.forEach(function(n,r){e[n]=Array.from(t.neighborhood.slice(t.starts[r],t.starts[r+1])).map(function(i){return t.nodes[i]})}),e};Rn.prototype.collect=function(t){var e,n,r={};for(e=0,n=t.length;e<n;e++)r[this.nodes[e]]=t[e];return r};Rn.prototype.assign=function(t,e){var n=0;this.graph.updateEachNodeAttributes(function(r,i){return i[t]=e[n++],i},{attributes:[t]})};ou.NeighborhoodIndex=Rn;function oa(t,e,n){n=n||"outbound";var r=t[n+"Edges"].bind(t),i=yh(n,t),a=uo.getPointerArray(i),o=uo.getPointerArray(t.order),s=O0(e).fromMinimalEntry;this.graph=t,this.neighborhood=new o(i),this.weights=new Float64Array(i),this.outDegrees=new Float64Array(t.order),this.starts=new a(t.order+1),this.nodes=t.nodes();var l={},u,c,f,d,h,p,g,m,v,_=0;for(u=0,c=t.order;u<c;u++)l[this.nodes[u]]=u;for(u=0,c=t.order;u<c;u++)for(h=this.nodes[u],g=r(h),this.starts[u]=_,f=0,d=g.length;f<d;f++)m=g[f],p=t.opposite(h,m),v=s(m,t.getEdgeAttributes(m)),this.neighborhood[_]=l[p],this.weights[_++]=v,this.outDegrees[u]+=v;this.starts[u]=i}oa.prototype.bounds=Rn.prototype.bounds;oa.prototype.project=Rn.prototype.project;oa.prototype.collect=Rn.prototype.collect;oa.prototype.assign=Rn.prototype.assign;ou.WeightedNeighborhoodIndex=oa;var D0=Kn,C0=iu,P0=ou.WeightedNeighborhoodIndex,M0={nodePagerankAttribute:"pagerank",getEdgeWeight:"weight",alpha:.85,maxIterations:100,tolerance:1e-6};function bh(t,e,n){if(!D0(e))throw new Error("graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.");n=C0(n,M0);var r=n.alpha,i=n.maxIterations,a=n.tolerance,o=n.nodePagerankAttribute,s=e.order,l=1/s,u=new P0(e,n.getEdgeWeight),c,f,d,h,p=new Float64Array(e.order),g=new Float64Array(u.weights.length),m=[];for(c=0;c<s;c++)for(p[c]=l,d=u.starts[c+1],h=u.outDegrees[c],h===0&&m.push(c),f=u.starts[c];f<d;f++)g[f]=u.weights[f]/h;for(var v=0,_=0,w,y,b,S=!1;v<i;){for(b=p,p=new Float64Array(e.order),w=0,c=0,d=m.length;c<d;c++)w+=b[m[c]];for(w*=r,c=0;c<s;c++){for(d=u.starts[c+1],f=u.starts[c];f<d;f++)y=u.neighborhood[f],p[y]+=r*b[c]*g[f];p[c]+=w*l+(1-r)*l}for(_=0,c=0;c<s;c++)_+=Math.abs(p[c]-b[c]);if(_<s*a){S=!0;break}v++}if(!S)throw Error("graphology-metrics/centrality/pagerank: failed to converge.");if(t){u.assign(o,p);return}return u.collect(p)}var _h=bh.bind(null,!1);_h.assign=bh.bind(null,!0);var R0=_h;const I0=Vt(R0);function L0({graph:t}){const e=I0(t);return{ranks:e,getSizeForNode:n=>e[n]*80}}var U0=Kn;function Wr(t,e,n,r){var i=e+"Centrality";if(!U0(n))throw new Error("graphology-centrality/"+i+": the given graph is not a valid graphology instance.");if(e!=="degree"&&n.type==="undirected")throw new Error("graphology-centrality/"+i+": cannot compute "+e+" centrality on an undirected graph.");r=r||{};var a=r.nodeCentralityAttribute||i,o=n.order-1,s=n[e].bind(n);if(t){n.updateEachNodeAttributes(function(u,c){return c[a]=s(u)/o,c},{attributes:[a]});return}var l={};return n.forEachNode(function(u){l[u]=s(u)/o}),l}var wh=Wr.bind(null,!1,"degree"),V0=Wr.bind(null,!1,"inDegree"),F0=Wr.bind(null,!1,"outDegree");wh.assign=Wr.bind(null,!0,"degree");V0.assign=Wr.bind(null,!0,"inDegree");F0.assign=Wr.bind(null,!0,"outDegree");var G0=wh;function N0({graph:t}){const e=G0(t);return{ranks:e,getSizeForNode:n=>e[n]*20}}function j0({graph:t,attribute:e,defaultSize:n}){const r=new Map;return e?t.forEachNode((i,a)=>{var s;const o=(s=a.data)==null?void 0:s[e];isNaN(o)&&console.warn(`Attribute ${o} is not a number for node ${a.id}`),r.set(i,o||0)}):console.warn("Attribute sizing configured but no attribute provided"),{getSizeForNode:i=>!e||!r?n:r.get(i)}}function to(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function z0(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Eh(t){let e,n,r;t.length!==2?(e=to,n=(s,l)=>to(t(s),l),r=(s,l)=>t(s)-l):(e=t===to||t===z0?t:q0,n=t,r=t);function i(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(s[f],l)<0?u=f+1:c=f}while(u<c)}return u}function a(s,l,u=0,c=s.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(s[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function o(s,l,u=0,c=s.length){const f=i(s,l,u,c-1);return f>u&&r(s[f-1],l)>-r(s[f],l)?f-1:f}return{left:i,center:o,right:a}}function q0(){return 0}function B0(t){return t===null?NaN:+t}const W0=Eh(to),$0=W0.right;Eh(B0).center;const H0=$0,Y0=Math.sqrt(50),K0=Math.sqrt(10),X0=Math.sqrt(2);function co(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Y0?10:a>=K0?5:a>=X0?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=n&&n<2?co(t,e,n*2):[s,l,u]}function Z0(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,a,o]=r?co(e,t,n):co(t,e,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let u=0;u<s;++u)l[u]=(a-u)/-o;else for(let u=0;u<s;++u)l[u]=(a-u)*o;else if(o<0)for(let u=0;u<s;++u)l[u]=(i+u)/-o;else for(let u=0;u<s;++u)l[u]=(i+u)*o;return l}function yl(t,e,n){return e=+e,t=+t,n=+n,co(t,e,n)[2]}function Q0(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?yl(e,t,n):yl(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function J0(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function lu(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function xh(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function sa(){}var Hi=.7,fo=1/Hi,Pr="\\s*([+-]?\\d+)\\s*",Yi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eb=/^#([0-9a-f]{3,8})$/,tb=new RegExp(`^rgb\\(${Pr},${Pr},${Pr}\\)$`),nb=new RegExp(`^rgb\\(${bn},${bn},${bn}\\)$`),rb=new RegExp(`^rgba\\(${Pr},${Pr},${Pr},${Yi}\\)$`),ib=new RegExp(`^rgba\\(${bn},${bn},${bn},${Yi}\\)$`),ab=new RegExp(`^hsl\\(${Yi},${bn},${bn}\\)$`),ob=new RegExp(`^hsla\\(${Yi},${bn},${bn},${Yi}\\)$`),Bc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};lu(sa,Ki,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Wc,formatHex:Wc,formatHex8:sb,formatHsl:lb,formatRgb:$c,toString:$c});function Wc(){return this.rgb().formatHex()}function sb(){return this.rgb().formatHex8()}function lb(){return Th(this).formatHsl()}function $c(){return this.rgb().formatRgb()}function Ki(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=eb.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Hc(e):n===3?new Ct(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ua(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ua(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=tb.exec(t))?new Ct(e[1],e[2],e[3],1):(e=nb.exec(t))?new Ct(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=rb.exec(t))?Ua(e[1],e[2],e[3],e[4]):(e=ib.exec(t))?Ua(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ab.exec(t))?Xc(e[1],e[2]/100,e[3]/100,1):(e=ob.exec(t))?Xc(e[1],e[2]/100,e[3]/100,e[4]):Bc.hasOwnProperty(t)?Hc(Bc[t]):t==="transparent"?new Ct(NaN,NaN,NaN,0):null}function Hc(t){return new Ct(t>>16&255,t>>8&255,t&255,1)}function Ua(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ct(t,e,n,r)}function ub(t){return t instanceof sa||(t=Ki(t)),t?(t=t.rgb(),new Ct(t.r,t.g,t.b,t.opacity)):new Ct}function bl(t,e,n,r){return arguments.length===1?ub(t):new Ct(t,e,n,r??1)}function Ct(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}lu(Ct,bl,xh(sa,{brighter(t){return t=t==null?fo:Math.pow(fo,t),new Ct(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Hi:Math.pow(Hi,t),new Ct(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ct(sr(this.r),sr(this.g),sr(this.b),ho(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yc,formatHex:Yc,formatHex8:cb,formatRgb:Kc,toString:Kc}));function Yc(){return`#${or(this.r)}${or(this.g)}${or(this.b)}`}function cb(){return`#${or(this.r)}${or(this.g)}${or(this.b)}${or((isNaN(this.opacity)?1:this.opacity)*255)}`}function Kc(){const t=ho(this.opacity);return`${t===1?"rgb(":"rgba("}${sr(this.r)}, ${sr(this.g)}, ${sr(this.b)}${t===1?")":`, ${t})`}`}function ho(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function sr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function or(t){return t=sr(t),(t<16?"0":"")+t.toString(16)}function Xc(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new sn(t,e,n,r)}function Th(t){if(t instanceof sn)return new sn(t.h,t.s,t.l,t.opacity);if(t instanceof sa||(t=Ki(t)),!t)return new sn;if(t instanceof sn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(e===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-e)/s+2:o=(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new sn(o,s,l,t.opacity)}function fb(t,e,n,r){return arguments.length===1?Th(t):new sn(t,e,n,r??1)}function sn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}lu(sn,fb,xh(sa,{brighter(t){return t=t==null?fo:Math.pow(fo,t),new sn(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Hi:Math.pow(Hi,t),new sn(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ct(Gs(t>=240?t-240:t+120,i,r),Gs(t,i,r),Gs(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new sn(Zc(this.h),Va(this.s),Va(this.l),ho(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ho(this.opacity);return`${t===1?"hsl(":"hsla("}${Zc(this.h)}, ${Va(this.s)*100}%, ${Va(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Zc(t){return t=(t||0)%360,t<0?t+360:t}function Va(t){return Math.max(0,Math.min(1,t||0))}function Gs(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const uu=t=>()=>t;function db(t,e){return function(n){return t+n*e}}function hb(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function pb(t){return(t=+t)==1?Sh:function(e,n){return n-e?hb(e,n,t):uu(isNaN(e)?n:e)}}function Sh(t,e){var n=e-t;return n?db(t,n):uu(isNaN(t)?e:t)}const Qc=function t(e){var n=pb(e);function r(i,a){var o=n((i=bl(i)).r,(a=bl(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),u=Sh(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function mb(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function gb(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function vb(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=cu(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function yb(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function po(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function bb(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=cu(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var _l=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ns=new RegExp(_l.source,"g");function _b(t){return function(){return t}}function wb(t){return function(e){return t(e)+""}}function Eb(t,e){var n=_l.lastIndex=Ns.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(t=t+"",e=e+"";(r=_l.exec(t))&&(i=Ns.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:po(r,i)})),n=Ns.lastIndex;return n<e.length&&(a=e.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?wb(l[0].x):_b(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function cu(t,e){var n=typeof e,r;return e==null||n==="boolean"?uu(e):(n==="number"?po:n==="string"?(r=Ki(e))?(e=r,Qc):Eb:e instanceof Ki?Qc:e instanceof Date?yb:gb(e)?mb:Array.isArray(e)?vb:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?bb:po)(t,e)}function xb(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Tb(t){return function(){return t}}function Sb(t){return+t}var Jc=[0,1];function kr(t){return t}function wl(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Tb(isNaN(e)?NaN:.5)}function Ab(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function kb(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=wl(i,r),a=n(o,a)):(r=wl(r,i),a=n(a,o)),function(s){return a(r(s))}}function Ob(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=wl(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(s){var l=H0(t,s,1,r)-1;return a[l](i[l](s))}}function Db(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Cb(){var t=Jc,e=Jc,n=cu,r,i,a,o=kr,s,l,u;function c(){var d=Math.min(t.length,e.length);return o!==kr&&(o=Ab(t[0],t[d-1])),s=d>2?Ob:kb,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?a:(l||(l=s(t.map(r),e,n)))(r(o(d)))}return f.invert=function(d){return o(i((u||(u=s(e,t.map(r),po)))(d)))},f.domain=function(d){return arguments.length?(t=Array.from(d,Sb),c()):t.slice()},f.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},f.rangeRound=function(d){return e=Array.from(d),n=xb,c()},f.clamp=function(d){return arguments.length?(o=d?!0:kr,c()):o!==kr},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,h){return r=d,i=h,c()}}function Pb(){return Cb()(kr,kr)}function Mb(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function mo(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Vr(t){return t=mo(Math.abs(t)),t?t[1]:NaN}function Rb(t,e){return function(n,r){for(var i=n.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function Ib(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Lb=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function go(t){if(!(e=Lb.exec(t)))throw new Error("invalid format: "+t);var e;return new fu({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}go.prototype=fu.prototype;function fu(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}fu.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ub(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Ah;function Vb(t,e){var n=mo(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Ah=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+mo(t,Math.max(0,e+a-1))[0]}function ef(t,e){var n=mo(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const tf={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Mb,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ef(t*100,e),r:ef,s:Vb,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function nf(t){return t}var rf=Array.prototype.map,af=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Fb(t){var e=t.grouping===void 0||t.thousands===void 0?nf:Rb(rf.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?nf:Ib(rf.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=go(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,_=f.comma,w=f.precision,y=f.trim,b=f.type;b==="n"?(_=!0,b="g"):tf[b]||(w===void 0&&(w=12),y=!0,b="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",E=g==="$"?r:/[%p]/.test(b)?o:"",x=tf[b],A=/[defgprs%]/.test(b);w=w===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function V(F){var P=S,N=E,W,H,L;if(b==="c")N=x(F)+N,F="";else{F=+F;var G=F<0||1/F<0;if(F=isNaN(F)?l:x(Math.abs(F),w),y&&(F=Ub(F)),G&&+F==0&&p!=="+"&&(G=!1),P=(G?p==="("?p:s:p==="-"||p==="("?"":p)+P,N=(b==="s"?af[8+Ah/3]:"")+N+(G&&p==="("?")":""),A){for(W=-1,H=F.length;++W<H;)if(L=F.charCodeAt(W),48>L||L>57){N=(L===46?i+F.slice(W+1):F.slice(W))+N,F=F.slice(0,W);break}}}_&&!m&&(F=e(F,1/0));var B=P.length+F.length+N.length,q=B<v?new Array(v-B+1).join(d):"";switch(_&&m&&(F=e(q+F,q.length?v-N.length:1/0),q=""),h){case"<":F=P+F+N+q;break;case"=":F=P+q+F+N;break;case"^":F=q.slice(0,B=q.length>>1)+P+F+N+q.slice(B);break;default:F=q+P+F+N;break}return a(F)}return V.toString=function(){return f+""},V}function c(f,d){var h=u((f=go(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Vr(d)/3)))*3,g=Math.pow(10,-p),m=af[8+p/3];return function(v){return h(g*v)+m}}return{format:u,formatPrefix:c}}var Fa,kh,Oh;Gb({thousands:",",grouping:[3],currency:["$",""]});function Gb(t){return Fa=Fb(t),kh=Fa.format,Oh=Fa.formatPrefix,Fa}function Nb(t){return Math.max(0,-Vr(Math.abs(t)))}function jb(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Vr(e)/3)))*3-Vr(Math.abs(t)))}function zb(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Vr(e)-Vr(t))+1}function qb(t,e,n,r){var i=Q0(t,e,n),a;switch(r=go(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=jb(i,o))&&(r.precision=a),Oh(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=zb(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Nb(i))&&(r.precision=a-(r.type==="%")*2);break}}return kh(r)}function Bb(t){var e=t.domain;return t.ticks=function(n){var r=e();return Z0(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return qb(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],s=r[a],l,u,c=10;for(s<o&&(u=o,o=s,s=u,u=i,i=a,a=u);c-- >0;){if(u=yl(o,s,n),u===l)return r[i]=o,r[a]=s,e(r);if(u>0)o=Math.floor(o/u)*u,s=Math.ceil(s/u)*u;else if(u<0)o=Math.ceil(o*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function Dh(){var t=Pb();return t.copy=function(){return Db(t,Dh())},J0.apply(t,arguments),Bb(t)}const js={pagerank:L0,centrality:N0,attribute:j0,none:({defaultSize:t})=>({getSizeForNode:e=>t})};function Wb({type:t,...e}){var u;const n=(u=js[t])==null?void 0:u.call(js,e);if(!n&&t!=="default")throw new Error(`Unknown sizing strategy: ${t}`);const{graph:r,minSize:i,maxSize:a}=e,o=new Map;let s,l;if(r.forEachNode((c,f)=>{let d;t==="default"?d=f.size||e.defaultSize:d=n.getSizeForNode(c),(s===void 0||d<s)&&(s=d),(l===void 0||d>l)&&(l=d),o.set(c,d)}),t!=="none"){const c=Dh().domain([s,l]).rangeRound([i,a]);for(const[f,d]of o)o.set(f,c(d))}return o}const $b=20;function Hb(t,e){return(n,r)=>e==="all"||e==="nodes"&&n==="node"||e==="edges"&&n==="edge"?!0:e==="auto"&&n==="node"?t<=$b?!0:r>7:!1}function Ch(t,e){switch(e){case"above":return t;case"below":return-t;case"inline":case"natural":default:return 0}}function Yb(t,e,n){t.clear();for(const r of e)try{t.addNode(r.id,r)}catch({message:i}){console.error(`[Graph] ${i}`)}for(const r of n)try{t.addEdge(r.source,r.target,r)}catch({message:i}){console.error(`[Graph] ${i}`)}return t}function Kb({graph:t,layout:e,sizingType:n,labelType:r,sizingAttribute:i,defaultNodeSize:a,minNodeSize:o,maxNodeSize:s}){const l=[],u=[],c=new Map,f=Wb({graph:t,type:n,attribute:i,minSize:o,maxSize:s,defaultSize:a}),d=t.nodes.length,h=Hb(d,r);return t.forEachNode((p,g)=>{const m=e.getNodePosition(p),{data:v,fill:_,icon:w,label:y,size:b,...S}=g,E=f.get(g.id),x=h("node",E),V=(t.inboundNeighbors(g.id)||[]).map(P=>t.getNodeAttributes(P)),F={...g,size:E,labelVisible:x,label:y,icon:w,fill:_,parents:V,data:{...S,...v??{}},position:{...m,x:m.x||0,y:m.y||0,z:m.z||1}};c.set(g.id,F),l.push(F)}),t.forEachEdge((p,g)=>{const m=c.get(g.source),v=c.get(g.target);if(m&&v){const{data:_,id:w,label:y,size:b,...S}=g,E=h("edge",b);u.push({...g,id:w,label:y,labelVisible:E,size:b,data:{...S,id:w,..._||{}}})}}),{nodes:l,edges:u}}const of=t=>{let e;const n=new Set,r=(l,u)=>{const c=typeof l=="function"?l(e):l;if(!Object.is(c,e)){const f=e;e=u??typeof c!="object"?c:Object.assign({},e,c),n.forEach(d=>d(e,f))}},i=()=>e,s={setState:r,getState:i,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{n.clear()}};return e=t(r,i,s),s},Xb=t=>t?of(t):of;var Ph={exports:{}},Mh={},Rh={exports:{}},Ih={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fr=I;function Zb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qb=typeof Object.is=="function"?Object.is:Zb,Jb=Fr.useState,e1=Fr.useEffect,t1=Fr.useLayoutEffect,n1=Fr.useDebugValue;function r1(t,e){var n=e(),r=Jb({inst:{value:n,getSnapshot:e}}),i=r[0].inst,a=r[1];return t1(function(){i.value=n,i.getSnapshot=e,zs(i)&&a({inst:i})},[t,n,e]),e1(function(){return zs(i)&&a({inst:i}),t(function(){zs(i)&&a({inst:i})})},[t]),n1(n),n}function zs(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Qb(t,n)}catch{return!0}}function i1(t,e){return e()}var a1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?i1:r1;Ih.useSyncExternalStore=Fr.useSyncExternalStore!==void 0?Fr.useSyncExternalStore:a1;Rh.exports=Ih;var o1=Rh.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=I,s1=o1;function l1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var u1=typeof Object.is=="function"?Object.is:l1,c1=s1.useSyncExternalStore,f1=Wo.useRef,d1=Wo.useEffect,h1=Wo.useMemo,p1=Wo.useDebugValue;Mh.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var a=f1(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=h1(function(){function l(h){if(!u){if(u=!0,c=h,h=r(h),i!==void 0&&o.hasValue){var p=o.value;if(i(p,h))return f=p}return f=h}if(p=f,u1(c,h))return p;var g=r(h);return i!==void 0&&i(p,g)?p:(c=h,f=g)}var u=!1,c,f,d=n===void 0?null:n;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,n,r,i]);var s=c1(t,a[0],a[1]);return d1(function(){o.hasValue=!0,o.value=s},[s]),p1(s),s};Ph.exports=Mh;var m1=Ph.exports;const g1=Vt(m1),{useSyncExternalStoreWithSelector:v1}=g1;function Lh(t,e=t.getState,n){const r=v1(t.subscribe,t.getState,t.getServerState||t.getState,e,n);return I.useDebugValue(r),r}const sf=t=>{const e=typeof t=="function"?Xb(t):t,n=(r,i)=>Lh(e,r,i);return Object.assign(n,e),n},y1=t=>t?sf(t):sf;function b1(){const t=I.createContext(void 0);return{Provider:({createStore:i,children:a})=>{const o=I.useRef();return o.current||(o.current=i()),I.createElement(t.Provider,{value:o.current},a)},useStore:(i,a)=>{const o=I.useContext(t);if(!o)throw new Error("Seems like you have not used zustand provider as an ancestor.");return Lh(o,i,a)},useStoreApi:()=>{const i=I.useContext(t);if(!i)throw new Error("Seems like you have not used zustand provider as an ancestor.");return I.useMemo(()=>({...i}),[i])}}}const Lt={mass:10,tension:1e3,friction:300,precision:.1};function Uh(t,e,n){const r=e.getLength(),i=t==="end"?r:r/2,a=t==="end"?n/2:0,o=(i-a)/r,s=e.getPointAt(o),l=e.getTangentAt(o);return[s,l]}function Vh(t){return[t+6,2+t/1.5]}function Fh(t,e,n=0){const r=new Ee(t.x,t.y||0,t.z||0),i=new Ee(e.x,e.y||0,e.z||0),a=new Ee().addVectors(r,i).divideScalar(2);return a.setLength(a.length()+n)}function _1(t,e,n=-1){const r=t.clone(),i=e.clone(),a=new Ee().subVectors(i,r),o=a.length(),s=a.clone().normalize(),l=new Ee().subVectors(i,r).divideScalar(2),u=Math.abs(s.x)%1,c=new Ee(-s.y,s.x-u*s.z,u*s.y).normalize(),f=new Ee().add(r).add(l).add(c.multiplyScalar(o/4).multiplyScalar(n));return[t,f,e]}function Xi(t,e,n,r,i){const a=lf(t,n,e),o=lf(n,t,r);return i?new Wm(..._1(a,o)):new $m(a,o)}function Zi(t){return new Ee(t.position.x,t.position.y,t.position.z||0)}function lf(t,e,n){const r=t.distanceTo(e);return t.clone().add(e.clone().sub(t).multiplyScalar(n/r))}function uf(t,e){return{...t,position:{...t.position,x:t.position.x+e.x,y:t.position.y+e.y,z:t.position.z+e.z}}}function El(t){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let s of t)e=Math.min(e,s.position.x),n=Math.max(n,s.position.x),r=Math.min(r,s.position.y),i=Math.max(i,s.position.y),a=Math.min(a,s.position.z),o=Math.max(o,s.position.z);return{height:i-r,width:n-e,minX:e,maxX:n,minY:r,maxY:i,minZ:a,maxZ:o,x:(n+e)/2,y:(i+r)/2,z:(o+a)/2}}function w1(t,e){return e?t.reduce((n,r)=>{const i=r.data[e];return n.set(i,[...n.get(i)||[],r]),n},new Map):new Map}function E1({nodes:t,clusterAttribute:e}){const n=new Map;if(e){const r=w1(t,e);for(const[i,a]of r){const o=El(a);n.set(i,{label:i,nodes:a,position:o})}}return n}const du=({sensitivity:t=7,interval:e=50,timeout:n=0,disabled:r,onPointerOver:i,onPointerOut:a})=>{const o=I.useRef(!1),s=I.useRef(null),l=I.useRef(0),u=I.useRef({x:null,y:null,px:null,py:null}),c=I.useCallback(m=>{u.current.x=m.clientX,u.current.y=m.clientY},[]),f=I.useCallback(m=>{s.current=clearTimeout(s.current);const{px:v,x:_,py:w,y}=u.current;Math.abs(v-_)+Math.abs(w-y)<t?(l.current=1,i(m)):(u.current.px=_,u.current.py=y,s.current=setTimeout(()=>f(m),e))},[e,i,t]),d=I.useCallback(()=>{clearTimeout(s.current),document.removeEventListener("mousemove",c,!1)},[c]),h=I.useCallback(m=>{r||(o.current=!0,d(),l.current!==1&&(u.current.px=m.pointer.x,u.current.py=m.pointer.y,document.addEventListener("mousemove",c,!1),s.current=setTimeout(()=>f(m),n)))},[d,f,r,c,n]),p=I.useCallback(m=>{s.current=clearTimeout(s.current),l.current=0,a(m)},[a]),g=I.useCallback(m=>{o.current=!1,d(),l.current===1&&(s.current=setTimeout(()=>p(m),n))},[d,p,n]);return{pointerOver:h,pointerOut:g}};function vo(t,e){return t.map(function(n,r){return n+e[r]})}function $o(t,e){return t.map(function(n,r){return n-e[r]})}function Qi(t){return Math.hypot.apply(Math,t)}function Gh(t,e){e===void 0&&(e=t);var n=Qi(e),r=n===0?0:1/n,i=e.map(function(o){return r*o}),a=Qi(t);return{distance:a,direction:i}}function Nh(t,e,n){var r=Qi(e),i=r===0?0:1/r,a=n===0?0:1/n,o=a*r,s=e.map(function(c){return a*c}),l=e.map(function(c){return i*c}),u=Qi(t);return{velocities:s,velocity:o,distance:u,direction:l}}function yo(t){return Math.sign?Math.sign(t):+(t>0)-+(t<0)||+t}function x1(t,e,n){return Math.max(e,Math.min(t,n))}function T1(t,e){return Math.pow(t,e*5)}function cf(t,e,n){return e===0||Math.abs(e)===1/0?T1(t,n):t*e*n/(e+n*t)}function ff(t,e,n,r){return r===void 0&&(r=.15),r===0?x1(t,e,n):t<e?-cf(e-t,n-e,r)+e:t>n?+cf(t-n,n-e,r)+n:t}function df(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S1(t,e,n){return e&&df(t.prototype,e),n&&df(t,n),t}function Ce(){return Ce=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ce.apply(this,arguments)}function pr(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function A1(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,a;for(a=0;a<r.length;a++)i=r[a],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Ue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k1(t,e){if(t){if(typeof t=="string")return hf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hf(t,e)}}function hf(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ho(t,e){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=k1(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return n=t[Symbol.iterator](),n.next.bind(n)}function jh(){}function zh(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?jh:e.length===1?e[0]:function(){for(var r,i=Ho(e),a;!(a=i()).done;){var o=a.value;r=o.apply(this,arguments)||r}return r}}function Bn(t,e){if(t===void 0){if(e===void 0)throw new Error("Must define fallback value if undefined is expected");t=e}return Array.isArray(t)?t:[t,t]}function pf(t,e){return Object.assign({},e,t||{})}function bo(t){if(typeof t=="function"){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,n)}else return t}function la(t,e){t===void 0&&(t={});for(var n={},r=0,i=Object.entries(e);r<i.length;r++){var a=i[r],o=a[0],s=a[1];switch(typeof s){case"function":n[o]=s.call(n,t[o],o,t);break;case"object":n[o]=la(t[o],s);break;case"boolean":s&&(n[o]=t[o]);break}}return n}function O1(){try{return"constructor"in GestureEvent}catch{return!1}}function qh(){return typeof window<"u"&&"ontouchstart"in window}function D1(){return typeof window<"u"&&"onpointerdown"in window}function Bh(t){return"pointerId"in t?null:t.type==="touchend"?t.changedTouches:t.targetTouches}function hu(t){return Array.from(Bh(t)).map(function(e){return e.identifier})}function Wt(t){var e="buttons"in t?t.buttons:0,n=t.shiftKey,r=t.altKey,i=t.metaKey,a=t.ctrlKey;return{buttons:e,shiftKey:n,altKey:r,metaKey:i,ctrlKey:a}}var ua=function(e){return e};function Or(t,e){e===void 0&&(e=ua);var n=Bh(t),r=n?n[0]:t,i=r.clientX,a=r.clientY;return e([i,a])}function mf(t,e,n){n===void 0&&(n=ua);var r=Array.from(t.touches).filter(function(p){return e.includes(p.identifier)}),i=r[0],a=r[1];if(!i||!a)throw Error("The event doesn't have two pointers matching the pointerIds");var o=a.clientX-i.clientX,s=a.clientY-i.clientY,l=(a.clientX+i.clientX)/2,u=(a.clientY+i.clientY)/2,c=Math.hypot(o,s),f=-(Math.atan2(o,s)*180)/Math.PI,d=n([c,f]),h=n([l,u]);return{values:d,origin:h}}function C1(t,e){e===void 0&&(e=ua);var n=t.currentTarget,r=n.scrollX,i=n.scrollY,a=n.scrollLeft,o=n.scrollTop;return e([r||a||0,i||o||0])}var gf=40,vf=800;function Wh(t,e){e===void 0&&(e=ua);var n=t.deltaX,r=t.deltaY,i=t.deltaMode;return i===1?(n*=gf,r*=gf):i===2&&(n*=vf,r*=vf),e([n,r])}function yf(t,e){return e===void 0&&(e=ua),e([t.scale,t.rotation])}var P1=180,M1=.15,R1=.5,I1=50,L1=250,$h={threshold:function(e){return e===void 0&&(e=0),Bn(e)},rubberband:function(e){switch(e===void 0&&(e=0),e){case!0:return Bn(M1);case!1:return Bn(0);default:return Bn(e)}},enabled:function(e){return e===void 0&&(e=!0),e},triggerAllEvents:function(e){return e===void 0&&(e=!1),e},initial:function(e){return e===void 0&&(e=0),typeof e=="function"?e:Bn(e)},transform:!0},pu=Ce({},$h,{axis:!0,lockDirection:function(e){return e===void 0&&(e=!1),e},bounds:function(e){if(e===void 0&&(e={}),typeof e=="function")return function(f){return pu.bounds(e(f))};var n=e,r=n.left,i=r===void 0?-1/0:r,a=n.right,o=a===void 0?1/0:a,s=n.top,l=s===void 0?-1/0:s,u=n.bottom,c=u===void 0?1/0:u;return[[i,o],[l,c]]}}),U1=typeof window<"u"&&window.document&&window.document.createElement,V1={enabled:function(e){return e===void 0&&(e=!0),e},domTarget:!0,window:function(t){function e(n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return t===void 0&&(t=U1?window:void 0),t}),eventOptions:function(e){var n=e===void 0?{}:e,r=n.passive,i=r===void 0?!0:r,a=n.capture,o=a===void 0?!1:a;return{passive:i,capture:o}},transform:!0},F1=Ce({},$h,{bounds:function(e,n,r){var i=r.distanceBounds,a=i===void 0?{}:i,o=r.angleBounds,s=o===void 0?{}:o,l=function(f){var d=pf(bo(a,f),{min:-1/0,max:1/0});return[d.min,d.max]},u=function(f){var d=pf(bo(s,f),{min:-1/0,max:1/0});return[d.min,d.max]};return typeof a!="function"&&typeof s!="function"?[l(),u()]:function(c){return[l(c),u(c)]}}}),G1=Ce({},pu,{useTouch:function(e){e===void 0&&(e=!1);var n=qh(),r=D1();return!!(e&&n||n&&!r)},experimental_preventWindowScrollY:function(e){return e===void 0&&(e=!1),e},threshold:function(e,n,r){var i=r.filterTaps,a=i===void 0?!1:i,o=r.lockDirection,s=o===void 0?!1:o,l=r.axis,u=l===void 0?void 0:l,c=Bn(e,a?3:s||u?1:0);return this.filterTaps=a,c},swipeVelocity:function(e){return e===void 0&&(e=R1),Bn(e)},swipeDistance:function(e){return e===void 0&&(e=I1),Bn(e)},swipeDuration:function(e){return e===void 0&&(e=L1),e},delay:function(e){switch(e===void 0&&(e=0),e){case!0:return P1;case!1:return 0;default:return e}}});function N1(t){return t===void 0&&(t={}),la(t,V1)}function qs(t){return t===void 0&&(t={}),la(t,pu)}function j1(t){return t===void 0&&(t={}),la(t,F1)}function z1(t){return t===void 0&&(t={}),la(t,G1)}function q1(t,e){t===void 0&&(t={}),e===void 0&&(e=new Set);var n=t,r=n.drag,i=n.wheel,a=n.move,o=n.scroll,s=n.pinch,l=n.hover,u=n.eventOptions,c=n.window,f=n.transform,d=n.domTarget,h=n.enabled,p=N1({domTarget:d,eventOptions:u,transform:f,window:c,enabled:h});return e.has("onDrag")&&(p.drag=z1(r)),e.has("onWheel")&&(p.wheel=qs(i)),e.has("onScroll")&&(p.scroll=qs(o)),e.has("onMove")&&(p.move=qs(a)),e.has("onPinch")&&(p.pinch=j1(s)),e.has("onHover")&&(p.hover=Ce({enabled:!0},l)),p}function pi(t){return Ce({_active:!1,_blocked:!1,_intentional:[!1,!1],_movement:[0,0],_initial:[0,0],_bounds:[[-1/0,1/0],[-1/0,1/0]],_threshold:[0,0],_lastEventType:void 0,_dragStarted:!1,_dragPreventScroll:!1,_dragIsTap:!0,_dragDelayed:!1,event:void 0,intentional:!1,values:[0,0],velocities:[0,0],delta:[0,0],movement:[0,0],offset:[0,0],lastOffset:[0,0],direction:[0,0],initial:[0,0],previous:[0,0],first:!1,last:!1,active:!1,timeStamp:0,startTime:0,elapsedTime:0,cancel:jh,canceled:!1,memo:void 0,args:void 0},t)}function Hh(){var t={hovering:!1,scrolling:!1,wheeling:!1,dragging:!1,moving:!1,pinching:!1,touches:0,buttons:0,down:!1,shiftKey:!1,altKey:!1,metaKey:!1,ctrlKey:!1,locked:!1},e=pi({_pointerId:void 0,axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0,tap:!1,swipe:[0,0]}),n=pi({_pointerIds:[],da:[0,0],vdva:[0,0],origin:void 0,turns:0}),r=pi({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0}),i=pi({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0}),a=pi({axis:void 0,xy:[0,0],vxvy:[0,0],velocity:0,distance:0});return{shared:t,drag:e,pinch:n,wheel:r,move:i,scroll:a}}var $t=new Map,B1=function(e){return e},Yh=function(){function t(n,r){var i=this;r===void 0&&(r=[]),this.controller=n,this.args=r,this.debounced=!0,this.setTimeout=function(a,o){var s;o===void 0&&(o=140),clearTimeout(i.controller.timeouts[i.stateKey]);for(var l=arguments.length,u=new Array(l>2?l-2:0),c=2;c<l;c++)u[c-2]=arguments[c];i.controller.timeouts[i.stateKey]=(s=window).setTimeout.apply(s,[a,o].concat(u))},this.clearTimeout=function(){clearTimeout(i.controller.timeouts[i.stateKey])},this.fireGestureHandler=function(a){if(a===void 0&&(a=!1),i.state._blocked)return i.debounced||(i.state._active=!1,i.clean()),null;if(!a&&!i.state.intentional&&!i.config.triggerAllEvents)return null;if(i.state.intentional){var o=i.state.active,s=i.state._active;i.state.active=s,i.state.first=s&&!o,i.state.last=o&&!s,i.controller.state.shared[i.ingKey]=s}var l=i.controller.pointerIds.size||i.controller.touchIds.size,u=i.controller.state.shared.buttons>0||l>0,c=Ce({},i.controller.state.shared,i.state,i.mapStateValues(i.state),{locked:!!document.pointerLockElement,touches:l,down:u}),f=i.handler(c);return i.state.memo=f!==void 0?f:i.state.memo,c},this.controller=n,this.args=r}var e=t.prototype;return e.updateSharedState=function(r){Object.assign(this.controller.state.shared,r)},e.updateGestureState=function(r){Object.assign(this.state,r)},e.checkIntentionality=function(r,i){return{_intentional:r,_blocked:!1}},e.getMovement=function(r){var i=this.config.rubberband,a=this.state,o=a._bounds,s=a._initial,l=a._active,u=a._intentional,c=a.lastOffset,f=a.movement,d=a._threshold,h=this.getInternalMovement(r,this.state),p=u[0]===!1?bf(h[0],d[0]):u[0],g=u[1]===!1?bf(h[1],d[1]):u[1],m=this.checkIntentionality([p,g],h);if(m._blocked)return Ce({},m,{_movement:h,delta:[0,0]});var v=m._intentional,_=h,w=[v[0]!==!1?h[0]-v[0]:0,v[1]!==!1?h[1]-v[1]:0],y=vo(w,c),b=l?i:[0,0];return w=_f(o,vo(w,s),b),Ce({},m,{intentional:v[0]!==!1||v[1]!==!1,_initial:s,_movement:_,movement:w,values:r,offset:_f(o,y,b),delta:$o(w,f)})},e.clean=function(){this.clearTimeout()},S1(t,[{key:"config",get:function(){return this.controller.config[this.stateKey]}},{key:"enabled",get:function(){return this.controller.config.enabled&&this.config.enabled}},{key:"state",get:function(){return this.controller.state[this.stateKey]}},{key:"handler",get:function(){return this.controller.handlers[this.stateKey]}},{key:"transform",get:function(){return this.config.transform||this.controller.config.transform||B1}}]),t}();function bf(t,e){return Math.abs(t)>=e?yo(t)*e:!1}function _f(t,e,n){var r=e[0],i=e[1],a=n[0],o=n[1],s=t[0],l=s[0],u=s[1],c=t[1],f=c[0],d=c[1];return[ff(r,l,u,a),ff(i,f,d,o)]}function lt(t,e,n){var r=t.state,i=e.timeStamp,a=e.type,o=r.values,s=n?0:i-r.startTime;return{_lastEventType:a,event:e,timeStamp:i,elapsedTime:s,previous:o}}function lr(t,e,n,r){var i=t.state,a=t.config,o=t.stateKey,s=t.args,l=t.transform,u=i.offset,c=n.timeStamp,f=a.initial,d=a.bounds,h=a.threshold,p=$o(l(h),l([0,0])).map(Math.abs),g=Ce({},Hh()[o],{_active:!0,args:s,values:e,initial:r??e,_threshold:p,offset:u,lastOffset:u,startTime:c});return Ce({},g,{_initial:bo(f,g),_bounds:bo(d,g)})}var W1=function(e){var n=this;this.classes=e,this.pointerIds=new Set,this.touchIds=new Set,this.supportsTouchEvents=qh(),this.supportsGestureEvents=O1(),this.bind=function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];for(var o={},s=Ho(n.classes),l;!(l=s()).done;){var u=l.value;new u(n,i).addBindings(o)}var c=function(h){Ze(o,h,function(p){return n.nativeRefs[h](Ce({},n.state.shared,{event:p,args:i}))})};for(var f in n.nativeRefs)c(f);return n.config.domTarget?K1(n,o):X1(n,o)},this.effect=function(){return n.config.domTarget&&n.bind(),n.clean},this.clean=function(){var r=Qh(n.config),i=n.config.eventOptions;r&&ca(r,Zh(n.domListeners),i),Object.values(n.timeouts).forEach(clearTimeout),$1(n)},this.classes=e,this.state=Hh(),this.timeouts={},this.domListeners=[],this.windowListeners={}};function Kh(t,e){"pointerId"in e?t.pointerIds.add(e.pointerId):t.touchIds=new Set(hu(e))}function Xh(t,e){"pointerId"in e?t.pointerIds.delete(e.pointerId):hu(e).forEach(function(n){return t.touchIds.delete(n)})}function $1(t){var e=t.config,n=e.window,r=e.eventOptions,i=t.windowListeners;if(n){for(var a in i){var o=i[a];ca(n,o,r)}t.windowListeners={}}}function H1(t,e,n){var r=t.config,i=t.windowListeners;n===void 0&&(n=r.eventOptions),r.window&&(ca(r.window,i[e],n),delete i[e])}function Y1(t,e,n,r){var i=t.config,a=t.windowListeners;n===void 0&&(n=[]),r===void 0&&(r=i.eventOptions),i.window&&(ca(i.window,a[e],r),Jh(i.window,a[e]=n,r))}function K1(t,e){var n=t.config,r=t.domListeners,i=Qh(n);if(!i)throw new Error("domTarget must be defined");var a=n.eventOptions;ca(i,Zh(r),a);for(var o=0,s=Object.entries(e);o<s.length;o++){var l=s[o],u=l[0],c=l[1],f=u.slice(2).toLowerCase();r.push([f,zh.apply(void 0,c)])}Jh(i,r,a)}function X1(t,e){for(var n=t.config,r={},i=n.eventOptions.capture?"Capture":"",a=0,o=Object.entries(e);a<o.length;a++){var s=o[a],l=s[0],u=s[1],c=Array.isArray(u)?u:[u],f=l+i;r[f]=zh.apply(void 0,c)}return r}function Zh(t){return t===void 0&&(t=[]),t.splice(0,t.length)}function Qh(t){var e=t.domTarget;return e&&"current"in e?e.current:e}function Ze(t,e,n){t[e]||(t[e]=[]),t[e].push(n)}function Jh(t,e,n){e===void 0&&(e=[]),n===void 0&&(n={});for(var r=Ho(e),i;!(i=r()).done;){var a=i.value,o=a[0],s=a[1];t.addEventListener(o,s,n)}}function ca(t,e,n){e===void 0&&(e=[]),n===void 0&&(n={});for(var r=Ho(e),i;!(i=r()).done;){var a=i.value,o=a[0],s=a[1];t.removeEventListener(o,s,n)}}function Z1(t,e,n){n===void 0&&(n={});var r=J1(t),i=yc.useMemo(function(){return new W1(r)},[]);return i.config=e,i.handlers=t,i.nativeRefs=n,yc.useEffect(i.effect,[]),i.config.domTarget?Q1:i.bind}function Q1(){}function J1(t){var e=new Set;return t.drag&&e.add($t.get("drag")),t.wheel&&e.add($t.get("wheel")),t.scroll&&e.add($t.get("scroll")),t.move&&e.add($t.get("move")),t.pinch&&e.add($t.get("pinch")),t.hover&&e.add($t.get("hover")),e}var Yo=function(t){pr(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.getInternalMovement=function(i,a){return $o(i,a.initial)},n.checkIntentionality=function(i,a){if(i[0]===!1&&i[1]===!1)return{_intentional:i,axis:this.state.axis};var o=a.map(Math.abs),s=o[0],l=o[1],u=this.state.axis||(s>l?"x":s<l?"y":void 0);return!this.config.axis&&!this.config.lockDirection?{_intentional:i,_blocked:!1,axis:u}:u?this.config.axis&&u!==this.config.axis?{_intentional:i,_blocked:!0,axis:u}:(i[u==="x"?1:0]=!1,{_intentional:i,_blocked:!1,axis:u}):{_intentional:[!1,!1],_blocked:!1,axis:u}},n.getKinematics=function(i,a){var o=this.getMovement(i);if(!o._blocked){var s=a.timeStamp-this.state.timeStamp;Object.assign(o,Nh(o.movement,o.delta,s))}return o},n.mapStateValues=function(i){return{xy:i.values,vxvy:i.velocities}},e}(Yh),e_=3;function wf(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}var t_=function(t){pr(e,t);function e(){var r;return r=t.apply(this,arguments)||this,r.ingKey="dragging",r.stateKey="drag",r.setPointerCapture=function(i){if(!(r.config.useTouch||document.pointerLockElement)){var a=i.target,o=i.pointerId;a&&"setPointerCapture"in a&&a.setPointerCapture(o),r.updateGestureState({_dragTarget:a,_dragPointerId:o})}},r.releasePointerCapture=function(){if(!(r.config.useTouch||document.pointerLockElement)){var i=r.state,a=i._dragTarget,o=i._dragPointerId;if(o&&a&&"releasePointerCapture"in a&&(!("hasPointerCapture"in a)||a.hasPointerCapture(o)))try{a.releasePointerCapture(o)}catch{}}},r.preventScroll=function(i){r.state._dragPreventScroll&&i.cancelable&&i.preventDefault()},r.getEventId=function(i){return r.config.useTouch?i.changedTouches[0].identifier:i.pointerId},r.isValidEvent=function(i){return r.state._pointerId===r.getEventId(i)},r.shouldPreventWindowScrollY=r.config.experimental_preventWindowScrollY&&r.controller.supportsTouchEvents,r.setUpWindowScrollDetection=function(i){wf(i),Y1(r.controller,r.stateKey,[["touchmove",r.preventScroll],["touchend",r.clean.bind(Ue(r))],["touchcancel",r.clean.bind(Ue(r))]],{passive:!1}),r.setTimeout(r.startDrag.bind(Ue(r)),250,i)},r.setUpDelayedDragTrigger=function(i){r.state._dragDelayed=!0,wf(i),r.setTimeout(r.startDrag.bind(Ue(r)),r.config.delay,i)},r.setStartState=function(i){var a=Or(i,r.transform);r.updateSharedState(Wt(i)),r.updateGestureState(Ce({},lr(Ue(r),a,i),lt(Ue(r),i,!0),{_pointerId:r.getEventId(i)})),r.updateGestureState(r.getMovement(a))},r.onDragStart=function(i){Kh(r.controller,i),!(!r.enabled||r.state._active)&&(r.setStartState(i),r.setPointerCapture(i),r.shouldPreventWindowScrollY?r.setUpWindowScrollDetection(i):r.config.delay>0?r.setUpDelayedDragTrigger(i):r.startDrag(i,!0))},r.onDragChange=function(i){if(!(r.state.canceled||!r.state._active||!r.isValidEvent(i)||r.state._lastEventType===i.type&&i.timeStamp===r.state.timeStamp)){var a;if(document.pointerLockElement){var o=i.movementX,s=i.movementY;a=vo(r.transform([o,s]),r.state.values)}else a=Or(i,r.transform);var l=r.getKinematics(a,i);if(!r.state._dragStarted){if(r.state._dragDelayed){r.startDrag(i);return}if(r.shouldPreventWindowScrollY)if(!r.state._dragPreventScroll&&l.axis)if(l.axis==="x")r.startDrag(i);else{r.state._active=!1;return}else return;else return}var u=Wt(i);r.updateSharedState(u);var c=lt(Ue(r),i),f=Qi(l._movement),d=r.state._dragIsTap;d&&f>=e_&&(d=!1),r.updateGestureState(Ce({},c,l,{_dragIsTap:d})),r.fireGestureHandler()}},r.onDragEnd=function(i){if(Xh(r.controller,i),!!r.isValidEvent(i)&&(r.clean(),!!r.state._active)){r.state._active=!1;var a=r.state._dragIsTap,o=r.state.velocities,s=o[0],l=o[1],u=r.state.movement,c=u[0],f=u[1],d=r.state._intentional,h=d[0],p=d[1],g=r.config.swipeVelocity,m=g[0],v=g[1],_=r.config.swipeDistance,w=_[0],y=_[1],b=r.config.swipeDuration,S=Ce({},lt(Ue(r),i),r.getMovement(r.state.values)),E=[0,0];S.elapsedTime<b&&(h!==!1&&Math.abs(s)>m&&Math.abs(c)>w&&(E[0]=yo(s)),p!==!1&&Math.abs(l)>v&&Math.abs(f)>y&&(E[1]=yo(l))),r.updateSharedState({buttons:0}),r.updateGestureState(Ce({},S,{tap:a,swipe:E})),r.fireGestureHandler(r.config.filterTaps&&a===!0)}},r.clean=function(){t.prototype.clean.call(Ue(r)),r.state._dragStarted=!1,r.releasePointerCapture(),H1(r.controller,r.stateKey)},r.onCancel=function(){r.state.canceled||(r.updateGestureState({canceled:!0,_active:!1}),r.updateSharedState({buttons:0}),setTimeout(function(){return r.fireGestureHandler()},0))},r.onClick=function(i){r.state._dragIsTap||i.stopPropagation()},r}var n=e.prototype;return n.startDrag=function(i,a){a===void 0&&(a=!1),!(!this.state._active||this.state._dragStarted)&&(a||this.setStartState(i),this.updateGestureState({_dragStarted:!0,_dragPreventScroll:!0,cancel:this.onCancel}),this.clearTimeout(),this.fireGestureHandler())},n.addBindings=function(i){if(this.config.useTouch?(Ze(i,"onTouchStart",this.onDragStart),Ze(i,"onTouchMove",this.onDragChange),Ze(i,"onTouchEnd",this.onDragEnd),Ze(i,"onTouchCancel",this.onDragEnd)):(Ze(i,"onPointerDown",this.onDragStart),Ze(i,"onPointerMove",this.onDragChange),Ze(i,"onPointerUp",this.onDragEnd),Ze(i,"onPointerCancel",this.onDragEnd)),this.config.filterTaps){var a=this.controller.config.eventOptions.capture?"onClick":"onClickCapture";Ze(i,a,this.onClick)}},e}(Yo),n_=function(t){pr(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.getInternalMovement=function(i,a){var o=a.values[1],s=i[0],l=i[1],u=l===void 0?o:l,c=u-o,f=a.turns;return Math.abs(c)>270&&(f+=yo(c)),$o([s,u-360*f],a.initial)},n.getKinematics=function(i,a){var o=this.getMovement(i),s=(i[1]-o._movement[1]-this.state.initial[1])/360,l=a.timeStamp-this.state.timeStamp,u=Nh(o.movement,o.delta,l),c=A1(u,["distance","velocity"]);return Ce({turns:s},o,c)},n.mapStateValues=function(i){return{da:i.values,vdva:i.velocities}},e}(Yh),r_=7,i_=260,a_=function(t){pr(e,t);function e(){var r;return r=t.apply(this,arguments)||this,r.ingKey="pinching",r.stateKey="pinch",r.onPinchStart=function(i){Kh(r.controller,i);var a=r.controller.touchIds;if(r.enabled&&!(r.state._active&&r.state._pointerIds.every(function(c){return a.has(c)}))&&!(a.size<2)){var o=Array.from(a).slice(0,2),s=mf(i,o,r.transform),l=s.values,u=s.origin;r.updateSharedState(Wt(i)),r.updateGestureState(Ce({},lr(Ue(r),l,i),lt(Ue(r),i,!0),{_pointerIds:o,cancel:r.onCancel,origin:u})),r.updateGestureState(r.getMovement(l)),r.fireGestureHandler()}},r.onPinchChange=function(i){var a=r.state,o=a.canceled,s=a._active;if(!(o||!s||i.timeStamp===r.state.timeStamp)){var l=Wt(i);r.updateSharedState(l);try{var u=mf(i,r.state._pointerIds,r.transform),c=u.values,f=u.origin,d=r.getKinematics(c,i);r.updateGestureState(Ce({},lt(Ue(r),i),d,{origin:f})),r.fireGestureHandler()}catch{r.onPinchEnd(i)}}},r.onPinchEnd=function(i){Xh(r.controller,i);var a=hu(i);r.state._pointerIds.every(function(o){return!a.includes(o)})||(r.clean(),r.state._active&&(r.updateGestureState(Ce({},lt(Ue(r),i),r.getMovement(r.state.values),{_active:!1})),r.fireGestureHandler()))},r.onCancel=function(){r.state.canceled||(r.updateGestureState({_active:!1,canceled:!0}),setTimeout(function(){return r.fireGestureHandler()},0))},r.onGestureStart=function(i){if(r.enabled){i.preventDefault();var a=yf(i,r.transform);r.updateSharedState(Wt(i)),r.updateGestureState(Ce({},lr(Ue(r),a,i),lt(Ue(r),i,!0),{origin:[i.clientX,i.clientY],cancel:r.onCancel})),r.updateGestureState(r.getMovement(a)),r.fireGestureHandler()}},r.onGestureChange=function(i){var a=r.state,o=a.canceled,s=a._active;if(!(o||!s)){i.preventDefault();var l=Wt(i);r.updateSharedState(l);var u=yf(i,r.transform);u[0]=(u[0]-r.state.event.scale)*i_+r.state.values[0];var c=r.getKinematics(u,i);r.updateGestureState(Ce({},lt(Ue(r),i),c,{origin:[i.clientX,i.clientY]})),r.fireGestureHandler()}},r.onGestureEnd=function(i){r.clean(),r.state._active&&(r.updateGestureState(Ce({},lt(Ue(r),i),r.getMovement(r.state.values),{_active:!1,origin:[i.clientX,i.clientY]})),r.fireGestureHandler())},r.wheelShouldRun=function(i){return r.enabled&&i.ctrlKey},r.getWheelValuesFromEvent=function(i){var a=Wh(i,r.transform),o=a[1],s=r.state.values,l=s[0],u=s[1],c=-o*r_,f=l+c,d=u!==void 0?u:0;return{values:[f,d],origin:[i.clientX,i.clientY],delta:[c,d]}},r.onWheel=function(i){r.wheelShouldRun(i)&&(r.setTimeout(r.onWheelEnd),r.state._active?r.onWheelChange(i):r.onWheelStart(i))},r.onWheelStart=function(i){var a=r.getWheelValuesFromEvent(i),o=a.values,s=a.delta,l=a.origin;i.cancelable&&i.preventDefault(),r.updateSharedState(Wt(i)),r.updateGestureState(Ce({},lr(Ue(r),o,i,r.state.values),lt(Ue(r),i,!0),{offset:o,delta:s,origin:l})),r.updateGestureState(r.getMovement(o)),r.fireGestureHandler()},r.onWheelChange=function(i){i.cancelable&&i.preventDefault(),r.updateSharedState(Wt(i));var a=r.getWheelValuesFromEvent(i),o=a.values,s=a.origin,l=a.delta;r.updateGestureState(Ce({},lt(Ue(r),i),r.getKinematics(o,i),{origin:s,delta:l})),r.fireGestureHandler()},r.onWheelEnd=function(){r.clean(),r.state._active&&(r.state._active=!1,r.updateGestureState(r.getMovement(r.state.values)),r.fireGestureHandler())},r}var n=e.prototype;return n.addBindings=function(i){this.controller.config.domTarget&&!this.controller.supportsTouchEvents&&this.controller.supportsGestureEvents?(Ze(i,"onGestureStart",this.onGestureStart),Ze(i,"onGestureChange",this.onGestureChange),Ze(i,"onGestureEnd",this.onGestureEnd)):(Ze(i,"onTouchStart",this.onPinchStart),Ze(i,"onTouchMove",this.onPinchChange),Ze(i,"onTouchEnd",this.onPinchEnd),Ze(i,"onTouchCancel",this.onPinchEnd),Ze(i,"onWheel",this.onWheel))},e}(n_),o_=function(t){pr(e,t);function e(){var r;return r=t.apply(this,arguments)||this,r.ingKey="wheeling",r.stateKey="wheel",r.debounced=!0,r.handleEvent=function(i){if(!(i.ctrlKey&&"pinch"in r.controller.handlers)&&r.enabled){r.setTimeout(r.onEnd),r.updateSharedState(Wt(i));var a=vo(Wh(i,r.transform),r.state.values);if(r.state._active)r.updateGestureState(Ce({},lt(Ue(r),i),r.getKinematics(a,i)));else{r.updateGestureState(Ce({},lr(Ue(r),a,i,r.state.values),lt(Ue(r),i,!0)));var o=r.getMovement(a),s=Gh(o.delta);r.updateGestureState(o),r.updateGestureState(s)}r.fireGestureHandler()}},r.onEnd=function(){if(r.clean(),!!r.state._active){var i=r.getMovement(r.state.values);r.updateGestureState(i),r.updateGestureState({_active:!1,velocities:[0,0],velocity:0}),r.fireGestureHandler()}},r}var n=e.prototype;return n.addBindings=function(i){Ze(i,"onWheel",this.handleEvent)},e}(Yo),Ef=function(t){pr(e,t);function e(){var r;return r=t.apply(this,arguments)||this,r.ingKey="moving",r.stateKey="move",r.debounced=!0,r.onMove=function(i){r.enabled&&(r.setTimeout(r.onMoveEnd),r.state._active?r.onMoveChange(i):r.onMoveStart(i))},r.onMoveStart=function(i){r.updateSharedState(Wt(i));var a=Or(i,r.transform);r.updateGestureState(Ce({},lr(Ue(r),a,i),lt(Ue(r),i,!0))),r.updateGestureState(r.getMovement(a)),r.fireGestureHandler()},r.onMoveChange=function(i){r.updateSharedState(Wt(i));var a=Or(i,r.transform);r.updateGestureState(Ce({},lt(Ue(r),i),r.getKinematics(a,i))),r.fireGestureHandler()},r.onMoveEnd=function(){if(r.clean(),!!r.state._active){var i=r.state.values;r.updateGestureState(r.getMovement(i)),r.updateGestureState({velocities:[0,0],velocity:0,_active:!1}),r.fireGestureHandler()}},r.hoverTransform=function(){return r.controller.config.hover.transform||r.controller.config.transform},r.onPointerEnter=function(i){if(r.controller.state.shared.hovering=!0,!!r.controller.config.enabled){if(r.controller.config.hover.enabled){var a=Or(i,r.hoverTransform()),o=Ce({},r.controller.state.shared,r.state,lt(Ue(r),i,!0),{args:r.args,values:a,active:!0,hovering:!0});r.controller.handlers.hover(Ce({},o,r.mapStateValues(o)))}"move"in r.controller.handlers&&r.onMoveStart(i)}},r.onPointerLeave=function(i){if(r.controller.state.shared.hovering=!1,"move"in r.controller.handlers&&r.onMoveEnd(),!!r.controller.config.hover.enabled){var a=Or(i,r.hoverTransform()),o=Ce({},r.controller.state.shared,r.state,lt(Ue(r),i),{args:r.args,values:a,active:!1});r.controller.handlers.hover(Ce({},o,r.mapStateValues(o)))}},r}var n=e.prototype;return n.addBindings=function(i){"move"in this.controller.handlers&&Ze(i,"onPointerMove",this.onMove),"hover"in this.controller.handlers&&(Ze(i,"onPointerEnter",this.onPointerEnter),Ze(i,"onPointerLeave",this.onPointerLeave))},e}(Yo),s_=function(t){pr(e,t);function e(){var r;return r=t.apply(this,arguments)||this,r.ingKey="scrolling",r.stateKey="scroll",r.debounced=!0,r.handleEvent=function(i){if(r.enabled){r.clearTimeout(),r.setTimeout(r.onEnd);var a=C1(i,r.transform);if(r.updateSharedState(Wt(i)),r.state._active)r.updateGestureState(Ce({},lt(Ue(r),i),r.getKinematics(a,i)));else{r.updateGestureState(Ce({},lr(Ue(r),a,i,r.state.values),lt(Ue(r),i,!0)));var o=r.getMovement(a),s=Gh(o.delta);r.updateGestureState(o),r.updateGestureState(s)}r.fireGestureHandler()}},r.onEnd=function(){r.clean(),r.state._active&&(r.updateGestureState(Ce({},r.getMovement(r.state.values),{_active:!1,velocities:[0,0],velocity:0})),r.fireGestureHandler())},r}var n=e.prototype;return n.addBindings=function(i){Ze(i,"onScroll",this.handleEvent)},e}(Yo),l_=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function u_(t){var e={},n={},r=new Set;for(var i in t)l_.test(i)?(r.add(RegExp.lastMatch),n[i]=t[i]):e[i]=t[i];return[n,e,r]}function c_(t,e){e===void 0&&(e={});var n=u_(t),r=n[0],i=n[1],a=n[2];$t.set("drag",t_),$t.set("hover",Ef),$t.set("move",Ef),$t.set("pinch",a_),$t.set("scroll",s_),$t.set("wheel",o_);var o=q1(e,a),s={};return a.has("onDrag")&&(s.drag=mi(r,"onDrag")),a.has("onWheel")&&(s.wheel=mi(r,"onWheel")),a.has("onScroll")&&(s.scroll=mi(r,"onScroll")),a.has("onMove")&&(s.move=mi(r,"onMove")),a.has("onPinch")&&(s.pinch=mi(r,"onPinch")),a.has("onHover")&&(s.hover=r.onHover),Z1(s,o,i)}function mi(t,e){var n=e+"Start",r=e+"End",i=function(o){var s=void 0;return o.first&&n in t&&t[n](o),e in t&&(s=t[e](o)),o.last&&r in t&&t[r](o),s};return i}const f_=({draggable:t,set:e,position:n,onDragStart:r,onDragEnd:i})=>{const a=xt(g=>g.camera),o=xt(g=>g.raycaster),s=xt(g=>g.size),l=xt(g=>g.gl),{mouse2D:u,mouse3D:c,offset:f,normal:d,plane:h}=I.useMemo(()=>({mouse2D:new De,mouse3D:new Ee,offset:new Ee,normal:new Ee,plane:new Hm}),[]),p=I.useMemo(()=>l.domElement.getBoundingClientRect(),[l.domElement]);return c_({onDragStart:({event:g})=>{const{eventObject:m,point:v}=g;m.getWorldPosition(f).sub(v),c.copy(v),r()},onDrag:({event:g})=>{const m=(g.clientX-((p==null?void 0:p.left)??0))/s.width*2-1,v=-((g.clientY-((p==null?void 0:p.top)??0))/s.height)*2+1;u.set(m,v),o.setFromCamera(u,a),a.getWorldDirection(d).negate(),h.setFromNormalAndCoplanarPoint(d,c),o.ray.intersectPlane(h,c);const _=new Ee(n.x,n.y,n.z).copy(c).add(f);return e(_)},onDragEnd:i},{drag:{enabled:t,threshold:10}})};var $r={};function wn(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(wn.prototype[Symbol.iterator]=function(){return this});wn.of=function(){var t=arguments,e=t.length,n=0;return new wn(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};wn.empty=function(){var t=new wn(function(){return{done:!0}});return t};wn.fromSequence=function(t){var e=0,n=t.length;return new wn(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};wn.is=function(t){return t instanceof wn?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var Ko=wn;const Zt=Vt(Ko);var Xo={};Xo.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Xo.SYMBOL_SUPPORT=typeof Symbol<"u";var ep=Xo,d_=ep.ARRAY_BUFFER_SUPPORT,h_=ep.SYMBOL_SUPPORT,mu=function(e,n){var r,i,a,o,s;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||d_&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(a=0,o=e.length;a<o;a++)n(e[a],a);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(h_&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(r=e,a=0;s=r.next(),s.done!==!0;)n(s.value,a),a++;return}for(i in e)e.hasOwnProperty(i)&&n(e[i],i)},tp=Ko,p_=mu;function it(){this.clear()}it.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};it.prototype.enqueue=function(t){return this.items.push(t),++this.size};it.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};it.prototype.peek=function(){if(this.size)return this.items[this.offset]};it.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,r=0,i=this.items.length;n<i;n++,r++)t.call(e,this.items[n],r,this)};it.prototype.toArray=function(){return this.items.slice(this.offset)};it.prototype.values=function(){var t=this.items,e=this.offset;return new tp(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};it.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new tp(function(){if(e>=t.length)return{done:!0};var r=t[e];return e++,{value:[n++,r],done:!1}})};typeof Symbol<"u"&&(it.prototype[Symbol.iterator]=it.prototype.values);it.prototype.toString=function(){return this.toArray().join(",")};it.prototype.toJSON=function(){return this.toArray()};it.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:it,enumerable:!1}),t};typeof Symbol<"u"&&(it.prototype[Symbol.for("nodejs.util.inspect.custom")]=it.prototype.inspect);it.from=function(t){var e=new it;return p_(t,function(n){e.enqueue(n)}),e};it.of=function(){return it.from(arguments)};var m_=it,g_=function(e,n){var r=n.length;if(r!==0){var i=e.length;e.length+=r;for(var a=0;a<r;a++)e[i+a]=n[a]}},gu=Kn,v_=m_,y_=g_;function b_(t,e,n){if(!gu(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var r=t.inboundNeighbors.bind(t),i=t.outboundNeighbors.bind(t),a={},o={};a[e]=null,o[n]=null;var s=[e],l=[n],u,c,f,d,h,p,g,m,v=!1;e:for(;s.length&&l.length;)if(s.length<=l.length){for(u=s,s=[],h=0,g=u.length;h<g;h++)for(c=u[h],f=i(c),p=0,m=f.length;p<m;p++)if(d=f[p],d in a||(s.push(d),a[d]=c),d in o){v=!0;break e}}else for(u=l,l=[],h=0,g=u.length;h<g;h++)for(c=u[h],f=r(c),p=0,m=f.length;p<m;p++)if(d=f[p],d in o||(l.push(d),o[d]=c),d in a){v=!0;break e}if(!v)return null;for(var _=[];d;)_.unshift(d),d=a[d];for(d=o[_[_.length-1]];d;)_.push(d),d=o[d];return _.length?_:null}function __(t,e){if(!gu(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');e=""+e;var n={},r={},i,a,o,s,l,u;for(n[e]=!0,r[e]=[e];Object.keys(n).length;){i=n,n={};for(o in i)for(a=t.outboundNeighbors(o),l=0,u=a.length;l<u;l++)s=a[l],r[s]||(r[s]=r[o].concat(s),n[s]=!0)}return r}function np(t,e,n){if(!gu(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var r=new Set,i={},a=0;i[n]=0;for(var o=[n],s,l,u;o.length!==0;){var c=[];for(s=0,l=o.length;s<l;s++)u=o[s],!r.has(u)&&(r.add(u),y_(c,e[t](u)),i[u]=a);a++,o=c}return i}var w_=np.bind(null,"outboundNeighbors"),E_=np.bind(null,"neighbors");function x_(t,e){e=""+e;var n=[],r={},i={},a=t.nodes(),o,s,l,u,c,f,d,h,p;for(f=0,h=a.length;f<h;f++)u=a[f],r[u]=[],i[u]=0;var g={};i[e]=1,g[e]=0;for(var m=v_.of(e);m.size;)for(u=m.dequeue(),n.push(u),o=g[u],s=i[u],l=t.outboundNeighbors(u),d=0,p=l.length;d<p;d++)c=l[d],c in g||(m.enqueue(c),g[c]=o+1),g[c]===o+1&&(i[c]+=s,r[c].push(u));return[n,r,i]}$r.bidirectional=b_;$r.singleSource=__;$r.singleSourceLength=w_;$r.undirectedSingleSourceLength=E_;$r.brandes=x_;var vu={},fa={},T_=function(t,e){return t<e?-1:t>e?1:0},S_=function(t,e){return t<e?1:t>e?-1:0};function A_(t){return function(e,n){return t(n,e)}}function k_(t){return t===2?function(e,n){return e[0]<n[0]?-1:e[0]>n[0]?1:e[1]<n[1]?-1:e[1]>n[1]?1:0}:function(e,n){for(var r=0;r<t;){if(e[r]<n[r])return-1;if(e[r]>n[r])return 1;r++}return 0}}fa.DEFAULT_COMPARATOR=T_;fa.DEFAULT_REVERSE_COMPARATOR=S_;fa.reverseComparator=A_;fa.createTupleComparator=k_;var da={},rp=mu,ip=su;function O_(t){return Array.isArray(t)||ip.isTypedArray(t)}function yu(t){if(typeof t.length=="number")return t.length;if(typeof t.size=="number")return t.size}function D_(t){var e=yu(t),n=typeof e=="number"?new Array(e):[],r=0;return rp(t,function(i){n[r++]=i}),n}function C_(t){var e=yu(t),n=typeof e=="number"?ip.getPointerArray(e):Array,r=typeof e=="number"?new Array(e):[],i=typeof e=="number"?new n(e):[],a=0;return rp(t,function(o){r[a]=o,i[a]=a++}),[r,i]}da.isArrayLike=O_;da.guessLength=yu;da.toArray=D_;da.toArrayWithIndices=C_;var _o=mu,ap=fa,_n=da,Zo=ap.DEFAULT_COMPARATOR,bu=ap.reverseComparator;function _u(t,e,n,r){for(var i=e[r],a,o;r>n;){if(a=r-1>>1,o=e[a],t(i,o)<0){e[r]=o,r=a;continue}break}e[r]=i}function ha(t,e,n){for(var r=e.length,i=n,a=e[n],o=2*n+1,s;o<r;)s=o+1,s<r&&t(e[o],e[s])>=0&&(o=s),e[n]=e[o],n=o,o=2*n+1;e[n]=a,_u(t,e,i,n)}function op(t,e,n){e.push(n),_u(t,e,0,e.length-1)}function wu(t,e){var n=e.pop();if(e.length!==0){var r=e[0];return e[0]=n,ha(t,e,0),r}return n}function Gr(t,e,n){if(e.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var r=e[0];return e[0]=n,ha(t,e,0),r}function sp(t,e,n){var r;return e.length!==0&&t(e[0],n)<0&&(r=e[0],e[0]=n,n=r,ha(t,e,0)),n}function fr(t,e){for(var n=e.length,r=n>>1,i=r;--i>=0;)ha(t,e,i)}function Eu(t,e){for(var n=e.length,r=0,i=new Array(n);r<n;)i[r++]=wu(t,e);return i}function P_(t,e,n){arguments.length===2&&(n=e,e=t,t=Zo);var r=bu(t),i,a,o,s=1/0,l;if(e===1){if(_n.isArrayLike(n)){for(i=0,a=n.length;i<a;i++)o=n[i],(s===1/0||t(o,s)<0)&&(s=o);return l=new n.constructor(1),l[0]=s,l}return _o(n,function(c){(s===1/0||t(c,s)<0)&&(s=c)}),[s]}if(_n.isArrayLike(n)){if(e>=n.length)return n.slice().sort(t);for(l=n.slice(0,e),fr(r,l),i=e,a=n.length;i<a;i++)r(n[i],l[0])>0&&Gr(r,l,n[i]);return l.sort(t)}var u=_n.guessLength(n);return u!==null&&u<e&&(e=u),l=new Array(e),i=0,_o(n,function(c){i<e?l[i]=c:(i===e&&fr(r,l),r(c,l[0])>0&&Gr(r,l,c)),i++}),l.length>i&&(l.length=i),l.sort(t)}function M_(t,e,n){arguments.length===2&&(n=e,e=t,t=Zo);var r=bu(t),i,a,o,s=-1/0,l;if(e===1){if(_n.isArrayLike(n)){for(i=0,a=n.length;i<a;i++)o=n[i],(s===-1/0||t(o,s)>0)&&(s=o);return l=new n.constructor(1),l[0]=s,l}return _o(n,function(c){(s===-1/0||t(c,s)>0)&&(s=c)}),[s]}if(_n.isArrayLike(n)){if(e>=n.length)return n.slice().sort(r);for(l=n.slice(0,e),fr(t,l),i=e,a=n.length;i<a;i++)t(n[i],l[0])>0&&Gr(t,l,n[i]);return l.sort(r)}var u=_n.guessLength(n);return u!==null&&u<e&&(e=u),l=new Array(e),i=0,_o(n,function(c){i<e?l[i]=c:(i===e&&fr(t,l),t(c,l[0])>0&&Gr(t,l,c)),i++}),l.length>i&&(l.length=i),l.sort(r)}function je(t){if(this.clear(),this.comparator=t||Zo,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}je.prototype.clear=function(){this.items=[],this.size=0};je.prototype.push=function(t){return op(this.comparator,this.items,t),++this.size};je.prototype.peek=function(){return this.items[0]};je.prototype.pop=function(){return this.size!==0&&this.size--,wu(this.comparator,this.items)};je.prototype.replace=function(t){return Gr(this.comparator,this.items,t)};je.prototype.pushpop=function(t){return sp(this.comparator,this.items,t)};je.prototype.consume=function(){return this.size=0,Eu(this.comparator,this.items)};je.prototype.toArray=function(){return Eu(this.comparator,this.items.slice())};je.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:je,enumerable:!1}),t};typeof Symbol<"u"&&(je.prototype[Symbol.for("nodejs.util.inspect.custom")]=je.prototype.inspect);function wo(t){if(this.clear(),this.comparator=t||Zo,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=bu(this.comparator)}wo.prototype=je.prototype;je.from=function(t,e){var n=new je(e),r;return _n.isArrayLike(t)?r=t.slice():r=_n.toArray(t),fr(n.comparator,r),n.items=r,n.size=r.length,n};wo.from=function(t,e){var n=new wo(e),r;return _n.isArrayLike(t)?r=t.slice():r=_n.toArray(t),fr(n.comparator,r),n.items=r,n.size=r.length,n};je.siftUp=ha;je.siftDown=_u;je.push=op;je.pop=wu;je.replace=Gr;je.pushpop=sp;je.heapify=fr;je.consume=Eu;je.nsmallest=P_;je.nlargest=M_;je.MinHeap=je;je.MaxHeap=wo;var R_=je,lp=Kn,xu=Br.createEdgeWeightGetter,Eo=R_,Tu="weight";function xl(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1]>e[1]?1:t[1]<e[1]?-1:t[2]>e[2]?1:t[2]<e[2]?-1:0}function I_(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1]>e[1]?1:t[1]<e[1]?-1:t[2]>e[2]?1:t[2]<e[2]?-1:t[3]>e[3]?1:t[3]<e[3]?-1:0}function L_(t,e,n,r){if(e=""+e,n=""+n,!lp(t))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(e&&!t.hasNode(e))throw new Error('graphology-shortest-path/dijkstra: the "'+e+'" source node does not exist in the given graph.');if(n&&!t.hasNode(n))throw new Error('graphology-shortest-path/dijkstra: the "'+n+'" target node does not exist in the given graph.');if(r=xu(r||Tu).fromMinimalEntry,e===n)return[0,[e]];var i=[{},{}],a=[{},{}],o=[new Eo(xl),new Eo(xl)],s=[{},{}];a[0][e]=[e],a[1][n]=[n],s[0][e]=0,s[1][n]=0;var l=[],u=1/0,c=0,f=1,d,h,p,g,m,v,_,w,y;for(o[0].push([0,c++,e]),o[1].push([0,c++,n]);o[0].size&&o[1].size;)if(f=1-f,d=o[f].pop(),g=d[0],m=d[2],!(m in i[f])){if(i[f][m]=g,m in i[1-f])return[u,l];for(h=f===1?t.inboundEdges(m):t.outboundEdges(m),w=0,y=h.length;w<y;w++){if(_=h[w],v=t.opposite(m,_),p=i[f][m]+r(_,t.getEdgeAttributes(_)),v in i[f]&&p<i[f][v])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(v in s[f])||p<s[f][v])&&(s[f][v]=p,o[f].push([p,c++,v]),a[f][v]=a[f][m].concat(v),v in s[0]&&v in s[1]&&(g=s[0][v]+s[1][v],(l.length===0||u>g)&&(u=g,l=a[0][v].concat(a[1][v].slice(0,-1).reverse()))))}}return[1/0,null]}function U_(t,e,n,r,i,a){if(!lp(t))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(i&&!t.hasNode(i))throw new Error('graphology-shortest-path/dijkstra: the "'+i+'" target node does not exist in the given graph.');n=xu(n||Tu).fromMinimalEntry;var o={},s={},l=new Eo(xl),u=0,c,f,d,h,p,g,m,v,_,w,y;for(v=0,w=e.length;v<w;v++)h=e[v],s[h]=0,l.push([0,u++,h]),a&&(a[h]=[h]);for(;l.size;)if(f=l.pop(),m=f[0],h=f[2],!(h in o)){if(o[h]=m,h===i)break;for(c=t.outboundEdges(h),_=0,y=c.length;_<y;_++)if(g=c[_],p=t.opposite(h,g),d=n(g,t.getEdgeAttributes(g))+o[h],!(r&&d>r)){if(p in o&&d<o[p])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(p in s)||d<s[p])&&(s[p]=d,l.push([d,u++,p]),a&&(a[p]=a[h].concat(p)))}}return o}function V_(t,e,n){var r={};return U_(t,[e],n,0,null,r),r}function F_(t,e,n,r){return L_(t,e,n,r)[1]}function G_(t,e,n){e=""+e,n=xu(n||Tu).fromMinimalEntry;var r=[],i={},a={},o=t.nodes(),s,l,u,c,f,d,h,p,g,m;for(g=0,m=o.length;g<m;g++)d=o[g],i[d]=[],a[d]=0;var v={};a[e]=1;var _={};_[e]=0;var w=0,y=new Eo(I_);for(y.push([0,w++,e,e]);y.size;)if(l=y.pop(),c=l[0],u=l[2],d=l[3],!(d in v))for(a[d]+=a[u],r.push(d),v[d]=c,s=t.outboundEdges(d),g=0,m=s.length;g<m;g++)p=s[g],h=t.opposite(d,p),f=c+n(p,t.getEdgeAttributes(p)),!(h in v)&&(!(h in _)||f<_[h])?(_[h]=f,y.push([f,w++,d,h]),a[h]=0,i[h]=[d]):f===_[h]&&(a[h]+=a[d],i[h].push(d));return[r,i,a]}vu.bidirectional=F_;vu.singleSource=V_;vu.brandes=G_;var pa=$r,gT=pa.bidirectional;pa.singleSource;pa.singleSourceLength;pa.undirectedSingleSourceLength;pa.brandes;var Su={exports:{}},Mr=typeof Reflect=="object"?Reflect:null,xf=Mr&&typeof Mr.apply=="function"?Mr.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},no;Mr&&typeof Mr.ownKeys=="function"?no=Mr.ownKeys:Object.getOwnPropertySymbols?no=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:no=function(e){return Object.getOwnPropertyNames(e)};function N_(t){console&&console.warn&&console.warn(t)}var up=Number.isNaN||function(e){return e!==e};function ze(){ze.init.call(this)}Su.exports=ze;Su.exports.once=B_;ze.EventEmitter=ze;ze.prototype._events=void 0;ze.prototype._eventsCount=0;ze.prototype._maxListeners=void 0;var Tf=10;function Qo(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ze,"defaultMaxListeners",{enumerable:!0,get:function(){return Tf},set:function(t){if(typeof t!="number"||t<0||up(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Tf=t}});ze.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ze.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||up(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function cp(t){return t._maxListeners===void 0?ze.defaultMaxListeners:t._maxListeners}ze.prototype.getMaxListeners=function(){return cp(this)};ze.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(l===void 0)return!1;if(typeof l=="function")xf(l,this,n);else for(var u=l.length,c=mp(l,u),r=0;r<u;++r)xf(c[r],this,n);return!0};function fp(t,e,n,r){var i,a,o;if(Qo(n),a=t._events,a===void 0?(a=t._events=Object.create(null),t._eventsCount=0):(a.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),o=a[e]),o===void 0)o=a[e]=n,++t._eventsCount;else if(typeof o=="function"?o=a[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=cp(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=o.length,N_(s)}return t}ze.prototype.addListener=function(e,n){return fp(this,e,n,!1)};ze.prototype.on=ze.prototype.addListener;ze.prototype.prependListener=function(e,n){return fp(this,e,n,!0)};function j_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function dp(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=j_.bind(r);return i.listener=n,r.wrapFn=i,i}ze.prototype.once=function(e,n){return Qo(n),this.on(e,dp(this,e,n)),this};ze.prototype.prependOnceListener=function(e,n){return Qo(n),this.prependListener(e,dp(this,e,n)),this};ze.prototype.removeListener=function(e,n){var r,i,a,o,s;if(Qo(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(a=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){s=r[o].listener,a=o;break}if(a<0)return this;a===0?r.shift():z_(r,a),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,s||n)}return this};ze.prototype.off=ze.prototype.removeListener;ze.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var a=Object.keys(r),o;for(i=0;i<a.length;++i)o=a[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function hp(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?q_(i):mp(i,i.length)}ze.prototype.listeners=function(e){return hp(this,e,!0)};ze.prototype.rawListeners=function(e){return hp(this,e,!1)};ze.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):pp.call(t,e)};ze.prototype.listenerCount=pp;function pp(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ze.prototype.eventNames=function(){return this._eventsCount>0?no(this._events):[]};function mp(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function z_(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function q_(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function B_(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,a),r(o)}function a(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}gp(t,e,a,{once:!0}),e!=="error"&&W_(t,i,{once:!0})})}function W_(t,e,n){typeof t.on=="function"&&gp(t,"error",e,n)}function gp(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(a){r.once&&t.removeEventListener(e,i),n(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var $_=Su.exports,H_=Ko,vp=Xo,Y_=vp.ARRAY_BUFFER_SUPPORT,K_=vp.SYMBOL_SUPPORT;function X_(t){return typeof t=="string"||Array.isArray(t)||Y_&&ArrayBuffer.isView(t)?H_.fromSequence(t):typeof t!="object"||t===null?null:K_&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var yp=function(e){var n=X_(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},Z_=yp,Q_=function(e,n){for(var r=arguments.length>1?n:1/0,i=r!==1/0?new Array(r):[],a,o=0,s=Z_(e);;){if(o===r)return i;if(a=s.next(),a.done)return o!==n&&(i.length=o),i;i[o++]=a.value}};const bp=Vt(Q_);var J_=Ko,ew=yp,tw=function(){var e=arguments,n=null,r=-1;return new J_(function(){var a=null;do{if(n===null){if(r++,r>=e.length)return{done:!0};n=ew(e[r])}if(a=n.next(),a.done===!0){n=null;continue}break}while(!0);return a})};const Pn=Vt(tw);function nw(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const r in arguments[e])t[r]=arguments[e][r];return t}let ut=nw;typeof Object.assign=="function"&&(ut=Object.assign);function Kt(t,e,n,r){const i=t._nodes.get(e);let a=null;return i&&(r==="mixed"?a=i.out&&i.out[n]||i.undirected&&i.undirected[n]:r==="directed"?a=i.out&&i.out[n]:a=i.undirected&&i.undirected[n]),a}function mt(t){return typeof t=="object"&&t!==null}function _p(t){let e;for(e in t)return!1;return!0}function jt(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function rn(t,e,n){const r={enumerable:!0,configurable:!0};typeof n=="function"?r.get=n:(r.value=n,r.writable=!1),Object.defineProperty(t,e,r)}function Sf(t){return!(!mt(t)||t.attributes&&!Array.isArray(t.attributes))}function rw(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class Au extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class ue extends Au{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ue.prototype.constructor)}}class se extends Au{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,se.prototype.constructor)}}class ve extends Au{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ve.prototype.constructor)}}function wp(t,e){this.key=t,this.attributes=e,this.clear()}wp.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Ep(t,e){this.key=t,this.attributes=e,this.clear()}Ep.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function xp(t,e){this.key=t,this.attributes=e,this.clear()}xp.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Hr(t,e,n,r,i){this.key=e,this.attributes=i,this.undirected=t,this.source=n,this.target=r}Hr.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,r=this.target.key;this.source[t][r]=this,!(this.undirected&&n===r)&&(this.target[e][n]=this)};Hr.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,r=this.target.key;this.undirected&&(t=e="undirected");const i=this.source[t],a=i[r];if(typeof a>"u"){i[r]=this,this.undirected&&n===r||(this.target[e][n]=this);return}a.previous=this,this.next=a,i[r]=this,this.target[e][n]=this};Hr.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),delete this.source[n][e],delete this.target[r][t]};Hr.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[r][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[r][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Tp=0,Sp=1,iw=2,Ap=3;function In(t,e,n,r,i,a,o){let s,l,u,c;if(r=""+r,n===Tp){if(s=t._nodes.get(r),!s)throw new se(`Graph.${e}: could not find the "${r}" node in the graph.`);u=i,c=a}else if(n===Ap){if(i=""+i,l=t._edges.get(i),!l)throw new se(`Graph.${e}: could not find the "${i}" edge in the graph.`);const f=l.source.key,d=l.target.key;if(r===f)s=l.target;else if(r===d)s=l.source;else throw new se(`Graph.${e}: the "${r}" node is not attached to the "${i}" edge (${f}, ${d}).`);u=a,c=o}else{if(l=t._edges.get(r),!l)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`);n===Sp?s=l.source:s=l.target,u=i,c=a}return[s,u,c]}function aw(t,e,n){t.prototype[e]=function(r,i,a){const[o,s]=In(this,e,n,r,i,a);return o.attributes[s]}}function ow(t,e,n){t.prototype[e]=function(r,i){const[a]=In(this,e,n,r,i);return a.attributes}}function sw(t,e,n){t.prototype[e]=function(r,i,a){const[o,s]=In(this,e,n,r,i,a);return o.attributes.hasOwnProperty(s)}}function lw(t,e,n){t.prototype[e]=function(r,i,a,o){const[s,l,u]=In(this,e,n,r,i,a,o);return s.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:l}),this}}function uw(t,e,n){t.prototype[e]=function(r,i,a,o){const[s,l,u]=In(this,e,n,r,i,a,o);if(typeof u!="function")throw new ue(`Graph.${e}: updater should be a function.`);const c=s.attributes,f=u(c[l]);return c[l]=f,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:l}),this}}function cw(t,e,n){t.prototype[e]=function(r,i,a){const[o,s]=In(this,e,n,r,i,a);return delete o.attributes[s],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:s}),this}}function fw(t,e,n){t.prototype[e]=function(r,i,a){const[o,s]=In(this,e,n,r,i,a);if(!mt(s))throw new ue(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=s,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function dw(t,e,n){t.prototype[e]=function(r,i,a){const[o,s]=In(this,e,n,r,i,a);if(!mt(s))throw new ue(`Graph.${e}: provided attributes are not a plain object.`);return ut(o.attributes,s),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:s}),this}}function hw(t,e,n){t.prototype[e]=function(r,i,a){const[o,s]=In(this,e,n,r,i,a);if(typeof s!="function")throw new ue(`Graph.${e}: provided updater is not a function.`);return o.attributes=s(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const pw=[{name:t=>`get${t}Attribute`,attacher:aw},{name:t=>`get${t}Attributes`,attacher:ow},{name:t=>`has${t}Attribute`,attacher:sw},{name:t=>`set${t}Attribute`,attacher:lw},{name:t=>`update${t}Attribute`,attacher:uw},{name:t=>`remove${t}Attribute`,attacher:cw},{name:t=>`replace${t}Attributes`,attacher:fw},{name:t=>`merge${t}Attributes`,attacher:dw},{name:t=>`update${t}Attributes`,attacher:hw}];function mw(t){pw.forEach(function({name:e,attacher:n}){n(t,e("Node"),Tp),n(t,e("Source"),Sp),n(t,e("Target"),iw),n(t,e("Opposite"),Ap)})}function gw(t,e,n){t.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+i;if(i=arguments[2],a=Kt(this,o,s,n),!a)throw new se(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return a.attributes[i]}}function vw(t,e,n){t.prototype[e]=function(r){let i;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,o=""+arguments[1];if(i=Kt(this,a,o,n),!i)throw new se(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function yw(t,e,n){t.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+i;if(i=arguments[2],a=Kt(this,o,s,n),!a)throw new se(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return a.attributes.hasOwnProperty(i)}}function bw(t,e,n){t.prototype[e]=function(r,i,a){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,l=""+i;if(i=arguments[2],a=arguments[3],o=Kt(this,s,l,n),!o)throw new se(`Graph.${e}: could not find an edge for the given path ("${s}" - "${l}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return o.attributes[i]=a,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:i}),this}}function _w(t,e,n){t.prototype[e]=function(r,i,a){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,l=""+i;if(i=arguments[2],a=arguments[3],o=Kt(this,s,l,n),!o)throw new se(`Graph.${e}: could not find an edge for the given path ("${s}" - "${l}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof a!="function")throw new ue(`Graph.${e}: updater should be a function.`);return o.attributes[i]=a(o.attributes[i]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:i}),this}}function ww(t,e,n){t.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+i;if(i=arguments[2],a=Kt(this,o,s,n),!a)throw new se(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return delete a.attributes[i],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:i}),this}}function Ew(t,e,n){t.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+i;if(i=arguments[2],a=Kt(this,o,s,n),!a)throw new se(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!mt(i))throw new ue(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=i,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function xw(t,e,n){t.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+i;if(i=arguments[2],a=Kt(this,o,s,n),!a)throw new se(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!mt(i))throw new ue(`Graph.${e}: provided attributes are not a plain object.`);return ut(a.attributes,i),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:i}),this}}function Tw(t,e,n){t.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new ve(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new ve(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,s=""+i;if(i=arguments[2],a=Kt(this,o,s,n),!a)throw new se(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(n!=="mixed")throw new ve(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new se(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new ue(`Graph.${e}: provided updater is not a function.`);return a.attributes=i(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const Sw=[{name:t=>`get${t}Attribute`,attacher:gw},{name:t=>`get${t}Attributes`,attacher:vw},{name:t=>`has${t}Attribute`,attacher:yw},{name:t=>`set${t}Attribute`,attacher:bw},{name:t=>`update${t}Attribute`,attacher:_w},{name:t=>`remove${t}Attribute`,attacher:ww},{name:t=>`replace${t}Attributes`,attacher:Ew},{name:t=>`merge${t}Attributes`,attacher:xw},{name:t=>`update${t}Attributes`,attacher:Tw}];function Aw(t){Sw.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const kw=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ow(t,e,n,r){let i=!1;for(const a in e){if(a===r)continue;const o=e[a];if(i=n(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),t&&i)return o.key}}function Dw(t,e,n,r){let i,a,o,s=!1;for(const l in e)if(l!==r){i=e[l];do{if(a=i.source,o=i.target,s=n(i.key,i.attributes,a.key,o.key,a.attributes,o.attributes,i.undirected),t&&s)return i.key;i=i.next}while(i!==void 0)}}function Bs(t,e){const n=Object.keys(t),r=n.length;let i,a=0;return new Zt(function(){do if(i)i=i.next;else{if(a>=r)return{done:!0};const s=n[a++];if(s===e){i=void 0;continue}i=t[s]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function Cw(t,e,n,r){const i=e[n];if(!i)return;const a=i.source,o=i.target;if(r(i.key,i.attributes,a.key,o.key,a.attributes,o.attributes,i.undirected)&&t)return i.key}function Pw(t,e,n,r){let i=e[n];if(!i)return;let a=!1;do{if(a=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),t&&a)return i.key;i=i.next}while(i!==void 0)}function Ws(t,e){let n=t[e];return n.next!==void 0?new Zt(function(){if(!n)return{done:!0};const r={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:r}}):Zt.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function Mw(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):bp(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,r=new Array(n),i=e==="undirected",a=t._edges.values();let o=0,s,l;for(;s=a.next(),s.done!==!0;)l=s.value,l.undirected===i&&(r[o++]=l.key);return r}function kp(t,e,n,r){if(e.size===0)return;const i=n!=="mixed"&&n!==e.type,a=n==="undirected";let o,s,l=!1;const u=e._edges.values();for(;o=u.next(),o.done!==!0;){if(s=o.value,i&&s.undirected!==a)continue;const{key:c,attributes:f,source:d,target:h}=s;if(l=r(c,f,d.key,h.key,d.attributes,h.attributes,s.undirected),t&&l)return c}}function Rw(t,e){if(t.size===0)return Zt.empty();const n=e!=="mixed"&&e!==t.type,r=e==="undirected",i=t._edges.values();return new Zt(function(){let o,s;for(;;){if(o=i.next(),o.done)return o;if(s=o.value,!(n&&s.undirected!==r))break}return{value:{edge:s.key,attributes:s.attributes,source:s.source.key,target:s.target.key,sourceAttributes:s.source.attributes,targetAttributes:s.target.attributes,undirected:s.undirected},done:!1}})}function ku(t,e,n,r,i,a){const o=e?Dw:Ow;let s;if(n!=="undirected"&&(r!=="out"&&(s=o(t,i.in,a),t&&s)||r!=="in"&&(s=o(t,i.out,a,r?void 0:i.key),t&&s))||n!=="directed"&&(s=o(t,i.undirected,a),t&&s))return s}function Iw(t,e,n,r){const i=[];return ku(!1,t,e,n,r,function(a){i.push(a)}),i}function Lw(t,e,n){let r=Zt.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(r=Pn(r,Bs(n.in))),e!=="in"&&typeof n.out<"u"&&(r=Pn(r,Bs(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(r=Pn(r,Bs(n.undirected))),r}function Ou(t,e,n,r,i,a,o){const s=n?Pw:Cw;let l;if(e!=="undirected"&&(typeof i.in<"u"&&r!=="out"&&(l=s(t,i.in,a,o),t&&l)||typeof i.out<"u"&&r!=="in"&&(r||i.key!==a)&&(l=s(t,i.out,a,o),t&&l))||e!=="directed"&&typeof i.undirected<"u"&&(l=s(t,i.undirected,a,o),t&&l))return l}function Uw(t,e,n,r,i){const a=[];return Ou(!1,t,e,n,r,i,function(o){a.push(o)}),a}function Vw(t,e,n,r){let i=Zt.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&r in n.in&&(i=Pn(i,Ws(n.in,r))),typeof n.out<"u"&&e!=="in"&&r in n.out&&(e||n.key!==r)&&(i=Pn(i,Ws(n.out,r)))),t!=="directed"&&typeof n.undirected<"u"&&r in n.undirected&&(i=Pn(i,Ws(n.undirected,r))),i}function Fw(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(a,o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return Mw(this,r);if(arguments.length===1){a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new se(`Graph.${n}: could not find the "${a}" node in the graph.`);return Iw(this.multi,r==="mixed"?this.type:r,i,s)}if(arguments.length===2){a=""+a,o=""+o;const s=this._nodes.get(a);if(!s)throw new se(`Graph.${n}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(o))throw new se(`Graph.${n}:  could not find the "${o}" target node in the graph.`);return Uw(r,this.multi,i,s,o)}throw new ue(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Gw(t,e){const{name:n,type:r,direction:i}=e,a="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(u,c,f){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return f=u,kp(!1,this,r,f);if(arguments.length===2){u=""+u,f=c;const d=this._nodes.get(u);if(typeof d>"u")throw new se(`Graph.${a}: could not find the "${u}" node in the graph.`);return ku(!1,this.multi,r==="mixed"?this.type:r,i,d,f)}if(arguments.length===3){u=""+u,c=""+c;const d=this._nodes.get(u);if(!d)throw new se(`Graph.${a}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new se(`Graph.${a}:  could not find the "${c}" target node in the graph.`);return Ou(!1,r,this.multi,i,d,c,f)}throw new ue(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let f;if(u.length===0){let d=0;r!=="directed"&&(d+=this.undirectedSize),r!=="undirected"&&(d+=this.directedSize),f=new Array(d);let h=0;u.push((p,g,m,v,_,w,y)=>{f[h++]=c(p,g,m,v,_,w,y)})}else f=[],u.push((d,h,p,g,m,v,_)=>{f.push(c(d,h,p,g,m,v,_))});return this[a].apply(this,u),f};const s="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),f=[];return u.push((d,h,p,g,m,v,_)=>{c(d,h,p,g,m,v,_)&&f.push(d)}),this[a].apply(this,u),f};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new ue(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new ue(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,f;u.length===2?(c=u[0],f=u[1],u=[]):u.length===3?(c=u[1],f=u[2],u=[u[0]]):u.length===4&&(c=u[2],f=u[3],u=[u[0],u[1]]);let d=f;return u.push((h,p,g,m,v,_,w)=>{d=c(d,h,p,g,m,v,_,w)}),this[a].apply(this,u),d}}function Nw(t,e){const{name:n,type:r,direction:i}=e,a="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(l,u,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return c=l,kp(!0,this,r,c);if(arguments.length===2){l=""+l,c=u;const f=this._nodes.get(l);if(typeof f>"u")throw new se(`Graph.${a}: could not find the "${l}" node in the graph.`);return ku(!0,this.multi,r==="mixed"?this.type:r,i,f,c)}if(arguments.length===3){l=""+l,u=""+u;const f=this._nodes.get(l);if(!f)throw new se(`Graph.${a}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new se(`Graph.${a}:  could not find the "${u}" target node in the graph.`);return Ou(!0,r,this.multi,i,f,u,c)}throw new ue(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((f,d,h,p,g,m,v)=>u(f,d,h,p,g,m,v)),!!this[a].apply(this,l)};const s="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((f,d,h,p,g,m,v)=>!u(f,d,h,p,g,m,v)),!this[a].apply(this,l)}}function jw(t,e){const{name:n,type:r,direction:i}=e,a=n.slice(0,-1)+"Entries";t.prototype[a]=function(o,s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Zt.empty();if(!arguments.length)return Rw(this,r);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new se(`Graph.${a}: could not find the "${o}" node in the graph.`);return Lw(r,i,l)}if(arguments.length===2){o=""+o,s=""+s;const l=this._nodes.get(o);if(!l)throw new se(`Graph.${a}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(s))throw new se(`Graph.${a}:  could not find the "${s}" target node in the graph.`);return Vw(r,i,l,s)}throw new ue(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function zw(t){kw.forEach(e=>{Fw(t,e),Gw(t,e),Nw(t,e),jw(t,e)})}const qw=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Jo(){this.A=null,this.B=null}Jo.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};Jo.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function gi(t,e,n,r,i){for(const a in r){const o=r[a],s=o.source,l=o.target,u=s===n?l:s;if(e&&e.has(u.key))continue;const c=i(u.key,u.attributes);if(t&&c)return u.key}}function Du(t,e,n,r,i){if(e!=="mixed"){if(e==="undirected")return gi(t,null,r,r.undirected,i);if(typeof n=="string")return gi(t,null,r,r[n],i)}const a=new Jo;let o;if(e!=="undirected"){if(n!=="out"){if(o=gi(t,null,r,r.in,i),t&&o)return o;a.wrap(r.in)}if(n!=="in"){if(o=gi(t,a,r,r.out,i),t&&o)return o;a.wrap(r.out)}}if(e!=="directed"&&(o=gi(t,a,r,r.undirected,i),t&&o))return o}function Bw(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const r=[];return Du(!1,t,e,n,function(i){r.push(i)}),r}function vi(t,e,n){const r=Object.keys(n),i=r.length;let a=0;return new Zt(function(){let s=null;do{if(a>=i)return t&&t.wrap(n),{done:!0};const l=n[r[a++]],u=l.source,c=l.target;if(s=u===e?c:u,t&&t.has(s.key)){s=null;continue}}while(s===null);return{done:!1,value:{neighbor:s.key,attributes:s.attributes}}})}function Ww(t,e,n){if(t!=="mixed"){if(t==="undirected")return vi(null,n,n.undirected);if(typeof e=="string")return vi(null,n,n[e])}let r=Zt.empty();const i=new Jo;return t!=="undirected"&&(e!=="out"&&(r=Pn(r,vi(i,n,n.in))),e!=="in"&&(r=Pn(r,vi(i,n,n.out)))),t!=="directed"&&(r=Pn(r,vi(i,n,n.undirected))),r}function $w(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new se(`Graph.${n}: could not find the "${a}" node in the graph.`);return Bw(r==="mixed"?this.type:r,i,o)}}function Hw(t,e){const{name:n,type:r,direction:i}=e,a="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(u,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const f=this._nodes.get(u);if(typeof f>"u")throw new se(`Graph.${a}: could not find the "${u}" node in the graph.`);Du(!1,r==="mixed"?this.type:r,i,f,c)};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(u,c){const f=[];return this[a](u,(d,h)=>{f.push(c(d,h))}),f};const s="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[s]=function(u,c){const f=[];return this[a](u,(d,h)=>{c(d,h)&&f.push(d)}),f};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(u,c,f){if(arguments.length<3)throw new ue(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d=f;return this[a](u,(h,p)=>{d=c(d,h,p)}),d}}function Yw(t,e){const{name:n,type:r,direction:i}=e,a=n[0].toUpperCase()+n.slice(1,-1),o="find"+a;t.prototype[o]=function(u,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const f=this._nodes.get(u);if(typeof f>"u")throw new se(`Graph.${o}: could not find the "${u}" node in the graph.`);return Du(!0,r==="mixed"?this.type:r,i,f,c)};const s="some"+a;t.prototype[s]=function(u,c){return!!this[o](u,c)};const l="every"+a;t.prototype[l]=function(u,c){return!this[o](u,(d,h)=>!c(d,h))}}function Kw(t,e){const{name:n,type:r,direction:i}=e,a=n.slice(0,-1)+"Entries";t.prototype[a]=function(o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Zt.empty();o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new se(`Graph.${a}: could not find the "${o}" node in the graph.`);return Ww(r==="mixed"?this.type:r,i,s)}}function Xw(t){qw.forEach(e=>{$w(t,e),Hw(t,e),Yw(t,e),Kw(t,e)})}function Ga(t,e,n,r,i){const a=r._nodes.values(),o=r.type;let s,l,u,c,f,d,h;for(;s=a.next(),s.done!==!0;){let p=!1;if(l=s.value,o!=="undirected"){c=l.out;for(u in c){f=c[u];do{if(d=f.target,p=!0,h=i(l.key,d.key,l.attributes,d.attributes,f.key,f.attributes,f.undirected),t&&h)return f;f=f.next}while(f)}}if(o!=="directed"){c=l.undirected;for(u in c)if(!(e&&l.key>u)){f=c[u];do{if(d=f.target,d.key!==u&&(d=f.source),p=!0,h=i(l.key,d.key,l.attributes,d.attributes,f.key,f.attributes,f.undirected),t&&h)return f;f=f.next}while(f)}}if(n&&!p&&(h=i(l.key,null,l.attributes,null,null,null,null),t&&h))return null}}function Zw(t,e){const n={key:t};return _p(e.attributes)||(n.attributes=ut({},e.attributes)),n}function Qw(t,e,n){const r={key:e,source:n.source.key,target:n.target.key};return _p(n.attributes)||(r.attributes=ut({},n.attributes)),t==="mixed"&&n.undirected&&(r.undirected=!0),r}function Jw(t){if(!mt(t))throw new ue('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new ue("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!mt(t.attributes)||t.attributes===null))throw new ue("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function eE(t){if(!mt(t))throw new ue('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new ue("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new ue("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!mt(t.attributes)||t.attributes===null))throw new ue("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new ue("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const tE=rw(),nE=new Set(["directed","undirected","mixed"]),Af=new Set(["domain","_events","_eventsCount","_maxListeners"]),rE=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],iE={allowSelfLoops:!0,multi:!1,type:"mixed"};function aE(t,e,n){if(n&&!mt(n))throw new ue(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new ve(`Graph.addNode: the "${e}" node already exist in the graph.`);const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function kf(t,e,n){const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function Op(t,e,n,r,i,a,o,s){if(!r&&t.type==="undirected")throw new ve(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new ve(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!mt(s))throw new ue(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`);if(a=""+a,o=""+o,s=s||{},!t.allowSelfLoops&&a===o)throw new ve(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(a),u=t._nodes.get(o);if(!l)throw new se(`Graph.${e}: source node "${a}" not found.`);if(!u)throw new se(`Graph.${e}: target node "${o}" not found.`);const c={key:null,undirected:r,source:a,target:o,attributes:s};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new ve(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!t.multi&&(r?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new ve(`Graph.${e}: an edge linking "${a}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const f=new Hr(r,i,l,u,s);t._edges.set(i,f);const d=a===o;return r?(l.undirectedDegree++,u.undirectedDegree++,d&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,d&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?f.attachMulti():f.attach(),r?t._undirectedSize++:t._directedSize++,c.key=i,t.emit("edgeAdded",c),i}function oE(t,e,n,r,i,a,o,s,l){if(!r&&t.type==="undirected")throw new ve(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new ve(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(l){if(typeof s!="function")throw new ue(`Graph.${e}: invalid updater function. Expecting a function but got "${s}"`)}else if(!mt(s))throw new ue(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`)}a=""+a,o=""+o;let u;if(l&&(u=s,s=void 0),!t.allowSelfLoops&&a===o)throw new ve(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=t._nodes.get(a),f=t._nodes.get(o),d,h;if(!n&&(d=t._edges.get(i),d)){if((d.source.key!==a||d.target.key!==o)&&(!r||d.source.key!==o||d.target.key!==a))throw new ve(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${a}" source & "${o}" target vs. ("${d.source.key}", "${d.target.key}").`);h=d}if(!h&&!t.multi&&c&&(h=r?c.undirected[o]:c.out[o]),h){const _=[h.key,!1,!1,!1];if(l?!u:!s)return _;if(l){const w=h.attributes;h.attributes=u(w),t.emit("edgeAttributesUpdated",{type:"replace",key:h.key,attributes:h.attributes})}else ut(h.attributes,s),t.emit("edgeAttributesUpdated",{type:"merge",key:h.key,attributes:h.attributes,data:s});return _}s=s||{},l&&u&&(s=u(s));const p={key:null,undirected:r,source:a,target:o,attributes:s};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new ve(`Graph.${e}: the "${i}" edge already exists in the graph.`);let g=!1,m=!1;c||(c=kf(t,a,{}),g=!0,a===o&&(f=c,m=!0)),f||(f=kf(t,o,{}),m=!0),d=new Hr(r,i,c,f,s),t._edges.set(i,d);const v=a===o;return r?(c.undirectedDegree++,f.undirectedDegree++,v&&(c.undirectedLoops++,t._undirectedSelfLoopCount++)):(c.outDegree++,f.inDegree++,v&&(c.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),r?t._undirectedSize++:t._directedSize++,p.key=i,t.emit("edgeAdded",p),[i,!0,g,m]}function br(t,e){t._edges.delete(e.key);const{source:n,target:r,attributes:i}=e,a=e.undirected,o=n===r;a?(n.undirectedDegree--,r.undirectedDegree--,o&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,r.inDegree--,o&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),a?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:i,source:n.key,target:r.key,undirected:a})}class qe extends $_.EventEmitter{constructor(e){if(super(),e=ut({},iE,e),typeof e.multi!="boolean")throw new ue(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!nE.has(e.type))throw new ue(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new ue(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?wp:e.type==="directed"?Ep:xp;jt(this,"NodeDataClass",n);const r="geid_"+tE()+"_";let i=0;const a=()=>{let o;do o=r+i++;while(this._edges.has(o));return o};jt(this,"_attributes",{}),jt(this,"_nodes",new Map),jt(this,"_edges",new Map),jt(this,"_directedSize",0),jt(this,"_undirectedSize",0),jt(this,"_directedSelfLoopCount",0),jt(this,"_undirectedSelfLoopCount",0),jt(this,"_edgeKeyGenerator",a),jt(this,"_options",e),Af.forEach(o=>jt(this,o,this[o])),rn(this,"order",()=>this._nodes.size),rn(this,"size",()=>this._edges.size),rn(this,"directedSize",()=>this._directedSize),rn(this,"undirectedSize",()=>this._undirectedSize),rn(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),rn(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),rn(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),rn(this,"multi",this._options.multi),rn(this,"type",this._options.type),rn(this,"allowSelfLoops",this._options.allowSelfLoops),rn(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.out.hasOwnProperty(n):!1}throw new ue(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.undirected.hasOwnProperty(n):!1}throw new ue(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const r=""+e;return this._edges.has(r)}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?typeof r.out<"u"&&r.out.hasOwnProperty(n)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(n):!1}throw new ue(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new ve("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(e);if(!r)throw new se(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new se(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||void 0;if(i)return i.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new ve("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(e);if(!r)throw new se(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new se(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const i=r.undirected&&r.undirected[n]||void 0;if(i)return i.key}edge(e,n){if(this.multi)throw new ve("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new se(`Graph.edge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||r.undirected&&r.undirected[n]||void 0;if(i)return i.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.in||n in r.out}areOutNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.out}areInNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in r.undirected}areNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in r.in||n in r.out)||this.type!=="directed"&&n in r.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.in||this.type!=="directed"&&n in r.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new se(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.out||this.type!=="directed"&&n in r.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree),r}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.outDegree),r}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.degree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree),r}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree,i+=n.directedLoops),r-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.outDegree,i+=n.directedLoops),r-i}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree,i+=n.directedLoops*2),r-i}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new se(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new se(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new se(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const r=this._edges.get(n);if(!r)throw new se(`Graph.opposite: could not find the "${n}" edge in the graph.`);const i=r.source.key,a=r.target.key;if(e===i)return a;if(e===a)return i;throw new se(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${i}, ${a}).`)}hasExtremity(e,n){e=""+e,n=""+n;const r=this._edges.get(e);if(!r)throw new se(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return r.source.key===n||r.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new se(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new se(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new se(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return aE(this,e,n).key}mergeNode(e,n){if(n&&!mt(n))throw new ue(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let r=this._nodes.get(e);return r?(n&&(ut(r.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:r.attributes,data:n})),[e,!1]):(r=new this.NodeDataClass(e,n),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new ue(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let r=this._nodes.get(e);if(r){if(n){const a=r.attributes;r.attributes=n(a),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:r.attributes})}return[e,!1]}const i=n?n({}):{};return r=new this.NodeDataClass(e,i),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new se(`Graph.dropNode: could not find the "${e}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in n.out){r=n.out[i];do br(this,r),r=r.next;while(r)}for(const i in n.in){r=n.in[i];do br(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in n.undirected){r=n.undirected[i];do br(this,r),r=r.next;while(r)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(n=Kt(this,r,i,this.type),!n)throw new se(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new se(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return br(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new ve("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new ve("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const r=Kt(this,e,n,"directed");if(!r)throw new se(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return br(this,r),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new ve("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new ve("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=Kt(this,e,n,"undirected");if(!r)throw new se(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return br(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new ue("Graph.updateAttribute: updater should be a function.");const r=this._attributes[e];return this._attributes[e]=n(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!mt(e))throw new ue("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!mt(e))throw new ue("Graph.mergeAttributes: provided attributes are not a plain object.");return ut(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new ue("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new ue("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!Sf(n))throw new ue("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let i,a;for(;i=r.next(),i.done!==!0;)a=i.value,a.attributes=e(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new ue("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!Sf(n))throw new ue("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,a,o,s;for(;i=r.next(),i.done!==!0;)a=i.value,o=a.source,s=a.target,a.attributes=e(a.key,a.attributes,o.key,s.key,o.attributes,s.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new ue("Graph.forEachAdjacencyEntry: expecting a callback.");Ga(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new ue("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Ga(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new ue("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Ga(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new ue("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Ga(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):bp(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new ue("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new ue("Graph.findNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new ue("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let r,i;const a=new Array(this.order);let o=0;for(;r=n.next(),r.done!==!0;)i=r.value,a[o++]=e(i.key,i.attributes);return a}someNode(e){if(typeof e!="function")throw new ue("Graph.someNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new ue("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new ue("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let r,i;const a=[];for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)&&a.push(i.key);return a}reduceNodes(e,n){if(typeof e!="function")throw new ue("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new ue("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=n;const i=this._nodes.values();let a,o;for(;a=i.next(),a.done!==!0;)o=a.value,r=e(r,o.key,o.attributes);return r}nodeEntries(){const e=this._nodes.values();return new Zt(()=>{const n=e.next();if(n.done)return n;const r=n.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((i,a)=>{e[n++]=Zw(a,i)});const r=new Array(this._edges.size);return n=0,this._edges.forEach((i,a)=>{r[n++]=Qw(this.type,a,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:r}}import(e,n=!1){if(e instanceof qe)return e.forEachNode((l,u)=>{n?this.mergeNode(l,u):this.addNode(l,u)}),e.forEachEdge((l,u,c,f,d,h,p)=>{n?p?this.mergeUndirectedEdgeWithKey(l,c,f,u):this.mergeDirectedEdgeWithKey(l,c,f,u):p?this.addUndirectedEdgeWithKey(l,c,f,u):this.addDirectedEdgeWithKey(l,c,f,u)}),this;if(!mt(e))throw new ue("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!mt(e.attributes))throw new ue("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let r,i,a,o,s;if(e.nodes){if(a=e.nodes,!Array.isArray(a))throw new ue("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=a.length;r<i;r++){o=a[r],Jw(o);const{key:l,attributes:u}=o;n?this.mergeNode(l,u):this.addNode(l,u)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),a=e.edges,!Array.isArray(a))throw new ue("Graph.import: invalid edges. Expecting an array.");for(r=0,i=a.length;r<i;r++){s=a[r],eE(s);const{source:u,target:c,attributes:f,undirected:d=l}=s;let h;"key"in s?(h=n?d?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:d?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,h.call(this,s.key,u,c,f)):(h=n?d?this.mergeUndirectedEdge:this.mergeDirectedEdge:d?this.addUndirectedEdge:this.addDirectedEdge,h.call(this,u,c,f))}}return this}nullCopy(e){const n=new qe(ut({},this._options,e));return n.replaceAttributes(ut({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((r,i)=>{const a=ut({},r.attributes);r=new n.NodeDataClass(i,a),n._nodes.set(i,r)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new ve(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new ve("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new ve("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),r=this._edges.values();let i,a;for(;i=r.next(),i.done!==!0;)a=i.value,Op(n,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,ut({},a.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((a,o)=>{e[o]=a.attributes});const n={},r={};this._edges.forEach((a,o)=>{const s=a.undirected?"--":"->";let l="",u=a.source.key,c=a.target.key,f;a.undirected&&u>c&&(f=u,u=c,c=f);const d=`(${u})${s}(${c})`;o.startsWith("geid_")?this.multi&&(typeof r[d]>"u"?r[d]=0:r[d]++,l+=`${r[d]}. `):l+=`[${o}]: `,l+=d,n[l]=a.attributes});const i={};for(const a in this)this.hasOwnProperty(a)&&!Af.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(i[a]=this[a]);return i.attributes=this._attributes,i.nodes=e,i.edges=n,jt(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(qe.prototype[Symbol.for("nodejs.util.inspect.custom")]=qe.prototype.inspect);rE.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),r=e==="add"?Op:oE;t.generateKey?qe.prototype[n]=function(i,a,o){return r(this,n,!0,(t.type||this.type)==="undirected",null,i,a,o,e==="update")}:qe.prototype[n]=function(i,a,o,s){return r(this,n,!1,(t.type||this.type)==="undirected",i,a,o,s,e==="update")}})});mw(qe);Aw(qe);zw(qe);Xw(qe);class Dp extends qe{constructor(e){const n=ut({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new ue("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new ue('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class Cp extends qe{constructor(e){const n=ut({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new ue("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new ue('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class Pp extends qe{constructor(e){const n=ut({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ue("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class Mp extends qe{constructor(e){const n=ut({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ue("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new ue('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class Rp extends qe{constructor(e){const n=ut({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new ue("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new ue('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Yr(t){t.from=function(e,n){const r=ut({},e.options,n),i=new t(r);return i.import(e),i}}Yr(qe);Yr(Dp);Yr(Cp);Yr(Pp);Yr(Mp);Yr(Rp);qe.Graph=qe;qe.DirectedGraph=Dp;qe.UndirectedGraph=Cp;qe.MultiGraph=Pp;qe.MultiDirectedGraph=Mp;qe.MultiUndirectedGraph=Rp;qe.InvalidArgumentsGraphError=ue;qe.NotFoundGraphError=se;qe.UsageGraphError=ve;const{Provider:sE,useStore:he}=b1(),lE=({actives:t=[],selections:e=[],collapsedNodeIds:n=[],theme:r})=>y1(i=>({theme:r,edges:[],nodes:[],collapsedNodeIds:n,clusters:new Map,panning:!1,draggingId:null,actives:t,edgeContextMenus:new Set,edgeMeshes:[],selections:e,drags:{},graph:new qe,setTheme:a=>i(o=>({...o,theme:a})),setClusters:a=>i(o=>({...o,clusters:a})),setEdgeContextMenus:a=>i(o=>({...o,edgeContextMenus:a})),setEdgeMeshes:a=>i(o=>({...o,edgeMeshes:a})),setPanning:a=>i(o=>({...o,panning:a})),setDrags:a=>i(o=>({...o,drags:a})),setDraggingId:a=>i(o=>({...o,draggingId:a})),setActives:a=>i(o=>({...o,actives:a})),setSelections:a=>i(o=>({...o,selections:a})),setNodes:a=>i(o=>({...o,nodes:a})),setEdges:a=>i(o=>({...o,edges:a})),setNodePosition:(a,o)=>i(s=>{var h,p;const l=s.nodes.find(g=>g.id===a),u=Zi(l),f=new Ee(o.x,o.y,o.z).sub(u),d=[...s.nodes];if((h=s.selections)!=null&&h.includes(a))(p=s.selections)==null||p.forEach(g=>{const m=s.nodes.find(v=>v.id===g);if(m){const v=s.nodes.indexOf(m);d[v]=uf(m,f)}});else{const g=s.nodes.indexOf(l);d[g]=uf(l,f)}return{...s,drags:{...s.drags,[a]:l},nodes:d}}),setCollapsedNodeIds:(a=[])=>i(o=>({...o,collapsedNodeIds:a}))}));function Ip({nodeId:t,nodes:e,edges:n,currentHiddenNodes:r,currentHiddenEdges:i}){const a=[],o=[],s=r.map(h=>h.id),l=i.map(h=>h.id),u=n.filter(h=>h.source===t),c=u.map(h=>h.target);o.push(...u);for(const h of c){const p=n.filter(m=>m.target===h&&m.source!==t);let g=!1;if((p.length===0||p.length>0&&!s.includes(h)&&p.map(v=>v.id).every(v=>l.includes(v)))&&(g=!0),g){const m=e.find(_=>_.id===h);m&&a.push(m);const v=Ip({nodeId:h,nodes:e,edges:n,currentHiddenEdges:o,currentHiddenNodes:a});o.push(...v.hiddenEdges),a.push(...v.hiddenNodes)}}const f=Object.values(o.reduce((h,p)=>({...h,[p.id]:p}),{})),d=Object.values(a.reduce((h,p)=>({...h,[p.id]:p}),{}));return{hiddenEdges:f,hiddenNodes:d}}const uE=({collapsedIds:t,nodes:e,edges:n})=>{const r=[],i=[];for(const u of t){const{hiddenEdges:c,hiddenNodes:f}=Ip({nodeId:u,nodes:e,edges:n,currentHiddenEdges:i,currentHiddenNodes:r});r.push(...f),i.push(...c)}const a=r.map(u=>u.id),o=i.map(u=>u.id),s=e.filter(u=>!a.includes(u.id)),l=n.filter(u=>!o.includes(u.id));return{visibleNodes:s,visibleEdges:l}},cE=({nodeId:t,edges:e,visibleEdgeIds:n})=>{const r=[],i=e.filter(u=>u.target===t);if(i.map(u=>u.id).some(u=>n.includes(u)))return r;const s=i.map(u=>u.source);let l=!1;for(const u of s)l||(r.push(u,...cE({nodeId:u,edges:e,visibleEdgeIds:n})),l=!0);return r},fE=({layoutType:t,sizingType:e,labelType:n,sizingAttribute:r,clusterAttribute:i,selections:a,nodes:o,edges:s,actives:l,collapsedNodeIds:u,defaultNodeSize:c,maxNodeSize:f,minNodeSize:d,layoutOverrides:h})=>{const p=he(L=>L.graph),g=he(L=>L.setClusters),m=he(L=>L.collapsedNodeIds),v=he(L=>L.setEdges),_=he(L=>L.setNodes),w=he(L=>L.setSelections),y=he(L=>L.setActives),b=he(L=>L.drags),S=he(L=>L.setDrags),E=he(L=>L.setCollapsedNodeIds),[x,A]=I.useState(!1),V=I.useRef(!1),F=I.useRef(null),{visibleEdges:P,visibleNodes:N}=I.useMemo(()=>{const{visibleEdges:L,visibleNodes:G}=uE({collapsedIds:m,nodes:o,edges:s});return{visibleEdges:L,visibleNodes:G}},[m,o,s]),W=I.useRef(b);I.useEffect(()=>{W.current=b},[b]);const H=I.useCallback(L=>{F.current=L||k0({...h,type:t,graph:p,drags:W.current,clusterAttribute:i}),ey(F.current,()=>{const G=Kb({graph:p,layout:F.current,sizingType:e,labelType:n,sizingAttribute:r,maxNodeSize:f,minNodeSize:d,defaultNodeSize:c}),B=E1({nodes:G.nodes,clusterAttribute:i});v(G.edges),_(G.nodes),g(B)})},[h,g,t,p,i,e,n,r,f,d,c,v,_]);return I.useEffect(()=>{w(a)},[a,w]),I.useEffect(()=>{y(l)},[l,y]),I.useLayoutEffect(()=>{V.current=!1,Yb(p,N,P),H(),requestAnimationFrame(()=>{V.current=!0,A(!0)})},[N,P,p]),I.useEffect(()=>{E(u)},[u,E]),I.useEffect(()=>{V.current&&(W.current={},S({}),H())},[p,t,H,S]),I.useEffect(()=>{V.current&&H(F.current)},[p,e,r,n,H]),{mounted:x}},ma=new Ee,Cu=new Ee,dE=new Ee;function hE(t,e,n){const r=ma.setFromMatrixPosition(t.matrixWorld);r.project(e);const i=n.width/2,a=n.height/2;return[r.x*i+i,-(r.y*a)+a]}function pE(t,e){const n=ma.setFromMatrixPosition(t.matrixWorld),r=Cu.setFromMatrixPosition(e.matrixWorld),i=n.sub(r),a=e.getWorldDirection(dE);return i.angleTo(a)>Math.PI/2}function mE(t,e,n,r){const i=ma.setFromMatrixPosition(t.matrixWorld),a=i.clone();a.project(e),n.setFromCamera(a,e);const o=n.intersectObjects(r,!0);if(o.length){const s=o[0].distance;return i.distanceTo(n.ray.origin)<s}return!0}function gE(t,e){if(e instanceof Id)return e.zoom;if(e instanceof Ld){const n=ma.setFromMatrixPosition(t.matrixWorld),r=Cu.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,a=n.distanceTo(r);return 1/(2*Math.tan(i/2)*a)}else return 1}function vE(t,e,n){if(e instanceof Ld||e instanceof Id){const r=ma.setFromMatrixPosition(t.matrixWorld),i=Cu.setFromMatrixPosition(e.matrixWorld),a=r.distanceTo(i),o=(n[1]-n[0])/(e.far-e.near),s=n[1]-o*e.far;return Math.round(o*a+s)}}const Tl=t=>Math.abs(t)<1e-10?0:t;function Lp(t,e,n=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=Tl(e[i]*t.elements[i])+(i!==15?",":")");return n+r}const yE=(t=>e=>Lp(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),bE=(t=>(e,n)=>Lp(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function _E(t){return t&&typeof t=="object"&&"current"in t}const Pu=I.forwardRef(({children:t,eps:e=.001,style:n,className:r,prepend:i,center:a,fullscreen:o,portal:s,distanceFactor:l,sprite:u=!1,transform:c=!1,occlude:f,onOcclude:d,castShadow:h,receiveShadow:p,material:g,geometry:m,zIndexRange:v=[16777271,0],calculatePosition:_=hE,as:w="div",wrapperClass:y,pointerEvents:b="auto",...S},E)=>{const{gl:x,camera:A,scene:V,size:F,raycaster:P,events:N,viewport:W}=xt(),[H]=I.useState(()=>document.createElement(w)),L=I.useRef(),G=I.useRef(null),B=I.useRef(0),q=I.useRef([0,0]),$=I.useRef(null),R=I.useRef(null),O=(s==null?void 0:s.current)||N.connected||x.domElement.parentNode,D=I.useRef(null),T=I.useRef(!1),C=I.useMemo(()=>f&&f!=="blending"||Array.isArray(f)&&f.length&&_E(f[0]),[f]);I.useLayoutEffect(()=>{const Q=x.domElement;f&&f==="blending"?(Q.style.zIndex=`${Math.floor(v[0]/2)}`,Q.style.position="absolute",Q.style.pointerEvents="none"):(Q.style.zIndex=null,Q.style.position=null,Q.style.pointerEvents=null)},[f]),I.useLayoutEffect(()=>{if(G.current){const Q=L.current=Eg(H);if(V.updateMatrixWorld(),c)H.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const X=_(G.current,A,F);H.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${X[0]}px,${X[1]}px,0);transform-origin:0 0;`}return O&&(i?O.prepend(H):O.appendChild(H)),()=>{O&&O.removeChild(H),Q.unmount()}}},[O,c]),I.useLayoutEffect(()=>{y&&(H.className=y)},[y]);const j=I.useMemo(()=>c?{position:"absolute",top:0,left:0,width:F.width,height:F.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:a?"translate3d(-50%,-50%,0)":"none",...o&&{top:-F.height/2,left:-F.width/2,width:F.width,height:F.height},...n},[n,a,o,F,c]),k=I.useMemo(()=>({position:"absolute",pointerEvents:b}),[b]);I.useLayoutEffect(()=>{if(T.current=!1,c){var Q;(Q=L.current)==null||Q.render(I.createElement("div",{ref:$,style:j},I.createElement("div",{ref:R,style:k},I.createElement("div",{ref:E,className:r,style:n,children:t}))))}else{var X;(X=L.current)==null||X.render(I.createElement("div",{ref:E,style:j,className:r,children:t}))}});const z=I.useRef(!0);zo(Q=>{if(G.current){A.updateMatrixWorld(),G.current.updateWorldMatrix(!0,!1);const X=c?q.current:_(G.current,A,F);if(c||Math.abs(B.current-A.zoom)>e||Math.abs(q.current[0]-X[0])>e||Math.abs(q.current[1]-X[1])>e){const Y=pE(G.current,A);let ae=!1;C&&(f!=="blending"?ae=[V]:Array.isArray(f)&&(ae=f.map(M=>M.current)));const te=z.current;if(ae){const M=mE(G.current,A,P,ae);z.current=M&&!Y}else z.current=!Y;te!==z.current&&(d?d(!z.current):H.style.display=z.current?"block":"none");const K=Math.floor(v[0]/2),U=f?C?[v[0],K]:[K-1,0]:v;if(H.style.zIndex=`${vE(G.current,A,U)}`,c){const[M,Z]=[F.width/2,F.height/2],ie=A.projectionMatrix.elements[5]*Z,{isOrthographicCamera:oe,top:ne,left:de,bottom:ce,right:pe}=A,fe=yE(A.matrixWorldInverse),Pe=oe?`scale(${ie})translate(${Tl(-(pe+de)/2)}px,${Tl((ne+ce)/2)}px)`:`translateZ(${ie}px)`;let xe=G.current.matrixWorld;u&&(xe=A.matrixWorldInverse.clone().transpose().copyPosition(xe).scale(G.current.scale),xe.elements[3]=xe.elements[7]=xe.elements[11]=0,xe.elements[15]=1),H.style.width=F.width+"px",H.style.height=F.height+"px",H.style.perspective=oe?"":`${ie}px`,$.current&&R.current&&($.current.style.transform=`${Pe}${fe}translate(${M}px,${Z}px)`,R.current.style.transform=bE(xe,1/((l||10)/400)))}else{const M=l===void 0?1:gE(G.current,A)*l;H.style.transform=`translate3d(${X[0]}px,${X[1]}px,0) scale(${M})`}q.current=X,B.current=A.zoom}}if(!C&&D.current&&!T.current)if(c){if($.current){const X=$.current.children[0];if(X!=null&&X.clientWidth&&X!=null&&X.clientHeight){const{isOrthographicCamera:Y}=A;if(Y||m)S.scale&&(Array.isArray(S.scale)?S.scale instanceof Ee?D.current.scale.copy(S.scale.clone().divideScalar(1)):D.current.scale.set(1/S.scale[0],1/S.scale[1],1/S.scale[2]):D.current.scale.setScalar(1/S.scale));else{const ae=(l||10)/400,te=X.clientWidth*ae,K=X.clientHeight*ae;D.current.scale.set(te,K,1)}T.current=!0}}}else{const X=H.children[0];if(X!=null&&X.clientWidth&&X!=null&&X.clientHeight){const Y=1/W.factor,ae=X.clientWidth*Y,te=X.clientHeight*Y;D.current.scale.set(ae,te,1),T.current=!0}D.current.lookAt(Q.camera.position)}});const J=I.useMemo(()=>({vertexShader:c?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[c]);return I.createElement("group",yn({},S,{ref:G}),f&&!C&&I.createElement("mesh",{castShadow:h,receiveShadow:p,ref:D},m||I.createElement("planeGeometry",null),g||I.createElement("shaderMaterial",{side:yt,vertexShader:J.vertexShader,fragmentShader:J.fragmentShader})))});function Vi(t,e="pointer",n="auto"){I.useEffect(()=>{if(t)return document.body.style.cursor=e,()=>void(document.body.style.cursor=n)},[t])}function wE(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}let Mu=va();const we=t=>ga(t,Mu);let Ru=va();we.write=t=>ga(t,Ru);let es=va();we.onStart=t=>ga(t,es);let Iu=va();we.onFrame=t=>ga(t,Iu);let Lu=va();we.onFinish=t=>ga(t,Lu);let Rr=[];we.setTimeout=(t,e)=>{let n=we.now()+e,r=()=>{let a=Rr.findIndex(o=>o.cancel==r);~a&&Rr.splice(a,1),$n-=~a?1:0},i={time:n,handler:t,cancel:r};return Rr.splice(Up(n),0,i),$n+=1,Vp(),i};let Up=t=>~(~Rr.findIndex(e=>e.time>t)||~Rr.length);we.cancel=t=>{es.delete(t),Iu.delete(t),Lu.delete(t),Mu.delete(t),Ru.delete(t)};we.sync=t=>{Sl=!0,we.batchedUpdates(t),Sl=!1};we.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function r(...i){e=i,we.onStart(n)}return r.handler=t,r.cancel=()=>{es.delete(n),e=null},r};let Uu=typeof window<"u"?window.requestAnimationFrame:()=>{};we.use=t=>Uu=t;we.now=typeof performance<"u"?()=>performance.now():Date.now;we.batchedUpdates=t=>t();we.catch=console.error;we.frameLoop="always";we.advance=()=>{we.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Gp()};let Wn=-1,$n=0,Sl=!1;function ga(t,e){Sl?(e.delete(t),t(0)):(e.add(t),Vp())}function Vp(){Wn<0&&(Wn=0,we.frameLoop!=="demand"&&Uu(Fp))}function EE(){Wn=-1}function Fp(){~Wn&&(Uu(Fp),we.batchedUpdates(Gp))}function Gp(){let t=Wn;Wn=we.now();let e=Up(Wn);if(e&&(Np(Rr.splice(0,e),n=>n.handler()),$n-=e),!$n){EE();return}es.flush(),Mu.flush(t?Math.min(64,Wn-t):16.667),Iu.flush(),Ru.flush(),Lu.flush()}function va(){let t=new Set,e=t;return{add(n){$n+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return $n-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,$n-=e.size,Np(e,r=>r(n)&&t.add(r)),$n+=t.size,e=t)}}}function Np(t,e){t.forEach(n=>{try{e(n)}catch(r){we.catch(r)}})}function Al(){}const xE=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),le={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Dn(t,e){if(le.arr(t)){if(!le.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}const Ge=(t,e)=>t.forEach(e);function Mn(t,e,n){if(le.arr(t)){for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);return}for(const r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}const Yt=t=>le.und(t)?[]:le.arr(t)?t:[t];function Fi(t,e){if(t.size){const n=Array.from(t);t.clear(),Ge(n,e)}}const Ui=(t,...e)=>Fi(t,n=>n(...e)),Vu=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let Fu,jp,Hn=null,zp=!1,Gu=Al;const TE=t=>{t.to&&(jp=t.to),t.now&&(we.now=t.now),t.colors!==void 0&&(Hn=t.colors),t.skipAnimation!=null&&(zp=t.skipAnimation),t.createStringInterpolator&&(Fu=t.createStringInterpolator),t.requestAnimationFrame&&we.use(t.requestAnimationFrame),t.batchedUpdates&&(we.batchedUpdates=t.batchedUpdates),t.willAdvance&&(Gu=t.willAdvance),t.frameLoop&&(we.frameLoop=t.frameLoop)};var En=Object.freeze({__proto__:null,get createStringInterpolator(){return Fu},get to(){return jp},get colors(){return Hn},get skipAnimation(){return zp},get willAdvance(){return Gu},assign:TE});const Gi=new Set;let Ht=[],$s=[],xo=0;const ts={get idle(){return!Gi.size&&!Ht.length},start(t){xo>t.priority?(Gi.add(t),we.onStart(SE)):(qp(t),we(kl))},advance:kl,sort(t){if(xo)we.onFrame(()=>ts.sort(t));else{const e=Ht.indexOf(t);~e&&(Ht.splice(e,1),Bp(t))}},clear(){Ht=[],Gi.clear()}};function SE(){Gi.forEach(qp),Gi.clear(),we(kl)}function qp(t){Ht.includes(t)||Bp(t)}function Bp(t){Ht.splice(AE(Ht,e=>e.priority>t.priority),0,t)}function kl(t){const e=$s;for(let n=0;n<Ht.length;n++){const r=Ht[n];xo=r.priority,r.idle||(Gu(r),r.advance(t),r.idle||e.push(r))}return xo=0,$s=Ht,$s.length=0,Ht=e,Ht.length>0}function AE(t,e){const n=t.findIndex(e);return n<0?t.length:n}const kE=(t,e,n)=>Math.min(Math.max(n,t),e),OE={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},ln="[-+]?\\d*\\.?\\d+",To=ln+"%";function ns(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}const DE=new RegExp("rgb"+ns(ln,ln,ln)),CE=new RegExp("rgba"+ns(ln,ln,ln,ln)),PE=new RegExp("hsl"+ns(ln,To,To)),ME=new RegExp("hsla"+ns(ln,To,To,ln)),RE=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,IE=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,LE=/^#([0-9a-fA-F]{6})$/,UE=/^#([0-9a-fA-F]{8})$/;function VE(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=LE.exec(t))?parseInt(e[1]+"ff",16)>>>0:Hn&&Hn[t]!==void 0?Hn[t]:(e=DE.exec(t))?(_r(e[1])<<24|_r(e[2])<<16|_r(e[3])<<8|255)>>>0:(e=CE.exec(t))?(_r(e[1])<<24|_r(e[2])<<16|_r(e[3])<<8|Cf(e[4]))>>>0:(e=RE.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=UE.exec(t))?parseInt(e[1],16)>>>0:(e=IE.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=PE.exec(t))?(Of(Df(e[1]),Na(e[2]),Na(e[3]))|255)>>>0:(e=ME.exec(t))?(Of(Df(e[1]),Na(e[2]),Na(e[3]))|Cf(e[4]))>>>0:null}function Hs(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Of(t,e,n){const r=n<.5?n*(1+e):n+e-n*e,i=2*n-r,a=Hs(i,r,t+1/3),o=Hs(i,r,t),s=Hs(i,r,t-1/3);return Math.round(a*255)<<24|Math.round(o*255)<<16|Math.round(s*255)<<8}function _r(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function Df(t){return(parseFloat(t)%360+360)%360/360}function Cf(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function Na(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function Pf(t){let e=VE(t);if(e===null)return t;e=e||0;let n=(e&4278190080)>>>24,r=(e&16711680)>>>16,i=(e&65280)>>>8,a=(e&255)/255;return`rgba(${n}, ${r}, ${i}, ${a})`}const Ji=(t,e,n)=>{if(le.fun(t))return t;if(le.arr(t))return Ji({range:t,output:e,extrapolate:n});if(le.str(t.output[0]))return Fu(t);const r=t,i=r.output,a=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",s=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(u=>u);return u=>{const c=GE(u,a);return FE(u,a[c],a[c+1],i[c],i[c+1],l,o,s,r.map)}};function FE(t,e,n,r,i,a,o,s,l){let u=l?l(t):t;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>n){if(s==="identity")return u;s==="clamp"&&(u=n)}return r===i?r:e===n?t<=e?r:i:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=a(u),r===-1/0?u=-u:i===1/0?u=u+r:u=u*(i-r)+r,u)}function GE(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}const NE=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const r=n*t,i=e==="end"?Math.floor(r):Math.ceil(r);return kE(0,1,i/t)},So=1.70158,ja=So*1.525,Mf=So+1,Rf=2*Math.PI/3,If=2*Math.PI/4.5,za=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,jE={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>Mf*t*t*t-So*t*t,easeOutBack:t=>1+Mf*Math.pow(t-1,3)+So*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((ja+1)*2*t-ja)/2:(Math.pow(2*t-2,2)*((ja+1)*(t*2-2)+ja)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*Rf),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*Rf)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*If))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*If)/2+1,easeInBounce:t=>1-za(1-t),easeOutBounce:za,easeInOutBounce:t=>t<.5?(1-za(1-2*t))/2:(1+za(2*t-1))/2,steps:NE};function Ol(){return Ol=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ol.apply(this,arguments)}const Nr=Symbol.for("FluidValue.get"),dr=Symbol.for("FluidValue.observers"),vn=t=>!!(t&&t[Nr]),qt=t=>t&&t[Nr]?t[Nr]():t,Lf=t=>t[dr]||null;function zE(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Ao(t,e){let n=t[dr];n&&n.forEach(r=>{zE(r,e)})}class qE{constructor(e){if(this[Nr]=void 0,this[dr]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");BE(this,e)}}const BE=(t,e)=>Wp(t,Nr,e);function ya(t,e){if(t[Nr]){let n=t[dr];n||Wp(t,dr,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function ko(t,e){let n=t[dr];if(n&&n.has(e)){const r=n.size-1;r?n.delete(e):t[dr]=null,t.observerRemoved&&t.observerRemoved(r,e)}}const Wp=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),ro=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,WE=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,Uf=new RegExp(`(${ro.source})(%|[a-z]+)`,"i"),$E=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,rs=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,$p=t=>{const[e,n]=HE(t);if(!e||Vu())return t;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(n&&n.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(n);return i||t}else{if(n&&rs.test(n))return $p(n);if(n)return n}return t},HE=t=>{const e=rs.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]};let Ys;const YE=(t,e,n,r,i)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${i})`,Hp=t=>{Ys||(Ys=Hn?new RegExp(`(${Object.keys(Hn).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(a=>qt(a).replace(rs,$p).replace(WE,Pf).replace(Ys,Pf)),n=e.map(a=>a.match(ro).map(Number)),i=n[0].map((a,o)=>n.map(s=>{if(!(o in s))throw Error('The arity of each "output" value must be equal');return s[o]})).map(a=>Ji(Ol({},t,{output:a})));return a=>{var o;const s=!Uf.test(e[0])&&((o=e.find(u=>Uf.test(u)))==null?void 0:o.replace(ro,""));let l=0;return e[0].replace(ro,()=>`${i[l++](a)}${s||""}`).replace($E,YE)}},Nu="react-spring: ",Yp=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${Nu}once requires a function parameter`);return(...r)=>{n||(e(...r),n=!0)}},KE=Yp(console.warn);function XE(){KE(`${Nu}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const ZE=Yp(console.warn);function QE(){ZE(`${Nu}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function is(t){return le.str(t)&&(t[0]=="#"||/\d/.test(t)||!Vu()&&rs.test(t)||t in(Hn||{}))}const ju=Vu()?I.useEffect:I.useLayoutEffect,JE=()=>{const t=I.useRef(!1);return ju(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function Kp(){const t=I.useState()[1],e=JE();return()=>{e.current&&t(Math.random())}}function ex(t,e){const[n]=I.useState(()=>({inputs:e,result:t()})),r=I.useRef(),i=r.current;let a=i;return a?e&&a.inputs&&tx(e,a.inputs)||(a={inputs:e,result:t()}):a=n,I.useEffect(()=>{r.current=a,i==n&&(n.inputs=n.result=void 0)},[a]),a.result}function tx(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const Xp=t=>I.useEffect(t,nx),nx=[];function Vf(t){const e=I.useRef();return I.useEffect(()=>{e.current=t}),e.current}const ea=Symbol.for("Animated:node"),rx=t=>!!t&&t[ea]===t,gn=t=>t&&t[ea],zu=(t,e)=>xE(t,ea,e),as=t=>t&&t[ea]&&t[ea].getPayload();class Zp{constructor(){this.payload=void 0,zu(this,this)}getPayload(){return this.payload||[]}}class Kr extends Zp{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,le.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new Kr(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,n){return le.num(e)&&(this.lastPosition=e,n&&(e=Math.round(e/n)*n,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,le.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class jr extends Kr{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=Ji({output:[e,e]})}static create(e){return new jr(e)}getValue(){let e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(le.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=Ji({output:[this.getValue(),e]})),this._value=0,super.reset()}}const Oo={dependencies:null};class qu extends Zp{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const n={};return Mn(this.source,(r,i)=>{rx(r)?n[i]=r.getValue(e):vn(r)?n[i]=qt(r):e||(n[i]=r)}),n}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&Ge(this.payload,e=>e.reset())}_makePayload(e){if(e){const n=new Set;return Mn(e,this._addToPayload,n),Array.from(n)}}_addToPayload(e){Oo.dependencies&&vn(e)&&Oo.dependencies.add(e);const n=as(e);n&&Ge(n,r=>this.add(r))}}class Bu extends qu{constructor(e){super(e)}static create(e){return new Bu(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const n=this.getPayload();return e.length==n.length?n.map((r,i)=>r.setValue(e[i])).some(Boolean):(super.setValue(e.map(ix)),!0)}}function ix(t){return(is(t)?jr:Kr).create(t)}function Dl(t){const e=gn(t);return e?e.constructor:le.arr(t)?Bu:is(t)?jr:Kr}function Do(){return Do=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Do.apply(this,arguments)}const Ff=(t,e)=>{const n=!le.fun(t)||t.prototype&&t.prototype.isReactComponent;return I.forwardRef((r,i)=>{const a=I.useRef(null),o=n&&I.useCallback(p=>{a.current=sx(i,p)},[i]),[s,l]=ox(r,e),u=Kp(),c=()=>{const p=a.current;if(n&&!p)return;(p?e.applyAnimatedValues(p,s.getValue(!0)):!1)===!1&&u()},f=new ax(c,l),d=I.useRef();ju(()=>(d.current=f,Ge(l,p=>ya(p,f)),()=>{d.current&&(Ge(d.current.deps,p=>ko(p,d.current)),we.cancel(d.current.update))})),I.useEffect(c,[]),Xp(()=>()=>{const p=d.current;Ge(p.deps,g=>ko(g,p))});const h=e.getComponentProps(s.getValue());return I.createElement(t,Do({},h,{ref:o}))})};class ax{constructor(e,n){this.update=e,this.deps=n}eventObserved(e){e.type=="change"&&we.write(this.update)}}function ox(t,e){const n=new Set;return Oo.dependencies=n,t.style&&(t=Do({},t,{style:e.createAnimatedStyle(t.style)})),t=new qu(t),Oo.dependencies=null,[t,n]}function sx(t,e){return t&&(le.fun(t)?t(e):t.current=e),e}const Gf=Symbol.for("AnimatedComponent"),lx=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=i=>new qu(i),getComponentProps:r=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:r},a=o=>{const s=Nf(o)||"Anonymous";return le.str(o)?o=a[o]||(a[o]=Ff(o,i)):o=o[Gf]||(o[Gf]=Ff(o,i)),o.displayName=`Animated(${s})`,o};return Mn(t,(o,s)=>{le.arr(t)&&(s=Nf(o)),a[s]=a(o)}),{animated:a}},Nf=t=>le.str(t)?t:t&&le.str(t.displayName)?t.displayName:le.fun(t)&&t.name||null;function dt(){return dt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dt.apply(this,arguments)}function ar(t,...e){return le.fun(t)?t(...e):t}const Ni=(t,e)=>t===!0||!!(e&&t&&(le.fun(t)?t(e):Yt(t).includes(e))),Qp=(t,e)=>le.obj(t)?e&&t[e]:t,Jp=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,ux=t=>t,Wu=(t,e=ux)=>{let n=cx;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const r={};for(const i of n){const a=e(t[i],i);le.und(a)||(r[i]=a)}return r},cx=["config","onProps","onStart","onChange","onPause","onResume","onRest"],fx={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function dx(t){const e={};let n=0;if(Mn(t,(r,i)=>{fx[i]||(e[i]=r,n++)}),n)return e}function em(t){const e=dx(t);if(e){const n={to:e};return Mn(t,(r,i)=>i in e||(n[i]=r)),n}return dt({},t)}function ta(t){return t=qt(t),le.arr(t)?t.map(ta):is(t)?En.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function hx(t){for(const e in t)return!0;return!1}function Cl(t){return le.fun(t)||le.arr(t)&&le.obj(t[0])}function px(t,e){var n;(n=t.ref)==null||n.delete(t),e==null||e.delete(t)}function mx(t,e){if(e&&t.ref!==e){var n;(n=t.ref)==null||n.delete(t),e.add(t),t.ref=e}}const gx={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},Pl=dt({},gx.default,{mass:1,damping:1,easing:jE.linear,clamp:!1});class vx{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,Pl)}}function yx(t,e,n){n&&(n=dt({},n),jf(n,e),e=dt({},n,e)),jf(t,e),Object.assign(t,e);for(const o in Pl)t[o]==null&&(t[o]=Pl[o]);let{mass:r,frequency:i,damping:a}=t;return le.und(i)||(i<.01&&(i=.01),a<0&&(a=0),t.tension=Math.pow(2*Math.PI/i,2)*r,t.friction=4*Math.PI*a*r/i),t}function jf(t,e){if(!le.und(e.decay))t.duration=void 0;else{const n=!le.und(e.tension)||!le.und(e.friction);(n||!le.und(e.frequency)||!le.und(e.damping)||!le.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}const zf=[];class bx{constructor(){this.changed=!1,this.values=zf,this.toValues=null,this.fromValues=zf,this.to=void 0,this.from=void 0,this.config=new vx,this.immediate=!1}}function tm(t,{key:e,props:n,defaultProps:r,state:i,actions:a}){return new Promise((o,s)=>{var l;let u,c,f=Ni((l=n.cancel)!=null?l:r==null?void 0:r.cancel,e);if(f)p();else{le.und(n.pause)||(i.paused=Ni(n.pause,e));let g=r==null?void 0:r.pause;g!==!0&&(g=i.paused||Ni(g,e)),u=ar(n.delay||0,e),g?(i.resumeQueue.add(h),a.pause()):(a.resume(),h())}function d(){i.resumeQueue.add(h),i.timeouts.delete(c),c.cancel(),u=c.time-we.now()}function h(){u>0&&!En.skipAnimation?(i.delayed=!0,c=we.setTimeout(p,u),i.pauseQueue.add(d),i.timeouts.add(c)):p()}function p(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(d),i.timeouts.delete(c),t<=(i.cancelId||0)&&(f=!0);try{a.start(dt({},n,{callId:t,cancel:f}),o)}catch(g){s(g)}}})}const $u=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?Ir(t.get()):e.every(n=>n.noop)?nm(t.get()):on(t.get(),e.every(n=>n.finished)),nm=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),on=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),Ir=t=>({value:t,cancelled:!0,finished:!1});function rm(t,e,n,r){const{callId:i,parentId:a,onRest:o}=e,{asyncTo:s,promise:l}=n;return!a&&t===s&&!e.reset?l:n.promise=(async()=>{n.asyncId=i,n.asyncTo=t;const u=Wu(e,(m,v)=>v==="onRest"?void 0:m);let c,f;const d=new Promise((m,v)=>(c=m,f=v)),h=m=>{const v=i<=(n.cancelId||0)&&Ir(r)||i!==n.asyncId&&on(r,!1);if(v)throw m.result=v,f(m),m},p=(m,v)=>{const _=new qf,w=new Bf;return(async()=>{if(En.skipAnimation)throw na(n),w.result=on(r,!1),f(w),w;h(_);const y=le.obj(m)?dt({},m):dt({},v,{to:m});y.parentId=i,Mn(u,(S,E)=>{le.und(y[E])&&(y[E]=S)});const b=await r.start(y);return h(_),n.paused&&await new Promise(S=>{n.resumeQueue.add(S)}),b})()};let g;if(En.skipAnimation)return na(n),on(r,!1);try{let m;le.arr(t)?m=(async v=>{for(const _ of v)await p(_)})(t):m=Promise.resolve(t(p,r.stop.bind(r))),await Promise.all([m.then(c),d]),g=on(r.get(),!0,!1)}catch(m){if(m instanceof qf)g=m.result;else if(m instanceof Bf)g=m.result;else throw m}finally{i==n.asyncId&&(n.asyncId=a,n.asyncTo=a?s:void 0,n.promise=a?l:void 0)}return le.fun(o)&&we.batchedUpdates(()=>{o(g,r,r.item)}),g})()}function na(t,e){Fi(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}class qf extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class Bf extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const Ml=t=>t instanceof Hu;let _x=1;class Hu extends qE{constructor(...e){super(...e),this.id=_x++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=gn(this);return e&&e.getValue()}to(...e){return En.to(this,e)}interpolate(...e){return XE(),En.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,n=!1){Ao(this,{type:"change",parent:this,value:e,idle:n})}_onPriorityChange(e){this.idle||ts.sort(this),Ao(this,{type:"priority",parent:this,priority:e})}}const hr=Symbol.for("SpringPhase"),im=1,Rl=2,Il=4,Ks=t=>(t[hr]&im)>0,jn=t=>(t[hr]&Rl)>0,yi=t=>(t[hr]&Il)>0,Wf=(t,e)=>e?t[hr]|=Rl|im:t[hr]&=~Rl,$f=(t,e)=>e?t[hr]|=Il:t[hr]&=~Il;class wx extends Hu{constructor(e,n){if(super(),this.key=void 0,this.animation=new bx,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!le.und(e)||!le.und(n)){const r=le.obj(e)?dt({},e):dt({},n,{from:e});le.und(r.default)&&(r.default=!0),this.start(r)}}get idle(){return!(jn(this)||this._state.asyncTo)||yi(this)}get goal(){return qt(this.animation.to)}get velocity(){const e=gn(this);return e instanceof Kr?e.lastVelocity||0:e.getPayload().map(n=>n.lastVelocity||0)}get hasAnimated(){return Ks(this)}get isAnimating(){return jn(this)}get isPaused(){return yi(this)}get isDelayed(){return this._state.delayed}advance(e){let n=!0,r=!1;const i=this.animation;let{config:a,toValues:o}=i;const s=as(i.to);!s&&vn(i.to)&&(o=Yt(qt(i.to))),i.values.forEach((c,f)=>{if(c.done)return;const d=c.constructor==jr?1:s?s[f].lastPosition:o[f];let h=i.immediate,p=d;if(!h){if(p=c.lastPosition,a.tension<=0){c.done=!0;return}let g=c.elapsedTime+=e;const m=i.fromValues[f],v=c.v0!=null?c.v0:c.v0=le.arr(a.velocity)?a.velocity[f]:a.velocity;let _;const w=a.precision||(m==d?.005:Math.min(1,Math.abs(d-m)*.001));if(le.und(a.duration))if(a.decay){const y=a.decay===!0?.998:a.decay,b=Math.exp(-(1-y)*g);p=m+v/(1-y)*(1-b),h=Math.abs(c.lastPosition-p)<=w,_=v*b}else{_=c.lastVelocity==null?v:c.lastVelocity;const y=a.restVelocity||w/10,b=a.clamp?0:a.bounce,S=!le.und(b),E=m==d?c.v0>0:m<d;let x,A=!1;const V=1,F=Math.ceil(e/V);for(let P=0;P<F&&(x=Math.abs(_)>y,!(!x&&(h=Math.abs(d-p)<=w,h)));++P){S&&(A=p==d||p>d==E,A&&(_=-_*b,p=d));const N=-a.tension*1e-6*(p-d),W=-a.friction*.001*_,H=(N+W)/a.mass;_=_+H*V,p=p+_*V}}else{let y=1;a.duration>0&&(this._memoizedDuration!==a.duration&&(this._memoizedDuration=a.duration,c.durationProgress>0&&(c.elapsedTime=a.duration*c.durationProgress,g=c.elapsedTime+=e)),y=(a.progress||0)+g/this._memoizedDuration,y=y>1?1:y<0?0:y,c.durationProgress=y),p=m+a.easing(y)*(d-m),_=(p-c.lastPosition)/e,h=y==1}c.lastVelocity=_,Number.isNaN(p)&&(console.warn("Got NaN while animating:",this),h=!0)}s&&!s[f].done&&(h=!1),h?c.done=!0:n=!1,c.setValue(p,a.round)&&(r=!0)});const l=gn(this),u=l.getValue();if(n){const c=qt(i.to);(u!==c||r)&&!a.decay?(l.setValue(c),this._onChange(c)):r&&a.decay&&this._onChange(u),this._stop()}else r&&this._onChange(u)}set(e){return we.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(jn(this)){const{to:e,config:n}=this.animation;we.batchedUpdates(()=>{this._onStart(),n.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,n){let r;return le.und(e)?(r=this.queue||[],this.queue=[]):r=[le.obj(e)?e:dt({},n,{to:e})],Promise.all(r.map(i=>this._update(i))).then(i=>$u(this,i))}stop(e){const{to:n}=this.animation;return this._focus(this.get()),na(this._state,e&&this._lastCallId),we.batchedUpdates(()=>this._stop(n,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const n=this.key||"";let{to:r,from:i}=e;r=le.obj(r)?r[n]:r,(r==null||Cl(r))&&(r=void 0),i=le.obj(i)?i[n]:i,i==null&&(i=void 0);const a={to:r,from:i};return Ks(this)||(e.reverse&&([r,i]=[i,r]),i=qt(i),le.und(i)?gn(this)||this._set(r):this._set(i)),a}_update(e,n){let r=dt({},e);const{key:i,defaultProps:a}=this;r.default&&Object.assign(a,Wu(r,(l,u)=>/^on/.test(u)?Qp(l,i):l)),Yf(this,r,"onProps"),_i(this,"onProps",r,this);const o=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return tm(++this._lastCallId,{key:i,props:r,defaultProps:a,state:s,actions:{pause:()=>{yi(this)||($f(this,!0),Ui(s.pauseQueue),_i(this,"onPause",on(this,bi(this,this.animation.to)),this))},resume:()=>{yi(this)&&($f(this,!1),jn(this)&&this._resume(),Ui(s.resumeQueue),_i(this,"onResume",on(this,bi(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then(l=>{if(r.loop&&l.finished&&!(n&&l.noop)){const u=am(r);if(u)return this._update(u,!0)}return l})}_merge(e,n,r){if(n.cancel)return this.stop(!0),r(Ir(this));const i=!le.und(e.to),a=!le.und(e.from);if(i||a)if(n.callId>this._lastToId)this._lastToId=n.callId;else return r(Ir(this));const{key:o,defaultProps:s,animation:l}=this,{to:u,from:c}=l;let{to:f=u,from:d=c}=e;a&&!i&&(!n.default||le.und(f))&&(f=d),n.reverse&&([f,d]=[d,f]);const h=!Dn(d,c);h&&(l.from=d),d=qt(d);const p=!Dn(f,u);p&&this._focus(f);const g=Cl(n.to),{config:m}=l,{decay:v,velocity:_}=m;(i||a)&&(m.velocity=0),n.config&&!g&&yx(m,ar(n.config,o),n.config!==s.config?ar(s.config,o):void 0);let w=gn(this);if(!w||le.und(f))return r(on(this,!0));const y=le.und(n.reset)?a&&!n.default:!le.und(d)&&Ni(n.reset,o),b=y?d:this.get(),S=ta(f),E=le.num(S)||le.arr(S)||is(S),x=!g&&(!E||Ni(s.immediate||n.immediate,o));if(p){const P=Dl(f);if(P!==w.constructor)if(x)w=this._set(S);else throw Error(`Cannot animate between ${w.constructor.name} and ${P.name}, as the "to" prop suggests`)}const A=w.constructor;let V=vn(f),F=!1;if(!V){const P=y||!Ks(this)&&h;(p||P)&&(F=Dn(ta(b),S),V=!F),(!Dn(l.immediate,x)&&!x||!Dn(m.decay,v)||!Dn(m.velocity,_))&&(V=!0)}if(F&&jn(this)&&(l.changed&&!y?V=!0:V||this._stop(u)),!g&&((V||vn(u))&&(l.values=w.getPayload(),l.toValues=vn(f)?null:A==jr?[1]:Yt(S)),l.immediate!=x&&(l.immediate=x,!x&&!y&&this._set(u)),V)){const{onRest:P}=l;Ge(xx,W=>Yf(this,n,W));const N=on(this,bi(this,u));Ui(this._pendingCalls,N),this._pendingCalls.add(r),l.changed&&we.batchedUpdates(()=>{l.changed=!y,P==null||P(N,this),y?ar(s.onRest,N):l.onStart==null||l.onStart(N,this)})}y&&this._set(b),g?r(rm(n.to,n,this._state,this)):V?this._start():jn(this)&&!p?this._pendingCalls.add(r):r(nm(b))}_focus(e){const n=this.animation;e!==n.to&&(Lf(this)&&this._detach(),n.to=e,Lf(this)&&this._attach())}_attach(){let e=0;const{to:n}=this.animation;vn(n)&&(ya(n,this),Ml(n)&&(e=n.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;vn(e)&&ko(e,this)}_set(e,n=!0){const r=qt(e);if(!le.und(r)){const i=gn(this);if(!i||!Dn(r,i.getValue())){const a=Dl(r);!i||i.constructor!=a?zu(this,a.create(r)):i.setValue(r),i&&we.batchedUpdates(()=>{this._onChange(r,n)})}}return gn(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,_i(this,"onStart",on(this,bi(this,e.to)),this))}_onChange(e,n){n||(this._onStart(),ar(this.animation.onChange,e,this)),ar(this.defaultProps.onChange,e,this),super._onChange(e,n)}_start(){const e=this.animation;gn(this).reset(qt(e.to)),e.immediate||(e.fromValues=e.values.map(n=>n.lastPosition)),jn(this)||(Wf(this,!0),yi(this)||this._resume())}_resume(){En.skipAnimation?this.finish():ts.start(this)}_stop(e,n){if(jn(this)){Wf(this,!1);const r=this.animation;Ge(r.values,a=>{a.done=!0}),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),Ao(this,{type:"idle",parent:this});const i=n?Ir(this.get()):on(this.get(),bi(this,e??r.to));Ui(this._pendingCalls,i),r.changed&&(r.changed=!1,_i(this,"onRest",i,this))}}}function bi(t,e){const n=ta(e),r=ta(t.get());return Dn(r,n)}function am(t,e=t.loop,n=t.to){let r=ar(e);if(r){const i=r!==!0&&em(r),a=(i||t).reverse,o=!i||i.reset;return ra(dt({},t,{loop:e,default:!1,pause:void 0,to:!a||Cl(n)?n:void 0,from:o?t.from:void 0,reset:o},i))}}function ra(t){const{to:e,from:n}=t=em(t),r=new Set;return le.obj(e)&&Hf(e,r),le.obj(n)&&Hf(n,r),t.keys=r.size?Array.from(r):null,t}function Ex(t){const e=ra(t);return le.und(e.default)&&(e.default=Wu(e)),e}function Hf(t,e){Mn(t,(n,r)=>n!=null&&e.add(r))}const xx=["onStart","onRest","onChange","onPause","onResume"];function Yf(t,e,n){t.animation[n]=e[n]!==Jp(e,n)?Qp(e[n],t.key):void 0}function _i(t,e,...n){var r,i,a,o;(r=(i=t.animation)[e])==null||r.call(i,...n),(a=(o=t.defaultProps)[e])==null||a.call(o,...n)}const Tx=["onStart","onChange","onRest"];let Sx=1;class Ax{constructor(e,n){this.id=Sx++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),n&&(this._flush=n),e&&this.start(dt({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((n,r)=>e[r]=n.get()),e}set(e){for(const n in e){const r=e[n];le.und(r)||this.springs[n].set(r)}}update(e){return e&&this.queue.push(ra(e)),this}start(e){let{queue:n}=this;return e?n=Yt(e).map(ra):this.queue=[],this._flush?this._flush(this,n):(cm(this,n),Ll(this,n))}stop(e,n){if(e!==!!e&&(n=e),n){const r=this.springs;Ge(Yt(n),i=>r[i].stop(!!e))}else na(this._state,this._lastAsyncId),this.each(r=>r.stop(!!e));return this}pause(e){if(le.und(e))this.start({pause:!0});else{const n=this.springs;Ge(Yt(e),r=>n[r].pause())}return this}resume(e){if(le.und(e))this.start({pause:!1});else{const n=this.springs;Ge(Yt(e),r=>n[r].resume())}return this}each(e){Mn(this.springs,e)}_onFrame(){const{onStart:e,onChange:n,onRest:r}=this._events,i=this._active.size>0,a=this._changed.size>0;(i&&!this._started||a&&!this._started)&&(this._started=!0,Fi(e,([l,u])=>{u.value=this.get(),l(u,this,this._item)}));const o=!i&&this._started,s=a||o&&r.size?this.get():null;a&&n.size&&Fi(n,([l,u])=>{u.value=s,l(u,this,this._item)}),o&&(this._started=!1,Fi(r,([l,u])=>{u.value=s,l(u,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;we.onFrame(this._onFrame)}}function Ll(t,e){return Promise.all(e.map(n=>om(t,n))).then(n=>$u(t,n))}async function om(t,e,n){const{keys:r,to:i,from:a,loop:o,onRest:s,onResolve:l}=e,u=le.obj(e.default)&&e.default;o&&(e.loop=!1),i===!1&&(e.to=null),a===!1&&(e.from=null);const c=le.arr(i)||le.fun(i)?i:void 0;c?(e.to=void 0,e.onRest=void 0,u&&(u.onRest=void 0)):Ge(Tx,g=>{const m=e[g];if(le.fun(m)){const v=t._events[g];e[g]=({finished:_,cancelled:w})=>{const y=v.get(m);y?(_||(y.finished=!1),w&&(y.cancelled=!0)):v.set(m,{value:null,finished:_||!1,cancelled:w||!1})},u&&(u[g]=e[g])}});const f=t._state;e.pause===!f.paused?(f.paused=e.pause,Ui(e.pause?f.pauseQueue:f.resumeQueue)):f.paused&&(e.pause=!0);const d=(r||Object.keys(t.springs)).map(g=>t.springs[g].start(e)),h=e.cancel===!0||Jp(e,"cancel")===!0;(c||h&&f.asyncId)&&d.push(tm(++t._lastAsyncId,{props:e,state:f,actions:{pause:Al,resume:Al,start(g,m){h?(na(f,t._lastAsyncId),m(Ir(t))):(g.onRest=s,m(rm(c,g,f,t)))}}})),f.paused&&await new Promise(g=>{f.resumeQueue.add(g)});const p=$u(t,await Promise.all(d));if(o&&p.finished&&!(n&&p.noop)){const g=am(e,o,i);if(g)return cm(t,[g]),om(t,g,!0)}return l&&we.batchedUpdates(()=>l(p,t,t.item)),p}function Kf(t,e){const n=dt({},t.springs);return e&&Ge(Yt(e),r=>{le.und(r.keys)&&(r=ra(r)),le.obj(r.to)||(r=dt({},r,{to:void 0})),um(n,r,i=>lm(i))}),sm(t,n),n}function sm(t,e){Mn(e,(n,r)=>{t.springs[r]||(t.springs[r]=n,ya(n,t))})}function lm(t,e){const n=new wx;return n.key=t,e&&ya(n,e),n}function um(t,e,n){e.keys&&Ge(e.keys,r=>{(t[r]||(t[r]=n(r)))._prepareNode(e)})}function cm(t,e){Ge(e,n=>{um(t.springs,n,r=>lm(r,t))})}function kx(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,a;for(a=0;a<r.length;a++)i=r[a],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}const Ox=["children"],os=t=>{let{children:e}=t,n=kx(t,Ox);const r=I.useContext(Co),i=n.pause||!!r.pause,a=n.immediate||!!r.immediate;n=ex(()=>({pause:i,immediate:a}),[i,a]);const{Provider:o}=Co;return I.createElement(o,{value:n},e)},Co=Dx(os,{});os.Provider=Co.Provider;os.Consumer=Co.Consumer;function Dx(t,e){return Object.assign(t,I.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}const Cx=()=>{const t=[],e=function(i){QE();const a=[];return Ge(t,(o,s)=>{if(le.und(i))a.push(o.start());else{const l=n(i,o,s);l&&a.push(o.start(l))}}),a};e.current=t,e.add=function(r){t.includes(r)||t.push(r)},e.delete=function(r){const i=t.indexOf(r);~i&&t.splice(i,1)},e.pause=function(){return Ge(t,r=>r.pause(...arguments)),this},e.resume=function(){return Ge(t,r=>r.resume(...arguments)),this},e.set=function(r){Ge(t,i=>i.set(r))},e.start=function(r){const i=[];return Ge(t,(a,o)=>{if(le.und(r))i.push(a.start());else{const s=this._getProps(r,a,o);s&&i.push(a.start(s))}}),i},e.stop=function(){return Ge(t,r=>r.stop(...arguments)),this},e.update=function(r){return Ge(t,(i,a)=>i.update(this._getProps(r,i,a))),this};const n=function(i,a,o){return le.fun(i)?i(o,a):i};return e._getProps=n,e};function Px(t,e,n){const r=le.fun(e)&&e;r&&!n&&(n=[]);const i=I.useMemo(()=>r||arguments.length==3?Cx():void 0,[]),a=I.useRef(0),o=Kp(),s=I.useMemo(()=>({ctrls:[],queue:[],flush(v,_){const w=Kf(v,_);return a.current>0&&!s.queue.length&&!Object.keys(w).some(b=>!v.springs[b])?Ll(v,_):new Promise(b=>{sm(v,w),s.queue.push(()=>{b(Ll(v,_))}),o()})}}),[]),l=I.useRef([...s.ctrls]),u=[],c=Vf(t)||0;I.useMemo(()=>{Ge(l.current.slice(t,c),v=>{px(v,i),v.stop(!0)}),l.current.length=t,f(c,t)},[t]),I.useMemo(()=>{f(0,Math.min(c,t))},n);function f(v,_){for(let w=v;w<_;w++){const y=l.current[w]||(l.current[w]=new Ax(null,s.flush)),b=r?r(w,y):e[w];b&&(u[w]=Ex(b))}}const d=l.current.map((v,_)=>Kf(v,u[_])),h=I.useContext(os),p=Vf(h),g=h!==p&&hx(h);ju(()=>{a.current++,s.ctrls=l.current;const{queue:v}=s;v.length&&(s.queue=[],Ge(v,_=>_())),Ge(l.current,(_,w)=>{i==null||i.add(_),g&&_.start({default:h});const y=u[w];y&&(mx(_,y.ref),_.ref?_.queue.push(y):_.start(y))})}),Xp(()=>()=>{Ge(s.ctrls,v=>v.stop(!0))});const m=d.map(v=>dt({},v));return i?[m,i]:m}function Ut(t,e){const n=le.fun(t),[[r],i]=Px(1,n?t:[t],n?e||[]:e);return n||arguments.length==2?[r,i]:r}let Xf;(function(t){t.MOUNT="mount",t.ENTER="enter",t.UPDATE="update",t.LEAVE="leave"})(Xf||(Xf={}));class Mx extends Hu{constructor(e,n){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=Ji(...n);const r=this._get(),i=Dl(r);zu(this,i.create(r))}advance(e){const n=this._get(),r=this.get();Dn(n,r)||(gn(this).setValue(n),this._onChange(n,this.idle)),!this.idle&&Zf(this._active)&&Xs(this)}_get(){const e=le.arr(this.source)?this.source.map(qt):Yt(qt(this.source));return this.calc(...e)}_start(){this.idle&&!Zf(this._active)&&(this.idle=!1,Ge(as(this),e=>{e.done=!1}),En.skipAnimation?(we.batchedUpdates(()=>this.advance()),Xs(this)):ts.start(this))}_attach(){let e=1;Ge(Yt(this.source),n=>{vn(n)&&ya(n,this),Ml(n)&&(n.idle||this._active.add(n),e=Math.max(e,n.priority+1))}),this.priority=e,this._start()}_detach(){Ge(Yt(this.source),e=>{vn(e)&&ko(e,this)}),this._active.clear(),Xs(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=Yt(this.source).reduce((n,r)=>Math.max(n,(Ml(r)?r.priority:0)+1),0))}}function Rx(t){return t.idle!==!1}function Zf(t){return!t.size||Array.from(t).every(Rx)}function Xs(t){t.idle||(t.idle=!0,Ge(as(t),e=>{e.done=!0}),Ao(t,{type:"idle",parent:t}))}En.assign({createStringInterpolator:Hp,to:(t,e)=>new Mx(t,e)});const Ix=["primitive"].concat(Object.keys(Rd).filter(t=>/^[A-Z]/.test(t)).map(t=>t[0].toLowerCase()+t.slice(1)));En.assign({createStringInterpolator:Hp,colors:OE,frameLoop:"demand"});Ym(()=>{we.advance()});const Lx=lx(Ix,{applyAnimatedValues:Km}),Je=Lx.animated,qa=(t,e)=>{const n=t[0].index!==null,r=new Set(Object.keys(t[0].attributes)),i=new Set(Object.keys(t[0].morphAttributes)),a={},o={},s=t[0].morphTargetsRelative,l=new Yl;let u=0;if(t.forEach((c,f)=>{let d=0;if(n!==(c.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let h in c.attributes){if(!r.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+h+'" attribute exists among all geometries, or in none of them.'),null;a[h]===void 0&&(a[h]=[]),a[h].push(c.attributes[h]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(s!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let h in c.morphAttributes){if(!i.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;o[h]===void 0&&(o[h]=[]),o[h].push(c.morphAttributes[h])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(c.userData),e){let h;if(c.index)h=c.index.count;else if(c.attributes.position!==void 0)h=c.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,h,f),u+=h}}),n){let c=0;const f=[];t.forEach(d=>{const h=d.index;for(let p=0;p<h.count;++p)f.push(h.getX(p)+c);c+=d.attributes.position.count}),l.setIndex(f)}for(let c in a){const f=Qf(a[c]);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,f)}for(let c in o){const f=o[c][0].length;if(f===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<f;++d){const h=[];for(let g=0;g<o[c].length;++g)h.push(o[c][g][d]);const p=Qf(h);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(p)}}return l},Qf=t=>{let e,n,r,i=0;if(t.forEach(a=>{if(e===void 0&&(e=a.array.constructor),e!==a.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=a.itemSize),n!==a.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=a.normalized),r!==a.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=a.array.length}),e&&n){const a=new e(i);let o=0;return t.forEach(s=>{a.set(s.array,o),o+=s.array.length}),new Ud(a,n,r)}},Zs=new Xm,Qs=new Ee,wr=new Ee,an=new Ee,An=new Ee,dn=new Ee,kn=new Ee,On=new Ee,wi=new Ee,Ei=new Ee,xi=new Ee,Ba=new Ee,Ti=new Ee,Si=new Ee,Ai=new Ee;class Jf{constructor(e,n,r){this.camera=e,this.scene=n,this.startPoint=new Ee,this.endPoint=new Ee,this.collection=[],this.deep=r||Number.MAX_VALUE}select(e,n){return this.startPoint=e||this.startPoint,this.endPoint=n||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(Zs,this.scene),this.collection}updateFrustum(e,n){if(e=e||this.startPoint,n=n||this.endPoint,e.x===n.x&&(n.x+=Number.EPSILON),e.y===n.y&&(n.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){wr.copy(e),wr.x=Math.min(e.x,n.x),wr.y=Math.max(e.y,n.y),n.x=Math.max(e.x,n.x),n.y=Math.min(e.y,n.y),an.setFromMatrixPosition(this.camera.matrixWorld),An.copy(wr),dn.set(n.x,wr.y,0),kn.copy(n),On.set(wr.x,n.y,0),An.unproject(this.camera),dn.unproject(this.camera),kn.unproject(this.camera),On.unproject(this.camera),Ti.copy(An).sub(an),Si.copy(dn).sub(an),Ai.copy(kn).sub(an),Ti.normalize(),Si.normalize(),Ai.normalize(),Ti.multiplyScalar(this.deep),Si.multiplyScalar(this.deep),Ai.multiplyScalar(this.deep),Ti.add(an),Si.add(an),Ai.add(an);var r=Zs.planes;r[0].setFromCoplanarPoints(an,An,dn),r[1].setFromCoplanarPoints(an,dn,kn),r[2].setFromCoplanarPoints(kn,On,an),r[3].setFromCoplanarPoints(On,An,an),r[4].setFromCoplanarPoints(dn,kn,On),r[5].setFromCoplanarPoints(Ai,Si,Ti),r[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const i=Math.min(e.x,n.x),a=Math.max(e.y,n.y),o=Math.max(e.x,n.x),s=Math.min(e.y,n.y);An.set(i,a,-1),dn.set(o,a,-1),kn.set(o,s,-1),On.set(i,s,-1),wi.set(i,a,1),Ei.set(o,a,1),xi.set(o,s,1),Ba.set(i,s,1),An.unproject(this.camera),dn.unproject(this.camera),kn.unproject(this.camera),On.unproject(this.camera),wi.unproject(this.camera),Ei.unproject(this.camera),xi.unproject(this.camera),Ba.unproject(this.camera);var r=Zs.planes;r[0].setFromCoplanarPoints(An,wi,Ei),r[1].setFromCoplanarPoints(dn,Ei,xi),r[2].setFromCoplanarPoints(xi,Ba,On),r[3].setFromCoplanarPoints(Ba,wi,An),r[4].setFromCoplanarPoints(dn,kn,On),r[5].setFromCoplanarPoints(xi,Ei,wi),r[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,n){if((n.isMesh||n.isLine||n.isPoints)&&n.material!==void 0&&(n.geometry.boundingSphere===null&&n.geometry.computeBoundingSphere(),Qs.copy(n.geometry.boundingSphere.center),Qs.applyMatrix4(n.matrixWorld),e.containsPoint(Qs)&&this.collection.push(n)),n.children.length>0)for(let r=0;r<n.children.length;r++)this.searchChildInFrustum(e,n.children[r])}}class ji extends Zm{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,n,r,i){const a=this,o=new Qm(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(e,function(s){try{n(a.parse(s))}catch(l){i?i(l):console.error(l),a.manager.itemError(e)}},r,i)}parse(e){const n=this;function r(O,D){if(O.nodeType!==1)return;const T=y(O);let C=!0,j=null;switch(O.nodeName){case"svg":break;case"style":a(O);break;case"g":D=p(O,D);break;case"path":D=p(O,D),O.hasAttribute("d")&&(j=i(O));break;case"rect":D=p(O,D),j=l(O);break;case"polygon":D=p(O,D),j=u(O);break;case"polyline":D=p(O,D),j=c(O);break;case"circle":D=p(O,D),j=f(O);break;case"ellipse":D=p(O,D),j=d(O);break;case"line":D=p(O,D),j=h(O);break;case"defs":C=!1;break;case"mask":C=!1;break;case"use":D=p(O,D);const k=O.href.baseVal.substring(1),z=O.viewportElement.getElementById(k);z?r(z,D):console.warn("SVGLoader: 'use node' references non-existent node id: "+k);break}if(j&&(D.fill!==void 0&&D.fill!=="none"&&j.color.setStyle(D.fill),S(j,q),V.push(j),j.userData={node:O,style:D}),C){const k=O.childNodes;for(let z=0;z<k.length;z++)r(k[z],D)}T&&(P.pop(),P.length>0?q.copy(P[P.length-1]):q.identity())}function i(O){const D=new Jn,T=new De,C=new De,j=new De;let k=!0,z=!1;const Q=O.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi);for(let X=0,Y=Q.length;X<Y;X++){const ae=Q[X],te=ae.charAt(0),K=ae.substr(1).trim();k===!0&&(z=!0,k=!1);let U;switch(te){case"M":U=m(K);for(let M=0,Z=U.length;M<Z;M+=2)T.x=U[M+0],T.y=U[M+1],C.x=T.x,C.y=T.y,M===0?D.moveTo(T.x,T.y):D.lineTo(T.x,T.y),M===0&&j.copy(T);break;case"H":U=m(K);for(let M=0,Z=U.length;M<Z;M++)T.x=U[M],C.x=T.x,C.y=T.y,D.lineTo(T.x,T.y),M===0&&z===!0&&j.copy(T);break;case"V":U=m(K);for(let M=0,Z=U.length;M<Z;M++)T.y=U[M],C.x=T.x,C.y=T.y,D.lineTo(T.x,T.y),M===0&&z===!0&&j.copy(T);break;case"L":U=m(K);for(let M=0,Z=U.length;M<Z;M+=2)T.x=U[M+0],T.y=U[M+1],C.x=T.x,C.y=T.y,D.lineTo(T.x,T.y),M===0&&z===!0&&j.copy(T);break;case"C":U=m(K);for(let M=0,Z=U.length;M<Z;M+=6)D.bezierCurveTo(U[M+0],U[M+1],U[M+2],U[M+3],U[M+4],U[M+5]),C.x=U[M+2],C.y=U[M+3],T.x=U[M+4],T.y=U[M+5],M===0&&z===!0&&j.copy(T);break;case"S":U=m(K);for(let M=0,Z=U.length;M<Z;M+=4)D.bezierCurveTo(g(T.x,C.x),g(T.y,C.y),U[M+0],U[M+1],U[M+2],U[M+3]),C.x=U[M+0],C.y=U[M+1],T.x=U[M+2],T.y=U[M+3],M===0&&z===!0&&j.copy(T);break;case"Q":U=m(K);for(let M=0,Z=U.length;M<Z;M+=4)D.quadraticCurveTo(U[M+0],U[M+1],U[M+2],U[M+3]),C.x=U[M+0],C.y=U[M+1],T.x=U[M+2],T.y=U[M+3],M===0&&z===!0&&j.copy(T);break;case"T":U=m(K);for(let M=0,Z=U.length;M<Z;M+=2){const ie=g(T.x,C.x),oe=g(T.y,C.y);D.quadraticCurveTo(ie,oe,U[M+0],U[M+1]),C.x=ie,C.y=oe,T.x=U[M+0],T.y=U[M+1],M===0&&z===!0&&j.copy(T)}break;case"A":U=m(K,[3,4],7);for(let M=0,Z=U.length;M<Z;M+=7){if(U[M+5]==T.x&&U[M+6]==T.y)continue;const ie=T.clone();T.x=U[M+5],T.y=U[M+6],C.x=T.x,C.y=T.y,o(D,U[M],U[M+1],U[M+2],U[M+3],U[M+4],ie,T),M===0&&z===!0&&j.copy(T)}break;case"m":U=m(K);for(let M=0,Z=U.length;M<Z;M+=2)T.x+=U[M+0],T.y+=U[M+1],C.x=T.x,C.y=T.y,M===0?D.moveTo(T.x,T.y):D.lineTo(T.x,T.y),M===0&&j.copy(T);break;case"h":U=m(K);for(let M=0,Z=U.length;M<Z;M++)T.x+=U[M],C.x=T.x,C.y=T.y,D.lineTo(T.x,T.y),M===0&&z===!0&&j.copy(T);break;case"v":U=m(K);for(let M=0,Z=U.length;M<Z;M++)T.y+=U[M],C.x=T.x,C.y=T.y,D.lineTo(T.x,T.y),M===0&&z===!0&&j.copy(T);break;case"l":U=m(K);for(let M=0,Z=U.length;M<Z;M+=2)T.x+=U[M+0],T.y+=U[M+1],C.x=T.x,C.y=T.y,D.lineTo(T.x,T.y),M===0&&z===!0&&j.copy(T);break;case"c":U=m(K);for(let M=0,Z=U.length;M<Z;M+=6)D.bezierCurveTo(T.x+U[M+0],T.y+U[M+1],T.x+U[M+2],T.y+U[M+3],T.x+U[M+4],T.y+U[M+5]),C.x=T.x+U[M+2],C.y=T.y+U[M+3],T.x+=U[M+4],T.y+=U[M+5],M===0&&z===!0&&j.copy(T);break;case"s":U=m(K);for(let M=0,Z=U.length;M<Z;M+=4)D.bezierCurveTo(g(T.x,C.x),g(T.y,C.y),T.x+U[M+0],T.y+U[M+1],T.x+U[M+2],T.y+U[M+3]),C.x=T.x+U[M+0],C.y=T.y+U[M+1],T.x+=U[M+2],T.y+=U[M+3],M===0&&z===!0&&j.copy(T);break;case"q":U=m(K);for(let M=0,Z=U.length;M<Z;M+=4)D.quadraticCurveTo(T.x+U[M+0],T.y+U[M+1],T.x+U[M+2],T.y+U[M+3]),C.x=T.x+U[M+0],C.y=T.y+U[M+1],T.x+=U[M+2],T.y+=U[M+3],M===0&&z===!0&&j.copy(T);break;case"t":U=m(K);for(let M=0,Z=U.length;M<Z;M+=2){const ie=g(T.x,C.x),oe=g(T.y,C.y);D.quadraticCurveTo(ie,oe,T.x+U[M+0],T.y+U[M+1]),C.x=ie,C.y=oe,T.x=T.x+U[M+0],T.y=T.y+U[M+1],M===0&&z===!0&&j.copy(T)}break;case"a":U=m(K,[3,4],7);for(let M=0,Z=U.length;M<Z;M+=7){if(U[M+5]==0&&U[M+6]==0)continue;const ie=T.clone();T.x+=U[M+5],T.y+=U[M+6],C.x=T.x,C.y=T.y,o(D,U[M],U[M+1],U[M+2],U[M+3],U[M+4],ie,T),M===0&&z===!0&&j.copy(T)}break;case"Z":case"z":D.currentPath.autoClose=!0,D.currentPath.curves.length>0&&(T.copy(j),D.currentPath.currentPoint.copy(T),k=!0);break;default:console.warn(ae)}z=!1}return D}function a(O){if(!(!O.sheet||!O.sheet.cssRules||!O.sheet.cssRules.length))for(let D=0;D<O.sheet.cssRules.length;D++){const T=O.sheet.cssRules[D];if(T.type!==1)continue;const C=T.selectorText.split(/,/gm).filter(Boolean).map(j=>j.trim());for(let j=0;j<C.length;j++)F[C[j]]=Object.assign(F[C[j]]||{},T.style)}}function o(O,D,T,C,j,k,z,J){if(D==0||T==0){O.lineTo(J.x,J.y);return}C=C*Math.PI/180,D=Math.abs(D),T=Math.abs(T);const Q=(z.x-J.x)/2,X=(z.y-J.y)/2,Y=Math.cos(C)*Q+Math.sin(C)*X,ae=-Math.sin(C)*Q+Math.cos(C)*X;let te=D*D,K=T*T;const U=Y*Y,M=ae*ae,Z=U/te+M/K;if(Z>1){const me=Math.sqrt(Z);D=me*D,T=me*T,te=D*D,K=T*T}const ie=te*M+K*U,oe=(te*K-ie)/ie;let ne=Math.sqrt(Math.max(0,oe));j===k&&(ne=-ne);const de=ne*D*ae/T,ce=-ne*T*Y/D,pe=Math.cos(C)*de-Math.sin(C)*ce+(z.x+J.x)/2,fe=Math.sin(C)*de+Math.cos(C)*ce+(z.y+J.y)/2,Pe=s(1,0,(Y-de)/D,(ae-ce)/T),xe=s((Y-de)/D,(ae-ce)/T,(-Y-de)/D,(-ae-ce)/T)%(Math.PI*2);O.currentPath.absellipse(pe,fe,D,T,Pe,Pe+xe,k===0,C)}function s(O,D,T,C){const j=O*T+D*C,k=Math.sqrt(O*O+D*D)*Math.sqrt(T*T+C*C);let z=Math.acos(Math.max(-1,Math.min(1,j/k)));return O*C-D*T<0&&(z=-z),z}function l(O){const D=w(O.getAttribute("x")||0),T=w(O.getAttribute("y")||0),C=w(O.getAttribute("rx")||O.getAttribute("ry")||0),j=w(O.getAttribute("ry")||O.getAttribute("rx")||0),k=w(O.getAttribute("width")),z=w(O.getAttribute("height")),J=1-.551915024494,Q=new Jn;return Q.moveTo(D+C,T),Q.lineTo(D+k-C,T),(C!==0||j!==0)&&Q.bezierCurveTo(D+k-C*J,T,D+k,T+j*J,D+k,T+j),Q.lineTo(D+k,T+z-j),(C!==0||j!==0)&&Q.bezierCurveTo(D+k,T+z-j*J,D+k-C*J,T+z,D+k-C,T+z),Q.lineTo(D+C,T+z),(C!==0||j!==0)&&Q.bezierCurveTo(D+C*J,T+z,D,T+z-j*J,D,T+z-j),Q.lineTo(D,T+j),(C!==0||j!==0)&&Q.bezierCurveTo(D,T+j*J,D+C*J,T,D+C,T),Q}function u(O){function D(k,z,J){const Q=w(z),X=w(J);j===0?C.moveTo(Q,X):C.lineTo(Q,X),j++}const T=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,C=new Jn;let j=0;return O.getAttribute("points").replace(T,D),C.currentPath.autoClose=!0,C}function c(O){function D(k,z,J){const Q=w(z),X=w(J);j===0?C.moveTo(Q,X):C.lineTo(Q,X),j++}const T=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,C=new Jn;let j=0;return O.getAttribute("points").replace(T,D),C.currentPath.autoClose=!1,C}function f(O){const D=w(O.getAttribute("cx")||0),T=w(O.getAttribute("cy")||0),C=w(O.getAttribute("r")||0),j=new Cs;j.absarc(D,T,C,0,Math.PI*2);const k=new Jn;return k.subPaths.push(j),k}function d(O){const D=w(O.getAttribute("cx")||0),T=w(O.getAttribute("cy")||0),C=w(O.getAttribute("rx")||0),j=w(O.getAttribute("ry")||0),k=new Cs;k.absellipse(D,T,C,j,0,Math.PI*2);const z=new Jn;return z.subPaths.push(k),z}function h(O){const D=w(O.getAttribute("x1")||0),T=w(O.getAttribute("y1")||0),C=w(O.getAttribute("x2")||0),j=w(O.getAttribute("y2")||0),k=new Jn;return k.moveTo(D,T),k.lineTo(C,j),k.currentPath.autoClose=!1,k}function p(O,D){D=Object.assign({},D);let T={};if(O.hasAttribute("class")){const z=O.getAttribute("class").split(/\s/).filter(Boolean).map(J=>J.trim());for(let J=0;J<z.length;J++)T=Object.assign(T,F["."+z[J]])}O.hasAttribute("id")&&(T=Object.assign(T,F["#"+O.getAttribute("id")]));function C(z,J,Q){Q===void 0&&(Q=function(Y){return Y.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),Y}),O.hasAttribute(z)&&(D[J]=Q(O.getAttribute(z))),T[z]&&(D[J]=Q(T[z])),O.style&&O.style[z]!==""&&(D[J]=Q(O.style[z]))}function j(z){return Math.max(0,Math.min(1,w(z)))}function k(z){return Math.max(0,w(z))}return C("fill","fill"),C("fill-opacity","fillOpacity",j),C("fill-rule","fillRule"),C("opacity","opacity",j),C("stroke","stroke"),C("stroke-opacity","strokeOpacity",j),C("stroke-width","strokeWidth",k),C("stroke-linejoin","strokeLineJoin"),C("stroke-linecap","strokeLineCap"),C("stroke-miterlimit","strokeMiterLimit",k),C("visibility","visibility"),D}function g(O,D){return O-(D-O)}function m(O,D,T){if(typeof O!="string")throw new TypeError("Invalid input: "+typeof O);const C={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},j=0,k=1,z=2,J=3;let Q=j,X=!0,Y="",ae="";const te=[];function K(ie,oe,ne){const de=new SyntaxError('Unexpected character "'+ie+'" at index '+oe+".");throw de.partial=ne,de}function U(){Y!==""&&(ae===""?te.push(Number(Y)):te.push(Number(Y)*Math.pow(10,Number(ae)))),Y="",ae=""}let M;const Z=O.length;for(let ie=0;ie<Z;ie++){if(M=O[ie],Array.isArray(D)&&D.includes(te.length%T)&&C.FLAGS.test(M)){Q=k,Y=M,U();continue}if(Q===j){if(C.WHITESPACE.test(M))continue;if(C.DIGIT.test(M)||C.SIGN.test(M)){Q=k,Y=M;continue}if(C.POINT.test(M)){Q=z,Y=M;continue}C.COMMA.test(M)&&(X&&K(M,ie,te),X=!0)}if(Q===k){if(C.DIGIT.test(M)){Y+=M;continue}if(C.POINT.test(M)){Y+=M,Q=z;continue}if(C.EXP.test(M)){Q=J;continue}C.SIGN.test(M)&&Y.length===1&&C.SIGN.test(Y[0])&&K(M,ie,te)}if(Q===z){if(C.DIGIT.test(M)){Y+=M;continue}if(C.EXP.test(M)){Q=J;continue}C.POINT.test(M)&&Y[Y.length-1]==="."&&K(M,ie,te)}if(Q===J){if(C.DIGIT.test(M)){ae+=M;continue}if(C.SIGN.test(M)){if(ae===""){ae+=M;continue}ae.length===1&&C.SIGN.test(ae)&&K(M,ie,te)}}C.WHITESPACE.test(M)?(U(),Q=j,X=!1):C.COMMA.test(M)?(U(),Q=j,X=!0):C.SIGN.test(M)?(U(),Q=k,Y=M):C.POINT.test(M)?(U(),Q=z,Y=M):K(M,ie,te)}return U(),te}const v=["mm","cm","in","pt","pc","px"],_={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function w(O){let D="px";if(typeof O=="string"||O instanceof String)for(let C=0,j=v.length;C<j;C++){const k=v[C];if(O.endsWith(k)){D=k,O=O.substring(0,O.length-k.length);break}}let T;return D==="px"&&n.defaultUnit!=="px"?T=_.in[n.defaultUnit]/n.defaultDPI:(T=_[D][n.defaultUnit],T<0&&(T=_[D].in*n.defaultDPI)),T*parseFloat(O)}function y(O){if(!(O.hasAttribute("transform")||O.nodeName==="use"&&(O.hasAttribute("x")||O.hasAttribute("y"))))return null;const D=b(O);return P.length>0&&D.premultiply(P[P.length-1]),q.copy(D),P.push(D),D}function b(O){const D=new ir,T=N;if(O.nodeName==="use"&&(O.hasAttribute("x")||O.hasAttribute("y"))){const C=w(O.getAttribute("x")),j=w(O.getAttribute("y"));D.translate(C,j)}if(O.hasAttribute("transform")){const C=O.getAttribute("transform").split(")");for(let j=C.length-1;j>=0;j--){const k=C[j].trim();if(k==="")continue;const z=k.indexOf("("),J=k.length;if(z>0&&z<J){const Q=k.substr(0,z),X=m(k.substr(z+1,J-z-1));switch(T.identity(),Q){case"translate":if(X.length>=1){const Y=X[0];let ae=Y;X.length>=2&&(ae=X[1]),T.translate(Y,ae)}break;case"rotate":if(X.length>=1){let Y=0,ae=0,te=0;Y=-X[0]*Math.PI/180,X.length>=3&&(ae=X[1],te=X[2]),W.identity().translate(-ae,-te),H.identity().rotate(Y),L.multiplyMatrices(H,W),W.identity().translate(ae,te),T.multiplyMatrices(W,L)}break;case"scale":if(X.length>=1){const Y=X[0];let ae=Y;X.length>=2&&(ae=X[1]),T.scale(Y,ae)}break;case"skewX":X.length===1&&T.set(1,Math.tan(X[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":X.length===1&&T.set(1,0,0,Math.tan(X[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":X.length===6&&T.set(X[0],X[2],X[4],X[1],X[3],X[5],0,0,1);break}}D.premultiply(T)}}return D}function S(O,D){function T(k){B.set(k.x,k.y,1).applyMatrix3(D),k.set(B.x,B.y)}const C=E(D),j=O.subPaths;for(let k=0,z=j.length;k<z;k++){const Q=j[k].curves;for(let X=0;X<Q.length;X++){const Y=Q[X];Y.isLineCurve?(T(Y.v1),T(Y.v2)):Y.isCubicBezierCurve?(T(Y.v0),T(Y.v1),T(Y.v2),T(Y.v3)):Y.isQuadraticBezierCurve?(T(Y.v0),T(Y.v1),T(Y.v2)):Y.isEllipseCurve&&(C&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),G.set(Y.aX,Y.aY),T(G),Y.aX=G.x,Y.aY=G.y,Y.xRadius*=x(D),Y.yRadius*=A(D))}}}function E(O){return O.elements[1]!==0||O.elements[3]!==0}function x(O){const D=O.elements;return Math.sqrt(D[0]*D[0]+D[1]*D[1])}function A(O){const D=O.elements;return Math.sqrt(D[3]*D[3]+D[4]*D[4])}const V=[],F={},P=[],N=new ir,W=new ir,H=new ir,L=new ir,G=new De,B=new Ee,q=new ir,$=new DOMParser().parseFromString(e,"image/svg+xml");return r($.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:V,xml:$.documentElement}}static createShapes(e){const r={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},i={loc:r.ORIGIN,t:0};function a(m,v,_,w){const y=m.x,b=v.x,S=_.x,E=w.x,x=m.y,A=v.y,V=_.y,F=w.y,P=(E-S)*(x-V)-(F-V)*(y-S),N=(b-y)*(x-V)-(A-x)*(y-S),W=(F-V)*(b-y)-(E-S)*(A-x),H=P/W,L=N/W;if(W===0&&P!==0||H<=0||H>=1||L<0||L>1)return null;if(P===0&&W===0){for(let G=0;G<2;G++)if(o(G===0?_:w,m,v),i.loc==r.ORIGIN){const B=G===0?_:w;return{x:B.x,y:B.y,t:i.t}}else if(i.loc==r.BETWEEN){const B=+(y+i.t*(b-y)).toPrecision(10),q=+(x+i.t*(A-x)).toPrecision(10);return{x:B,y:q,t:i.t}}return null}else{for(let q=0;q<2;q++)if(o(q===0?_:w,m,v),i.loc==r.ORIGIN){const $=q===0?_:w;return{x:$.x,y:$.y,t:i.t}}const G=+(y+H*(b-y)).toPrecision(10),B=+(x+H*(A-x)).toPrecision(10);return{x:G,y:B,t:H}}}function o(m,v,_){const w=_.x-v.x,y=_.y-v.y,b=m.x-v.x,S=m.y-v.y,E=w*S-b*y;if(m.x===v.x&&m.y===v.y){i.loc=r.ORIGIN,i.t=0;return}if(m.x===_.x&&m.y===_.y){i.loc=r.DESTINATION,i.t=1;return}if(E<-Number.EPSILON){i.loc=r.LEFT;return}if(E>Number.EPSILON){i.loc=r.RIGHT;return}if(w*b<0||y*S<0){i.loc=r.BEHIND;return}if(Math.sqrt(w*w+y*y)<Math.sqrt(b*b+S*S)){i.loc=r.BEYOND;return}let x;w!==0?x=b/w:x=S/y,i.loc=r.BETWEEN,i.t=x}function s(m,v){const _=[],w=[];for(let y=1;y<m.length;y++){const b=m[y-1],S=m[y];for(let E=1;E<v.length;E++){const x=v[E-1],A=v[E],V=a(b,S,x,A);V!==null&&_.find(F=>F.t<=V.t+Number.EPSILON&&F.t>=V.t-Number.EPSILON)===void 0&&(_.push(V),w.push(new De(V.x,V.y)))}}return w}function l(m,v,_){const w=new De;v.getCenter(w);const y=[];return _.forEach(b=>{b.boundingBox.containsPoint(w)&&s(m,b.points).forEach(E=>{y.push({identifier:b.identifier,isCW:b.isCW,point:E})})}),y.sort((b,S)=>b.point.x-S.point.x),y}function u(m,v,_,w,y){(y==null||y==="")&&(y="nonzero");const b=new De;m.boundingBox.getCenter(b);const S=[new De(_,b.y),new De(w,b.y)],E=l(S,m.boundingBox,v);E.sort((N,W)=>N.point.x-W.point.x);const x=[],A=[];E.forEach(N=>{N.identifier===m.identifier?x.push(N):A.push(N)});const V=x[0].point.x,F=[];let P=0;for(;P<A.length&&A[P].point.x<V;)F.length>0&&F[F.length-1]===A[P].identifier?F.pop():F.push(A[P].identifier),P++;if(F.push(m.identifier),y==="evenodd"){const N=F.length%2===0,W=F[F.length-2];return{identifier:m.identifier,isHole:N,for:W}}else if(y==="nonzero"){let N=!0,W=null,H=null;for(let L=0;L<F.length;L++){const G=F[L];N?(H=v[G].isCW,N=!1,W=G):H!==v[G].isCW&&(H=v[G].isCW,N=!0)}return{identifier:m.identifier,isHole:N,for:W}}else console.warn('fill-rule: "'+y+'" is currently not implemented.')}let c=0,f=999999999,d=-999999999,h=e.subPaths.map(m=>{const v=m.getPoints();let _=-999999999,w=999999999,y=-999999999,b=999999999;for(let S=0;S<v.length;S++){const E=v[S];E.y>_&&(_=E.y),E.y<w&&(w=E.y),E.x>y&&(y=E.x),E.x<b&&(b=E.x)}return d<=y&&(d=y+1),f>=b&&(f=b-1),{curves:m.curves,points:v,isCW:Jm.isClockWise(v),identifier:c++,boundingBox:new eg(new De(b,w),new De(y,_))}});h=h.filter(m=>m.points.length>1);const p=h.map(m=>u(m,h,f,d,e.userData.style.fillRule)),g=[];return h.forEach(m=>{if(!p[m.identifier].isHole){const _=new tg;_.curves=m.curves,p.filter(y=>y.isHole&&y.for===m.identifier).forEach(y=>{const b=h[y.identifier],S=new Cs;S.curves=b.curves,_.holes.push(S)}),g.push(_)}}),g}static getStrokeStyle(e,n,r,i,a){return e=e!==void 0?e:1,n=n!==void 0?n:"#000",r=r!==void 0?r:"miter",i=i!==void 0?i:"butt",a=a!==void 0?a:4,{strokeColor:n,strokeWidth:e,strokeLineJoin:r,strokeLineCap:i,strokeMiterLimit:a}}static pointsToStroke(e,n,r,i){const a=[],o=[],s=[];if(ji.pointsToStrokeWithBuffers(e,n,r,i,a,o,s)===0)return null;const l=new Yl;return l.setAttribute("position",new Qa(a,3)),l.setAttribute("normal",new Qa(o,3)),l.setAttribute("uv",new Qa(s,2)),l}static pointsToStrokeWithBuffers(e,n,r,i,a,o,s,l){const u=new De,c=new De,f=new De,d=new De,h=new De,p=new De,g=new De,m=new De,v=new De,_=new De,w=new De,y=new De,b=new De,S=new De,E=new De,x=new De,A=new De;r=r!==void 0?r:12,i=i!==void 0?i:.001,l=l!==void 0?l:0,e=ae(e);const V=e.length;if(V<2)return 0;const F=e[0].equals(e[V-1]);let P,N=e[0],W;const H=n.strokeWidth/2,L=1/(V-1);let G=0,B,q,$,R,O=!1,D=0,T=l*3,C=l*2;j(e[0],e[1],u).multiplyScalar(H),m.copy(e[0]).sub(u),v.copy(e[0]).add(u),_.copy(m),w.copy(v);for(let te=1;te<V;te++){P=e[te],te===V-1?F?W=e[1]:W=void 0:W=e[te+1];const K=u;if(j(N,P,K),f.copy(K).multiplyScalar(H),y.copy(P).sub(f),b.copy(P).add(f),B=G+L,q=!1,W!==void 0){j(P,W,c),f.copy(c).multiplyScalar(H),S.copy(P).sub(f),E.copy(P).add(f),$=!0,f.subVectors(W,N),K.dot(f)<0&&($=!1),te===1&&(O=$),f.subVectors(W,P),f.normalize();const U=Math.abs(K.dot(f));if(U!==0){const M=H/U;f.multiplyScalar(-M),d.subVectors(P,N),h.copy(d).setLength(M).add(f),x.copy(h).negate();const Z=h.length(),ie=d.length();d.divideScalar(ie),p.subVectors(W,P);const oe=p.length();switch(p.divideScalar(oe),d.dot(x)<ie&&p.dot(x)<oe&&(q=!0),A.copy(h).add(P),x.add(P),R=!1,q?$?(E.copy(x),b.copy(x)):(S.copy(x),y.copy(x)):J(),n.strokeLineJoin){case"bevel":Q($,q,B);break;case"round":X($,q),$?z(P,y,S,B,0):z(P,E,b,B,1);break;case"miter":case"miter-clip":default:const ne=H*n.strokeMiterLimit/Z;if(ne<1)if(n.strokeLineJoin!=="miter-clip"){Q($,q,B);break}else X($,q),$?(p.subVectors(A,y).multiplyScalar(ne).add(y),g.subVectors(A,S).multiplyScalar(ne).add(S),k(y,B,0),k(p,B,0),k(P,B,.5),k(P,B,.5),k(p,B,0),k(g,B,0),k(P,B,.5),k(g,B,0),k(S,B,0)):(p.subVectors(A,b).multiplyScalar(ne).add(b),g.subVectors(A,E).multiplyScalar(ne).add(E),k(b,B,1),k(p,B,1),k(P,B,.5),k(P,B,.5),k(p,B,1),k(g,B,1),k(P,B,.5),k(g,B,1),k(E,B,1));else q?($?(k(v,G,1),k(m,G,0),k(A,B,0),k(v,G,1),k(A,B,0),k(x,B,1)):(k(v,G,1),k(m,G,0),k(A,B,1),k(m,G,0),k(x,B,0),k(A,B,1)),$?S.copy(A):E.copy(A)):$?(k(y,B,0),k(A,B,0),k(P,B,.5),k(P,B,.5),k(A,B,0),k(S,B,0)):(k(b,B,1),k(A,B,1),k(P,B,.5),k(P,B,.5),k(A,B,1),k(E,B,1)),R=!0;break}}else J()}else J();!F&&te===V-1&&Y(e[0],_,w,$,!0,G),G=B,N=P,m.copy(S),v.copy(E)}if(!F)Y(P,y,b,$,!1,B);else if(q&&a){let te=A,K=x;O!==$&&(te=x,K=A),$?(R||O)&&(K.toArray(a,0*3),K.toArray(a,3*3),R&&te.toArray(a,1*3)):(R||!O)&&(K.toArray(a,1*3),K.toArray(a,3*3),R&&te.toArray(a,0*3))}return D;function j(te,K,U){return U.subVectors(K,te),U.set(-U.y,U.x).normalize()}function k(te,K,U){a&&(a[T]=te.x,a[T+1]=te.y,a[T+2]=0,o&&(o[T]=0,o[T+1]=0,o[T+2]=1),T+=3,s&&(s[C]=K,s[C+1]=U,C+=2)),D+=3}function z(te,K,U,M,Z){u.copy(K).sub(te).normalize(),c.copy(U).sub(te).normalize();let ie=Math.PI;const oe=u.dot(c);Math.abs(oe)<1&&(ie=Math.abs(Math.acos(oe))),ie/=r,f.copy(K);for(let ne=0,de=r-1;ne<de;ne++)d.copy(f).rotateAround(te,ie),k(f,M,Z),k(d,M,Z),k(te,M,.5),f.copy(d);k(d,M,Z),k(U,M,Z),k(te,M,.5)}function J(){k(v,G,1),k(m,G,0),k(y,B,0),k(v,G,1),k(y,B,1),k(b,B,0)}function Q(te,K,U){K?te?(k(v,G,1),k(m,G,0),k(y,B,0),k(v,G,1),k(y,B,0),k(x,B,1),k(y,U,0),k(S,U,0),k(x,U,.5)):(k(v,G,1),k(m,G,0),k(b,B,1),k(m,G,0),k(x,B,0),k(b,B,1),k(b,U,1),k(E,U,0),k(x,U,.5)):te?(k(y,U,0),k(S,U,0),k(P,U,.5)):(k(b,U,1),k(E,U,0),k(P,U,.5))}function X(te,K){K&&(te?(k(v,G,1),k(m,G,0),k(y,B,0),k(v,G,1),k(y,B,0),k(x,B,1),k(y,G,0),k(P,B,.5),k(x,B,1),k(P,B,.5),k(S,G,0),k(x,B,1)):(k(v,G,1),k(m,G,0),k(b,B,1),k(m,G,0),k(x,B,0),k(b,B,1),k(b,G,1),k(x,B,0),k(P,B,.5),k(P,B,.5),k(x,B,0),k(E,G,1)))}function Y(te,K,U,M,Z,ie){switch(n.strokeLineCap){case"round":Z?z(te,U,K,ie,.5):z(te,K,U,ie,.5);break;case"square":if(Z)u.subVectors(K,te),c.set(u.y,-u.x),f.addVectors(u,c).add(te),d.subVectors(c,u).add(te),M?(f.toArray(a,1*3),d.toArray(a,0*3),d.toArray(a,3*3)):(f.toArray(a,1*3),f.toArray(a,3*3),d.toArray(a,0*3));else{u.subVectors(U,te),c.set(u.y,-u.x),f.addVectors(u,c).add(te),d.subVectors(c,u).add(te);const oe=a.length;M?(f.toArray(a,oe-1*3),d.toArray(a,oe-2*3),d.toArray(a,oe-4*3)):(f.toArray(a,oe-2*3),d.toArray(a,oe-1*3),d.toArray(a,oe-4*3))}break}}function ae(te){let K=!1;for(let M=1,Z=te.length-1;M<Z;M++)if(te[M].distanceTo(te[M+1])<i){K=!0;break}if(!K)return te;const U=[];U.push(te[0]);for(let M=1,Z=te.length-1;M<Z;M++)te[M].distanceTo(te[M+1])>=i&&U.push(te[M]);return U.push(te[te.length-1]),U}}}const Yu=I.forwardRef(function({follow:e=!0,lockX:n=!1,lockY:r=!1,lockZ:i=!1,...a},o){const s=I.useRef();return zo(({camera:l})=>{if(!e||!s.current)return;const u=s.current.rotation.clone();l.getWorldQuaternion(s.current.quaternion),n&&(s.current.rotation.x=u.x),r&&(s.current.rotation.y=u.y),i&&(s.current.rotation.z=u.z)}),I.createElement("group",yn({ref:wE([s,o])},a))});function Ux(){var t=Object.create(null);function e(i,a){var o=i.id,s=i.name,l=i.dependencies;l===void 0&&(l=[]);var u=i.init;u===void 0&&(u=function(){});var c=i.getTransferables;if(c===void 0&&(c=null),!t[o])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(h){if(h instanceof Error)throw h}),d=t[d.id].value),d}),u=r("<"+s+">.init",u),c&&(c=r("<"+s+">.getTransferables",c));var f=null;typeof u=="function"?f=u.apply(void 0,l):console.error("worker module init function failed to rehydrate"),t[o]={id:o,value:f,getTransferables:c},a(f)}catch(d){d&&d.noLog||console.error(d),a(d)}}function n(i,a){var o,s=i.id,l=i.args;(!t[s]||typeof t[s].value!="function")&&a(new Error("Worker module "+s+": not found or its 'init' did not return a function"));try{var u=(o=t[s]).value.apply(o,l);u&&typeof u.then=="function"?u.then(c,function(f){return a(f instanceof Error?f:new Error(""+f))}):c(u)}catch(f){a(f)}function c(f){try{var d=t[s].getTransferables&&t[s].getTransferables(f);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),a(f,d)}catch(h){console.error(h),a(h)}}}function r(i,a){var o=void 0;self.troikaDefine=function(l){return o=l};var s=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+a+`
)`],{type:"application/javascript"}));try{importScripts(s)}catch(l){console.error(l)}return URL.revokeObjectURL(s),delete self.troikaDefine,o}self.addEventListener("message",function(i){var a=i.data,o=a.messageId,s=a.action,l=a.data;try{s==="registerModule"&&e(l,function(u){u instanceof Error?postMessage({messageId:o,success:!1,error:u.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof u=="function"}})}),s==="callModule"&&n(l,function(u,c){u instanceof Error?postMessage({messageId:o,success:!1,error:u.message}):postMessage({messageId:o,success:!0,result:u},c||void 0)})}catch(u){postMessage({messageId:o,success:!1,error:u.stack})}})}function Vx(t){var e=function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,n);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var n=t.dependencies,r=t.init;n=Array.isArray(n)?n.map(function(a){return a&&a._getInitResult?a._getInitResult():a}):[];var i=Promise.all(n).then(function(a){return r.apply(null,a)});return e._getInitResult=function(){return i},i},e}var fm=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(n){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+n.message+"]")}return fm=function(){return t},t},Fx=0,Gx=0,Js=!1,zi=Object.create(null),qi=Object.create(null),Ul=Object.create(null);function ba(t){if((!t||typeof t.init!="function")&&!Js)throw new Error("requires `options.init` function");var e=t.dependencies,n=t.init,r=t.getTransferables,i=t.workerId;if(!fm())return Vx(t);i==null&&(i="#default");var a="workerModule"+ ++Fx,o=t.name||a,s=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(Js=!0,u=ba({workerId:i,name:"<"+o+"> function dependency: "+u.name,init:`function(){return (
`+io(u)+`
)}`}),Js=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function l(){for(var u=[],c=arguments.length;c--;)u[c]=arguments[c];if(!s){s=ed(i,"registerModule",l.workerModuleData);var f=function(){s=null,qi[i].delete(f)};(qi[i]||(qi[i]=new Set)).add(f)}return s.then(function(d){var h=d.isCallable;if(h)return ed(i,"callModule",{id:a,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return l.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:e,init:io(n),getTransferables:r&&io(r)},l}function Nx(t){qi[t]&&qi[t].forEach(function(e){e()}),zi[t]&&(zi[t].terminate(),delete zi[t])}function io(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function jx(t){var e=zi[t];if(!e){var n=io(Ux);e=zi[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+n+")()"],{type:"application/javascript"}))),e.onmessage=function(r){var i=r.data,a=i.messageId,o=Ul[a];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete Ul[a],o(i)}}return e}function ed(t,e,n){return new Promise(function(r,i){var a=++Gx;Ul[a]=function(o){o.success?r(o.result):i(new Error("Error in worker "+e+" call: "+o.error))},jx(t).postMessage({messageId:a,action:e,data:n})})}function dm(){var t=function(e){function n(q,$,R,O,D,T,C,j){var k=1-C;j.x=k*k*q+2*k*C*R+C*C*D,j.y=k*k*$+2*k*C*O+C*C*T}function r(q,$,R,O,D,T,C,j,k,z){var J=1-k;z.x=J*J*J*q+3*J*J*k*R+3*J*k*k*D+k*k*k*C,z.y=J*J*J*$+3*J*J*k*O+3*J*k*k*T+k*k*k*j}function i(q,$){for(var R=/([MLQCZ])([^MLQCZ]*)/g,O,D,T,C,j;O=R.exec(q);){var k=O[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(z){return parseFloat(z)});switch(O[1]){case"M":C=D=k[0],j=T=k[1];break;case"L":(k[0]!==C||k[1]!==j)&&$("L",C,j,C=k[0],j=k[1]);break;case"Q":{$("Q",C,j,C=k[2],j=k[3],k[0],k[1]);break}case"C":{$("C",C,j,C=k[4],j=k[5],k[0],k[1],k[2],k[3]);break}case"Z":(C!==D||j!==T)&&$("L",C,j,D,T);break}}}function a(q,$,R){R===void 0&&(R=16);var O={x:0,y:0};i(q,function(D,T,C,j,k,z,J,Q,X){switch(D){case"L":$(T,C,j,k);break;case"Q":{for(var Y=T,ae=C,te=1;te<R;te++)n(T,C,z,J,j,k,te/(R-1),O),$(Y,ae,O.x,O.y),Y=O.x,ae=O.y;break}case"C":{for(var K=T,U=C,M=1;M<R;M++)r(T,C,z,J,Q,X,j,k,M/(R-1),O),$(K,U,O.x,O.y),K=O.x,U=O.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",s="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,u={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function c(q,$){var R=q.getContext?q.getContext("webgl",u):q,O=l.get(R);if(!O){let J=function(K){var U=T[K];if(!U&&(U=T[K]=R.getExtension(K),!U))throw new Error(K+" not supported");return U},Q=function(K,U){var M=R.createShader(U);return R.shaderSource(M,K),R.compileShader(M),M},X=function(K,U,M,Z){if(!C[K]){var ie={},oe={},ne=R.createProgram();R.attachShader(ne,Q(U,R.VERTEX_SHADER)),R.attachShader(ne,Q(M,R.FRAGMENT_SHADER)),R.linkProgram(ne),C[K]={program:ne,transaction:function(ce){R.useProgram(ne),ce({setUniform:function(fe,Pe){for(var xe=[],me=arguments.length-2;me-- >0;)xe[me]=arguments[me+2];var Ae=oe[Pe]||(oe[Pe]=R.getUniformLocation(ne,Pe));R["uniform"+fe].apply(R,[Ae].concat(xe))},setAttribute:function(fe,Pe,xe,me,Ae){var Re=ie[fe];Re||(Re=ie[fe]={buf:R.createBuffer(),loc:R.getAttribLocation(ne,fe),data:null}),R.bindBuffer(R.ARRAY_BUFFER,Re.buf),R.vertexAttribPointer(Re.loc,Pe,R.FLOAT,!1,0,0),R.enableVertexAttribArray(Re.loc),D?R.vertexAttribDivisor(Re.loc,me):J("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Re.loc,me),Ae!==Re.data&&(R.bufferData(R.ARRAY_BUFFER,Ae,xe),Re.data=Ae)}})}}}C[K].transaction(Z)},Y=function(K,U){k++;try{R.activeTexture(R.TEXTURE0+k);var M=j[K];M||(M=j[K]=R.createTexture(),R.bindTexture(R.TEXTURE_2D,M),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.NEAREST),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.NEAREST)),R.bindTexture(R.TEXTURE_2D,M),U(M,k)}finally{k--}},ae=function(K,U,M){var Z=R.createFramebuffer();z.push(Z),R.bindFramebuffer(R.FRAMEBUFFER,Z),R.activeTexture(R.TEXTURE0+U),R.bindTexture(R.TEXTURE_2D,K),R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_2D,K,0);try{M(Z)}finally{R.deleteFramebuffer(Z),R.bindFramebuffer(R.FRAMEBUFFER,z[--z.length-1]||null)}},te=function(){T={},C={},j={},k=-1,z.length=0};var D=typeof WebGL2RenderingContext<"u"&&R instanceof WebGL2RenderingContext,T={},C={},j={},k=-1,z=[];R.canvas.addEventListener("webglcontextlost",function(K){te(),K.preventDefault()},!1),l.set(R,O={gl:R,isWebGL2:D,getExtension:J,withProgram:X,withTexture:Y,withTextureFramebuffer:ae,handleContextLoss:te})}$(O)}function f(q,$,R,O,D,T,C,j){C===void 0&&(C=15),j===void 0&&(j=null),c(q,function(k){var z=k.gl,J=k.withProgram,Q=k.withTexture;Q("copy",function(X,Y){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,D,T,0,z.RGBA,z.UNSIGNED_BYTE,$),J("copy",o,s,function(ae){var te=ae.setUniform,K=ae.setAttribute;K("aUV",2,z.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),te("1i","image",Y),z.bindFramebuffer(z.FRAMEBUFFER,j||null),z.disable(z.BLEND),z.colorMask(C&8,C&4,C&2,C&1),z.viewport(R,O,D,T),z.scissor(R,O,D,T),z.drawArrays(z.TRIANGLES,0,3)})})})}function d(q,$,R){var O=q.width,D=q.height;c(q,function(T){var C=T.gl,j=new Uint8Array(O*D*4);C.readPixels(0,0,O,D,C.RGBA,C.UNSIGNED_BYTE,j),q.width=$,q.height=R,f(C,j,0,0,O,D)})}var h=Object.freeze({__proto__:null,withWebGLContext:c,renderImageData:f,resizeWebGLCanvasWithoutClearing:d});function p(q,$,R,O,D,T){T===void 0&&(T=1);var C=new Uint8Array(q*$),j=O[2]-O[0],k=O[3]-O[1],z=[];a(R,function(K,U,M,Z){z.push({x1:K,y1:U,x2:M,y2:Z,minX:Math.min(K,M),minY:Math.min(U,Z),maxX:Math.max(K,M),maxY:Math.max(U,Z)})}),z.sort(function(K,U){return K.maxX-U.maxX});for(var J=0;J<q;J++)for(var Q=0;Q<$;Q++){var X=ae(O[0]+j*(J+.5)/q,O[1]+k*(Q+.5)/$),Y=Math.pow(1-Math.abs(X)/D,T)/2;X<0&&(Y=1-Y),Y=Math.max(0,Math.min(255,Math.round(Y*255))),C[Q*q+J]=Y}return C;function ae(K,U){for(var M=1/0,Z=1/0,ie=z.length;ie--;){var oe=z[ie];if(oe.maxX+Z<=K)break;if(K+Z>oe.minX&&U-Z<oe.maxY&&U+Z>oe.minY){var ne=v(K,U,oe.x1,oe.y1,oe.x2,oe.y2);ne<M&&(M=ne,Z=Math.sqrt(M))}}return te(K,U)&&(Z=-Z),Z}function te(K,U){for(var M=0,Z=z.length;Z--;){var ie=z[Z];if(ie.maxX<=K)break;var oe=ie.y1>U!=ie.y2>U&&K<(ie.x2-ie.x1)*(U-ie.y1)/(ie.y2-ie.y1)+ie.x1;oe&&(M+=ie.y1<ie.y2?1:-1)}return M!==0}}function g(q,$,R,O,D,T,C,j,k,z){T===void 0&&(T=1),j===void 0&&(j=0),k===void 0&&(k=0),z===void 0&&(z=0),m(q,$,R,O,D,T,C,null,j,k,z)}function m(q,$,R,O,D,T,C,j,k,z,J){T===void 0&&(T=1),k===void 0&&(k=0),z===void 0&&(z=0),J===void 0&&(J=0);for(var Q=p(q,$,R,O,D,T),X=new Uint8Array(Q.length*4),Y=0;Y<Q.length;Y++)X[Y*4+J]=Q[Y];f(C,X,k,z,q,$,1<<3-J,j)}function v(q,$,R,O,D,T){var C=D-R,j=T-O,k=C*C+j*j,z=k?Math.max(0,Math.min(1,((q-R)*C+($-O)*j)/k)):0,J=q-(R+z*C),Q=$-(O+z*j);return J*J+Q*Q}var _=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:g,generateIntoFramebuffer:m}),w="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",y="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",b="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",S=new Float32Array([0,0,2,0,0,2]),E=null,x=!1,A={},V=new WeakMap;function F(q){if(!x&&!H(q))throw new Error("WebGL generation not supported")}function P(q,$,R,O,D,T,C){if(T===void 0&&(T=1),C===void 0&&(C=null),!C&&(C=E,!C)){var j=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!j)throw new Error("OffscreenCanvas or DOM canvas not supported");C=E=j.getContext("webgl",{depth:!1})}F(C);var k=new Uint8Array(q*$*4);c(C,function(X){var Y=X.gl,ae=X.withTexture,te=X.withTextureFramebuffer;ae("readable",function(K,U){Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,q,$,0,Y.RGBA,Y.UNSIGNED_BYTE,null),te(K,U,function(M){W(q,$,R,O,D,T,Y,M,0,0,0),Y.readPixels(0,0,q,$,Y.RGBA,Y.UNSIGNED_BYTE,k)})})});for(var z=new Uint8Array(q*$),J=0,Q=0;J<k.length;J+=4)z[Q++]=k[J];return z}function N(q,$,R,O,D,T,C,j,k,z){T===void 0&&(T=1),j===void 0&&(j=0),k===void 0&&(k=0),z===void 0&&(z=0),W(q,$,R,O,D,T,C,null,j,k,z)}function W(q,$,R,O,D,T,C,j,k,z,J){T===void 0&&(T=1),k===void 0&&(k=0),z===void 0&&(z=0),J===void 0&&(J=0),F(C);var Q=[];a(R,function(X,Y,ae,te){Q.push(X,Y,ae,te)}),Q=new Float32Array(Q),c(C,function(X){var Y=X.gl,ae=X.isWebGL2,te=X.getExtension,K=X.withProgram,U=X.withTexture,M=X.withTextureFramebuffer,Z=X.handleContextLoss;if(U("rawDistances",function(ie,oe){(q!==ie._lastWidth||$!==ie._lastHeight)&&Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,ie._lastWidth=q,ie._lastHeight=$,0,Y.RGBA,Y.UNSIGNED_BYTE,null),K("main",w,y,function(ne){var de=ne.setAttribute,ce=ne.setUniform,pe=!ae&&te("ANGLE_instanced_arrays"),fe=!ae&&te("EXT_blend_minmax");de("aUV",2,Y.STATIC_DRAW,0,S),de("aLineSegment",4,Y.DYNAMIC_DRAW,1,Q),ce.apply(void 0,["4f","uGlyphBounds"].concat(O)),ce("1f","uMaxDistance",D),ce("1f","uExponent",T),M(ie,oe,function(Pe){Y.enable(Y.BLEND),Y.colorMask(!0,!0,!0,!0),Y.viewport(0,0,q,$),Y.scissor(0,0,q,$),Y.blendFunc(Y.ONE,Y.ONE),Y.blendEquationSeparate(Y.FUNC_ADD,ae?Y.MAX:fe.MAX_EXT),Y.clear(Y.COLOR_BUFFER_BIT),ae?Y.drawArraysInstanced(Y.TRIANGLES,0,3,Q.length/4):pe.drawArraysInstancedANGLE(Y.TRIANGLES,0,3,Q.length/4)})}),K("post",o,b,function(ne){ne.setAttribute("aUV",2,Y.STATIC_DRAW,0,S),ne.setUniform("1i","tex",oe),Y.bindFramebuffer(Y.FRAMEBUFFER,j),Y.disable(Y.BLEND),Y.colorMask(J===0,J===1,J===2,J===3),Y.viewport(k,z,q,$),Y.scissor(k,z,q,$),Y.drawArrays(Y.TRIANGLES,0,3)})}),Y.isContextLost())throw Z(),new Error("webgl context lost")})}function H(q){var $=!q||q===E?A:q.canvas||q,R=V.get($);if(R===void 0){x=!0;var O=null;try{var D=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],T=P(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,q);R=T&&D.length===T.length&&T.every(function(C,j){return C===D[j]}),R||(O="bad trial run results",console.info(D,T))}catch(C){R=!1,O=C.message}O&&console.warn("WebGL SDF generation not supported:",O),x=!1,V.set($,R)}return R}var L=Object.freeze({__proto__:null,generate:P,generateIntoCanvas:N,generateIntoFramebuffer:W,isSupported:H});function G(q,$,R,O,D,T){D===void 0&&(D=Math.max(O[2]-O[0],O[3]-O[1])/2),T===void 0&&(T=1);try{return P.apply(L,arguments)}catch(C){return console.info("WebGL SDF generation failed, falling back to JS",C),p.apply(_,arguments)}}function B(q,$,R,O,D,T,C,j,k,z){D===void 0&&(D=Math.max(O[2]-O[0],O[3]-O[1])/2),T===void 0&&(T=1),j===void 0&&(j=0),k===void 0&&(k=0),z===void 0&&(z=0);try{return N.apply(L,arguments)}catch(J){return console.info("WebGL SDF generation failed, falling back to JS",J),g.apply(_,arguments)}}return e.forEachPathCommand=i,e.generate=G,e.generateIntoCanvas=B,e.javascript=_,e.pathToLineSegments=a,e.webgl=L,e.webglUtils=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function zx(){var t=function(e){var n={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},r={},i={};r.L=1,i[1]="L",Object.keys(n).forEach(function(Z,ie){r[Z]=1<<ie+1,i[r[Z]]=Z}),Object.freeze(r);var a=r.LRI|r.RLI|r.FSI,o=r.L|r.R|r.AL,s=r.B|r.S|r.WS|r.ON|r.FSI|r.LRI|r.RLI|r.PDI,l=r.BN|r.RLE|r.LRE|r.RLO|r.LRO|r.PDF,u=r.S|r.WS|r.B|a|r.PDI|l,c=null;function f(){if(!c){c=new Map;var Z=function(oe){if(n.hasOwnProperty(oe)){var ne=0;n[oe].split(",").forEach(function(de){var ce=de.split("+"),pe=ce[0],fe=ce[1];pe=parseInt(pe,36),fe=fe?parseInt(fe,36):0,c.set(ne+=pe,r[oe]);for(var Pe=0;Pe<fe;Pe++)c.set(++ne,r[oe])})}};for(var ie in n)Z(ie)}}function d(Z){return f(),c.get(Z.codePointAt(0))||r.L}function h(Z){return i[d(Z)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(Z,ie){var oe=36,ne=0,de=new Map,ce=ie&&new Map,pe;return Z.split(",").forEach(function fe(Pe){if(Pe.indexOf("+")!==-1)for(var xe=+Pe;xe--;)fe(pe);else{pe=Pe;var me=Pe.split(">"),Ae=me[0],Re=me[1];Ae=String.fromCodePoint(ne+=parseInt(Ae,oe)),Re=String.fromCodePoint(ne+=parseInt(Re,oe)),de.set(Ae,Re),ie&&ce.set(Re,Ae)}}),{map:de,reverseMap:ce}}var m,v,_;function w(){if(!m){var Z=g(p.pairs,!0),ie=Z.map,oe=Z.reverseMap;m=ie,v=oe,_=g(p.canonical,!1).map}}function y(Z){return w(),m.get(Z)||null}function b(Z){return w(),v.get(Z)||null}function S(Z){return w(),_.get(Z)||null}var E=r.L,x=r.R,A=r.EN,V=r.ES,F=r.ET,P=r.AN,N=r.CS,W=r.B,H=r.S,L=r.ON,G=r.BN,B=r.NSM,q=r.AL,$=r.LRO,R=r.RLO,O=r.LRE,D=r.RLE,T=r.PDF,C=r.LRI,j=r.RLI,k=r.FSI,z=r.PDI;function J(Z,ie){for(var oe=125,ne=new Uint32Array(Z.length),de=0;de<Z.length;de++)ne[de]=d(Z[de]);var ce=new Map;function pe(At,tn){var kt=ne[At];ne[At]=tn,ce.set(kt,ce.get(kt)-1),kt&s&&ce.set(s,ce.get(s)-1),ce.set(tn,(ce.get(tn)||0)+1),tn&s&&ce.set(s,(ce.get(s)||0)+1)}for(var fe=new Uint8Array(Z.length),Pe=new Map,xe=[],me=null,Ae=0;Ae<Z.length;Ae++)me||xe.push(me={start:Ae,end:Z.length-1,level:ie==="rtl"?1:ie==="ltr"?0:gc(Ae,!1)}),ne[Ae]&W&&(me.end=Ae,me=null);for(var Re=D|O|R|$|a|z|T|W,at=function(At){return At+(At&1?1:2)},Se=function(At){return At+(At&1?2:1)},Ye=0;Ye<xe.length;Ye++){me=xe[Ye];var Oe=[{_level:me.level,_override:0,_isolate:0}],_e=void 0,Ne=0,$e=0,ot=0;ce.clear();for(var ke=me.start;ke<=me.end;ke++){var Ke=ne[ke];if(_e=Oe[Oe.length-1],ce.set(Ke,(ce.get(Ke)||0)+1),Ke&s&&ce.set(s,(ce.get(s)||0)+1),Ke&Re)if(Ke&(D|O)){fe[ke]=_e._level;var _t=(Ke===D?Se:at)(_e._level);_t<=oe&&!Ne&&!$e?Oe.push({_level:_t,_override:0,_isolate:0}):Ne||$e++}else if(Ke&(R|$)){fe[ke]=_e._level;var xn=(Ke===R?Se:at)(_e._level);xn<=oe&&!Ne&&!$e?Oe.push({_level:xn,_override:Ke&R?x:E,_isolate:0}):Ne||$e++}else if(Ke&a){Ke&k&&(Ke=gc(ke+1,!0)===1?j:C),fe[ke]=_e._level,_e._override&&pe(ke,_e._override);var Zn=(Ke===j?Se:at)(_e._level);Zn<=oe&&Ne===0&&$e===0?(ot++,Oe.push({_level:Zn,_override:0,_isolate:1,_isolInitIndex:ke})):Ne++}else if(Ke&z){if(Ne>0)Ne--;else if(ot>0){for($e=0;!Oe[Oe.length-1]._isolate;)Oe.pop();var Ln=Oe[Oe.length-1]._isolInitIndex;Ln!=null&&(Pe.set(Ln,ke),Pe.set(ke,Ln)),Oe.pop(),ot--}_e=Oe[Oe.length-1],fe[ke]=_e._level,_e._override&&pe(ke,_e._override)}else Ke&T?(Ne===0&&($e>0?$e--:!_e._isolate&&Oe.length>1&&(Oe.pop(),_e=Oe[Oe.length-1])),fe[ke]=_e._level):Ke&W&&(fe[ke]=me.level);else fe[ke]=_e._level,_e._override&&Ke!==G&&pe(ke,_e._override)}for(var Ft=[],Mt=null,et=me.start;et<=me.end;et++){var Xr=ne[et];if(!(Xr&l)){var rt=fe[et],tt=Xr&a,Qt=Xr===z;Mt&&rt===Mt._level?(Mt._end=et,Mt._endsWithIsolInit=tt):Ft.push(Mt={_start:et,_end:et,_level:rt,_startsWithPDI:Qt,_endsWithIsolInit:tt})}}for(var Rt=[],Be=0;Be<Ft.length;Be++){var ht=Ft[Be];if(!ht._startsWithPDI||ht._startsWithPDI&&!Pe.has(ht._start)){for(var Gt=[Mt=ht],gt=void 0;Mt&&Mt._endsWithIsolInit&&(gt=Pe.get(Mt._end))!=null;)for(var ct=Be+1;ct<Ft.length;ct++)if(Ft[ct]._start===gt){Gt.push(Mt=Ft[ct]);break}for(var wt=[],Un=0;Un<Gt.length;Un++)for(var Jt=Gt[Un],Qn=Jt._start;Qn<=Jt._end;Qn++)wt.push(Qn);for(var Pm=fe[wt[0]],Zu=me.level,_a=wt[0]-1;_a>=0;_a--)if(!(ne[_a]&l)){Zu=fe[_a];break}var fs=wt[wt.length-1],Mm=fe[fs],Qu=me.level;if(!(ne[fs]&a)){for(var wa=fs+1;wa<=me.end;wa++)if(!(ne[wa]&l)){Qu=fe[wa];break}}Rt.push({_seqIndices:wt,_sosType:Math.max(Zu,Pm)%2?x:E,_eosType:Math.max(Qu,Mm)%2?x:E})}}for(var ds=0;ds<Rt.length;ds++){var hs=Rt[ds],ge=hs._seqIndices,Zr=hs._sosType,Rm=hs._eosType,mr=fe[ge[0]]&1?x:E;if(ce.get(B))for(var Ea=0;Ea<ge.length;Ea++){var Ju=ge[Ea];if(ne[Ju]&B){for(var ps=Zr,xa=Ea-1;xa>=0;xa--)if(!(ne[ge[xa]]&l)){ps=ne[ge[xa]];break}pe(Ju,ps&(a|z)?L:ps)}}if(ce.get(A))for(var Ta=0;Ta<ge.length;Ta++){var ec=ge[Ta];if(ne[ec]&A)for(var Sa=Ta-1;Sa>=-1;Sa--){var tc=Sa===-1?Zr:ne[ge[Sa]];if(tc&o){tc===q&&pe(ec,P);break}}}if(ce.get(q))for(var ms=0;ms<ge.length;ms++){var nc=ge[ms];ne[nc]&q&&pe(nc,x)}if(ce.get(V)||ce.get(N))for(var Qr=1;Qr<ge.length-1;Qr++){var gs=ge[Qr];if(ne[gs]&(V|N)){for(var gr=0,vs=0,ys=Qr-1;ys>=0&&(gr=ne[ge[ys]],!!(gr&l));ys--);for(var bs=Qr+1;bs<ge.length&&(vs=ne[ge[bs]],!!(vs&l));bs++);gr===vs&&(ne[gs]===V?gr===A:gr&(A|P))&&pe(gs,gr)}}if(ce.get(A))for(var un=0;un<ge.length;un++){var Im=ge[un];if(ne[Im]&A){for(var Aa=un-1;Aa>=0&&ne[ge[Aa]]&(F|l);Aa--)pe(ge[Aa],A);for(un++;un<ge.length&&ne[ge[un]]&(F|l|A);un++)ne[ge[un]]!==A&&pe(ge[un],A)}}if(ce.get(F)||ce.get(V)||ce.get(N))for(var Jr=0;Jr<ge.length;Jr++){var rc=ge[Jr];if(ne[rc]&(F|V|N)){pe(rc,L);for(var ka=Jr-1;ka>=0&&ne[ge[ka]]&l;ka--)pe(ge[ka],L);for(var Oa=Jr+1;Oa<ge.length&&ne[ge[Oa]]&l;Oa++)pe(ge[Oa],L)}}if(ce.get(A))for(var _s=0,ic=Zr;_s<ge.length;_s++){var ac=ge[_s],ws=ne[ac];ws&A?ic===E&&pe(ac,E):ws&o&&(ic=ws)}if(ce.get(s)){var ei=x|A|P,oc=ei|E,Da=[];{for(var vr=[],yr=0;yr<ge.length;yr++)if(ne[ge[yr]]&s){var ti=Z[ge[yr]],sc=void 0;if(y(ti)!==null)if(vr.length<63)vr.push({char:ti,seqIndex:yr});else break;else if((sc=b(ti))!==null)for(var ni=vr.length-1;ni>=0;ni--){var Es=vr[ni].char;if(Es===sc||Es===b(S(ti))||y(S(Es))===ti){Da.push([vr[ni].seqIndex,yr]),vr.length=ni;break}}}Da.sort(function(At,tn){return At[0]-tn[0]})}for(var xs=0;xs<Da.length;xs++){for(var lc=Da[xs],Ca=lc[0],Ts=lc[1],uc=!1,en=0,Ss=Ca+1;Ss<Ts;Ss++){var cc=ge[Ss];if(ne[cc]&oc){uc=!0;var fc=ne[cc]&ei?x:E;if(fc===mr){en=fc;break}}}if(uc&&!en){en=Zr;for(var As=Ca-1;As>=0;As--){var dc=ge[As];if(ne[dc]&oc){var hc=ne[dc]&ei?x:E;hc!==mr?en=hc:en=mr;break}}}if(en){if(ne[ge[Ca]]=ne[ge[Ts]]=en,en!==mr){for(var ri=Ca+1;ri<ge.length;ri++)if(!(ne[ge[ri]]&l)){d(Z[ge[ri]])&B&&(ne[ge[ri]]=en);break}}if(en!==mr){for(var ii=Ts+1;ii<ge.length;ii++)if(!(ne[ge[ii]]&l)){d(Z[ge[ii]])&B&&(ne[ge[ii]]=en);break}}}}for(var Vn=0;Vn<ge.length;Vn++)if(ne[ge[Vn]]&s){for(var pc=Vn,ks=Vn,Os=Zr,ai=Vn-1;ai>=0;ai--)if(ne[ge[ai]]&l)pc=ai;else{Os=ne[ge[ai]]&ei?x:E;break}for(var mc=Rm,oi=Vn+1;oi<ge.length;oi++)if(ne[ge[oi]]&(s|l))ks=oi;else{mc=ne[ge[oi]]&ei?x:E;break}for(var Ds=pc;Ds<=ks;Ds++)ne[ge[Ds]]=Os===mc?Os:mr;Vn=ks}}}for(var It=me.start;It<=me.end;It++){var Lm=fe[It],Pa=ne[It];if(Lm&1?Pa&(E|A|P)&&fe[It]++:Pa&x?fe[It]++:Pa&(P|A)&&(fe[It]+=2),Pa&l&&(fe[It]=It===0?me.level:fe[It-1]),It===me.end||d(Z[It])&(H|W))for(var Ma=It;Ma>=0&&d(Z[Ma])&u;Ma--)fe[Ma]=me.level}}return{levels:fe,paragraphs:xe};function gc(At,tn){for(var kt=At;kt<Z.length;kt++){var Fn=ne[kt];if(Fn&(x|q))return 1;if(Fn&(W|E)||tn&&Fn===z)return 0;if(Fn&a){var vc=Um(kt);kt=vc===-1?Z.length:vc}}return 0}function Um(At){for(var tn=1,kt=At+1;kt<Z.length;kt++){var Fn=ne[kt];if(Fn&W)break;if(Fn&z){if(--tn===0)return kt}else Fn&a&&tn++}return-1}}var Q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",X;function Y(){if(!X){var Z=g(Q,!0),ie=Z.map,oe=Z.reverseMap;oe.forEach(function(ne,de){ie.set(de,ne)}),X=ie}}function ae(Z){return Y(),X.get(Z)||null}function te(Z,ie,oe,ne){var de=Z.length;oe=Math.max(0,oe==null?0:+oe),ne=Math.min(de-1,ne==null?de-1:+ne);for(var ce=new Map,pe=oe;pe<=ne;pe++)if(ie[pe]&1){var fe=ae(Z[pe]);fe!==null&&ce.set(pe,fe)}return ce}function K(Z,ie,oe,ne){var de=Z.length;oe=Math.max(0,oe==null?0:+oe),ne=Math.min(de-1,ne==null?de-1:+ne);var ce=[];return ie.paragraphs.forEach(function(pe){var fe=Math.max(oe,pe.start),Pe=Math.min(ne,pe.end);if(fe<Pe){for(var xe=ie.levels.slice(fe,Pe+1),me=Pe;me>=fe&&d(Z[me])&u;me--)xe[me]=pe.level;for(var Ae=pe.level,Re=1/0,at=0;at<xe.length;at++){var Se=xe[at];Se>Ae&&(Ae=Se),Se<Re&&(Re=Se|1)}for(var Ye=Ae;Ye>=Re;Ye--)for(var Oe=0;Oe<xe.length;Oe++)if(xe[Oe]>=Ye){for(var _e=Oe;Oe+1<xe.length&&xe[Oe+1]>=Ye;)Oe++;Oe>_e&&ce.push([_e+fe,Oe+fe])}}}),ce}function U(Z,ie,oe,ne){var de=M(Z,ie,oe,ne),ce=[].concat(Z);return de.forEach(function(pe,fe){ce[fe]=(ie.levels[pe]&1?ae(Z[pe]):null)||Z[pe]}),ce.join("")}function M(Z,ie,oe,ne){for(var de=K(Z,ie,oe,ne),ce=[],pe=0;pe<Z.length;pe++)ce[pe]=pe;return de.forEach(function(fe){for(var Pe=fe[0],xe=fe[1],me=ce.slice(Pe,xe+1),Ae=me.length;Ae--;)ce[xe-Ae]=me[Ae]}),ce}return e.closingToOpeningBracket=b,e.getBidiCharType=d,e.getBidiCharTypeName=h,e.getCanonicalBracket=S,e.getEmbeddingLevels=J,e.getMirroredCharacter=ae,e.getMirroredCharactersMap=te,e.getReorderSegments=K,e.getReorderedIndices=M,e.getReorderedString=U,e.openingToClosingBracket=y,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const hm=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Vl(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function n(r,i){let a=og[i];return a?Vl(a):r}return t.replace(e,n)}const pt=[];for(let t=0;t<256;t++)pt[t]=(t<16?"0":"")+t.toString(16);function qx(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(pt[t&255]+pt[t>>8&255]+pt[t>>16&255]+pt[t>>24&255]+"-"+pt[e&255]+pt[e>>8&255]+"-"+pt[e>>16&15|64]+pt[e>>24&255]+"-"+pt[n&63|128]+pt[n>>8&255]+"-"+pt[n>>16&255]+pt[n>>24&255]+pt[r&255]+pt[r>>8&255]+pt[r>>16&255]+pt[r>>24&255]).toUpperCase()}const tr=Object.assign||function(){let t=arguments[0];for(let e=1,n=arguments.length;e<n;e++){let r=arguments[e];if(r)for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Bx=Date.now(),td=new WeakMap,nd=new Map;let Wx=1e10;function Fl(t,e){const n=Kx(e);let r=td.get(t);if(r||td.set(t,r=Object.create(null)),r[n])return new r[n];const i=`_onBeforeCompile${n}`,a=function(u,c){t.onBeforeCompile.call(this,u,c);const f=this.customProgramCacheKey()+"|"+u.vertexShader+"|"+u.fragmentShader;let d=nd[f];if(!d){const h=$x(this,u,e,n);d=nd[f]=h}u.vertexShader=d.vertexShader,u.fragmentShader=d.fragmentShader,tr(u.uniforms,this.uniforms),e.timeUniform&&(u.uniforms[e.timeUniform]={get value(){return Date.now()-Bx}}),this[i]&&this[i](u)},o=function(){return s(e.chained?t:t.clone())},s=function(u){const c=Object.create(u,l);return Object.defineProperty(c,"baseMaterial",{value:t}),Object.defineProperty(c,"id",{value:Wx++}),c.uuid=qx(),c.uniforms=tr({},u.uniforms,e.uniforms),c.defines=tr({},u.defines,e.defines),c.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",c.extensions=tr({},u.extensions,e.extensions),c._listeners=void 0,c},l={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+n}},onBeforeCompile:{get(){return a},set(u){this[i]=u}},copy:{writable:!0,configurable:!0,value:function(u){return t.copy.call(this,u),!t.isShaderMaterial&&!t.isDerivedMaterial&&(tr(this.extensions,u.extensions),tr(this.defines,u.defines),tr(this.uniforms,ng.clone(u.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const u=new t.constructor;return s(u).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let u=this._depthMaterial;return u||(u=this._depthMaterial=Fl(t.isDerivedMaterial?t.getDepthMaterial():new rg({depthPacking:ig}),e),u.defines.IS_DEPTH_MATERIAL="",u.uniforms=this.uniforms),u}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let u=this._distanceMaterial;return u||(u=this._distanceMaterial=Fl(t.isDerivedMaterial?t.getDistanceMaterial():new ag,e),u.defines.IS_DISTANCE_MATERIAL="",u.uniforms=this.uniforms),u}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:u,_distanceMaterial:c}=this;u&&u.dispose(),c&&c.dispose(),t.dispose.call(this)}}};return r[n]=o,new o}function $x(t,{vertexShader:e,fragmentShader:n},r,i){let{vertexDefs:a,vertexMainIntro:o,vertexMainOutro:s,vertexTransform:l,fragmentDefs:u,fragmentMainIntro:c,fragmentMainOutro:f,fragmentColorTransform:d,customRewriter:h,timeUniform:p}=r;if(a=a||"",o=o||"",s=s||"",u=u||"",c=c||"",f=f||"",(l||h)&&(e=Vl(e)),(d||h)&&(n=n.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),n=Vl(n)),h){let g=h({vertexShader:e,fragmentShader:n});e=g.vertexShader,n=g.fragmentShader}if(d){let g=[];n=n.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,m=>(g.push(m),"")),f=`${d}
${g.join(`
`)}
${f}`}if(p){const g=`
uniform float ${p};
`;a=g+a,u=g+u}return l&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,a=`${a}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(g,m,v,_)=>/\battribute\s+vec[23]\s+$/.test(_.substr(0,v))?m:`troika_${m}_${i}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=rd(e,i,a,o,s),n=rd(n,i,u,c,f),{vertexShader:e,fragmentShader:n}}function rd(t,e,n,r,i){return(r||i||n)&&(t=t.replace(hm,`
${n}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${r}
  troikaOrigMain${e}();
  ${i}
}`),t}function Hx(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let Yx=0;const id=new Map;function Kx(t){const e=JSON.stringify(t,Hx);let n=id.get(e);return n==null&&id.set(e,n=++Yx),n}function Xx(t,e,n){const{defaultFontURL:r}=n,i=Object.create(null),a=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,s="[^\\S\\u00A0]",l=new RegExp(`${s}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function u(_,w){function y(){const b=S=>{console.error(`Failure loading font ${_}${_===r?"":"; trying fallback"}`,S),_!==r&&(_=r,y())};try{const S=new XMLHttpRequest;S.open("get",_,!0),S.responseType="arraybuffer",S.onload=function(){if(S.status>=400)b(new Error(S.statusText));else if(S.status>0)try{const E=t(S.response);w(E)}catch(E){b(E)}},S.onerror=b,S.send()}catch(S){b(S)}}y()}function c(_,w){_||(_=r);let y=i[_];y?y.pending?y.pending.push(w):w(y):(i[_]={pending:[w]},u(_,b=>{let S=i[_].pending;i[_]=b,S.forEach(E=>E(b))}))}function f({text:_="",font:w=r,sdfGlyphSize:y=64,fontSize:b=1,letterSpacing:S=0,lineHeight:E="normal",maxWidth:x=a,direction:A,textAlign:V="left",textIndent:F=0,whiteSpace:P="normal",overflowWrap:N="normal",anchorX:W=0,anchorY:H=0,includeCaretPositions:L=!1,chunkedBoundsSize:G=8192,colorRanges:B=null},q,$=!1){const R=g(),O={fontLoad:0,typesetting:0};_.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),_=_.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),b=+b,S=+S,x=+x,E=E||"normal",F=+F,c(w,D=>{const T=isFinite(x);let C=null,j=null,k=null,z=null,J=null,Q=null,X=null,Y=0,ae=0,te=P!=="nowrap";const{ascender:K,descender:U,unitsPerEm:M,lineGap:Z,capHeight:ie,xHeight:oe}=D;O.fontLoad=g()-R;const ne=g(),de=b/M;E==="normal"&&(E=(K-U+Z)/M),E=E*b;const ce=(E-(K-U)*de)/2,pe=-(K*de+ce),fe=Math.min(E,(K-U)*de),Pe=(K+U)/2*de-fe/2;let xe=F,me=new m;const Ae=[me];D.forEachGlyph(_,b,S,(Se,Ye,Oe)=>{const _e=_.charAt(Oe),Ne=Se.advanceWidth*de,$e=me.count;let ot;if("isEmpty"in Se||(Se.isWhitespace=!!_e&&new RegExp(s).test(_e),Se.canBreakAfter=!!_e&&l.test(_e),Se.isEmpty=Se.xMin===Se.xMax||Se.yMin===Se.yMax||o.test(_e)),!Se.isWhitespace&&!Se.isEmpty&&ae++,te&&T&&!Se.isWhitespace&&Ye+Ne+xe>x&&$e){if(me.glyphAt($e-1).glyphObj.canBreakAfter)ot=new m,xe=-Ye;else for(let Ke=$e;Ke--;)if(Ke===0&&N==="break-word"){ot=new m,xe=-Ye;break}else if(me.glyphAt(Ke).glyphObj.canBreakAfter){ot=me.splitAt(Ke+1);const _t=ot.glyphAt(0).x;xe-=_t;for(let xn=ot.count;xn--;)ot.glyphAt(xn).x-=_t;break}ot&&(me.isSoftWrapped=!0,me=ot,Ae.push(me),Y=x)}let ke=me.glyphAt(me.count);ke.glyphObj=Se,ke.x=Ye+xe,ke.width=Ne,ke.charIndex=Oe,_e===`
`&&(me=new m,Ae.push(me),xe=-(Ye+Ne+S*b)+F)}),Ae.forEach(Se=>{for(let Ye=Se.count;Ye--;){let{glyphObj:Oe,x:_e,width:Ne}=Se.glyphAt(Ye);if(!Oe.isWhitespace){Se.width=_e+Ne,Se.width>Y&&(Y=Se.width);return}}});let Re=0,at=0;if(W&&(typeof W=="number"?Re=-W:typeof W=="string"&&(Re=-Y*(W==="left"?0:W==="center"?.5:W==="right"?1:h(W)))),H){if(typeof H=="number")at=-H;else if(typeof H=="string"){let Se=Ae.length*E;at=H==="top"?0:H==="top-baseline"?-pe:H==="top-cap"?-pe-ie*de:H==="top-ex"?-pe-oe*de:H==="middle"?Se/2:H==="bottom"?Se:H==="bottom-baseline"?Se-ce+U*de:h(H)*Se}}if(!$){const Se=e.getEmbeddingLevels(_,A);C=new Uint16Array(ae),j=new Float32Array(ae*2),k={},Q=[a,a,-a,-a],X=[];let Ye=pe;L&&(J=new Float32Array(_.length*3)),B&&(z=new Uint8Array(ae*3));let Oe=0,_e=-1,Ne=-1,$e,ot;if(Ae.forEach((ke,Ke)=>{let{count:_t,width:xn}=ke;if(_t>0){let Zn=0;for(let rt=_t;rt--&&ke.glyphAt(rt).glyphObj.isWhitespace;)Zn++;let Ln=0,Ft=0;if(V==="center")Ln=(Y-xn)/2;else if(V==="right")Ln=Y-xn;else if(V==="justify"&&ke.isSoftWrapped){let rt=0;for(let tt=_t-Zn;tt--;)ke.glyphAt(tt).glyphObj.isWhitespace&&rt++;Ft=(Y-xn)/rt}if(Ft||Ln){let rt=0;for(let tt=0;tt<_t;tt++){let Qt=ke.glyphAt(tt);const Rt=Qt.glyphObj;Qt.x+=Ln+rt,Ft!==0&&Rt.isWhitespace&&tt<_t-Zn&&(rt+=Ft,Qt.width+=Ft)}}const Mt=e.getReorderSegments(_,Se,ke.glyphAt(0).charIndex,ke.glyphAt(ke.count-1).charIndex);for(let rt=0;rt<Mt.length;rt++){const[tt,Qt]=Mt[rt];let Rt=1/0,Be=-1/0;for(let ht=0;ht<_t;ht++)if(ke.glyphAt(ht).charIndex>=tt){let Gt=ht,gt=ht;for(;gt<_t;gt++){let ct=ke.glyphAt(gt);if(ct.charIndex>Qt)break;gt<_t-Zn&&(Rt=Math.min(Rt,ct.x),Be=Math.max(Be,ct.x+ct.width))}for(let ct=Gt;ct<gt;ct++){const wt=ke.glyphAt(ct);wt.x=Be-(wt.x+wt.width-Rt)}break}}let et;const Xr=rt=>et=rt;for(let rt=0;rt<_t;rt++){let tt=ke.glyphAt(rt);et=tt.glyphObj;const Qt=et.index,Rt=Se.levels[tt.charIndex]&1;if(Rt){const Be=e.getMirroredCharacter(_[tt.charIndex]);Be&&D.forEachGlyph(Be,0,0,Xr)}if(L){const{charIndex:Be}=tt,ht=tt.x+Re,Gt=tt.x+tt.width+Re;J[Be*3]=Rt?Gt:ht,J[Be*3+1]=Rt?ht:Gt,J[Be*3+2]=Ye+Pe+at;const gt=Be-_e;gt>1&&p(J,_e,gt),_e=Be}if(B){const{charIndex:Be}=tt;for(;Be>Ne;)Ne++,B.hasOwnProperty(Ne)&&(ot=B[Ne])}if(!et.isWhitespace&&!et.isEmpty){const Be=Oe++;k[Qt]||(k[Qt]={path:et.path,pathBounds:[et.xMin,et.yMin,et.xMax,et.yMax]});const ht=tt.x+Re,Gt=Ye+at;j[Be*2]=ht,j[Be*2+1]=Gt;const gt=ht+et.xMin*de,ct=Gt+et.yMin*de,wt=ht+et.xMax*de,Un=Gt+et.yMax*de;gt<Q[0]&&(Q[0]=gt),ct<Q[1]&&(Q[1]=ct),wt>Q[2]&&(Q[2]=wt),Un>Q[3]&&(Q[3]=Un),Be%G===0&&($e={start:Be,end:Be,rect:[a,a,-a,-a]},X.push($e)),$e.end++;const Jt=$e.rect;if(gt<Jt[0]&&(Jt[0]=gt),ct<Jt[1]&&(Jt[1]=ct),wt>Jt[2]&&(Jt[2]=wt),Un>Jt[3]&&(Jt[3]=Un),C[Be]=Qt,B){const Qn=Be*3;z[Qn]=ot>>16&255,z[Qn+1]=ot>>8&255,z[Qn+2]=ot&255}}}}Ye-=E}),J){const ke=_.length-_e;ke>1&&p(J,_e,ke)}}O.typesetting=g()-ne,q({glyphIds:C,glyphPositions:j,glyphData:k,caretPositions:J,caretHeight:fe,glyphColors:z,chunkedBounds:X,fontSize:b,unitsPerEm:M,ascender:K*de,descender:U*de,capHeight:ie*de,xHeight:oe*de,lineHeight:E,topBaseline:pe,blockBounds:[Re,at-Ae.length*E,Re+Y,at],visibleBounds:Q,timings:O})})}function d(_,w){f(_,y=>{const[b,S,E,x]=y.blockBounds;w({width:E-b,height:x-S})},{metricsOnly:!0})}function h(_){let w=_.match(/^([\d.]+)%$/),y=w?parseFloat(w[1]):NaN;return isNaN(y)?0:y/100}function p(_,w,y){const b=_[w*3],S=_[w*3+1],E=_[w*3+2],x=(S-b)/y;for(let A=0;A<y;A++){const V=(w+A)*3;_[V]=b+x*A,_[V+1]=b+x*(A+1),_[V+2]=E}}function g(){return(self.performance||Date).now()}function m(){this.data=[]}const v=["glyphObj","x","width","charIndex"];return m.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/v.length)},glyphAt(_){let w=m.flyweight;return w.data=this.data,w.index=_,w},splitAt(_){let w=new m;return w.data=this.data.splice(_*v.length),w}},m.flyweight=v.reduce((_,w,y,b)=>(Object.defineProperty(_,w,{get(){return this.data[this.index*v.length+y]},set(S){this.data[this.index*v.length+y]=S}}),_),{data:null,index:0}),{typeset:f,measure:d,loadFont:c}}const ur=()=>(self.performance||Date).now(),ss=dm();let ad;function Zx(t,e,n,r,i,a,o,s,l,u,c=!0){return c?Jx(t,e,n,r,i,a,o,s,l,u).then(null,f=>(ad||(console.warn("WebGL SDF generation failed, falling back to JS",f),ad=!0),sd(t,e,n,r,i,a,o,s,l,u))):sd(t,e,n,r,i,a,o,s,l,u)}const ao=[],Qx=5;let Gl=0;function pm(){const t=ur();for(;ao.length&&ur()-t<Qx;)ao.shift()();Gl=ao.length?setTimeout(pm,0):0}const Jx=(...t)=>new Promise((e,n)=>{ao.push(()=>{const r=ur();try{ss.webgl.generateIntoCanvas(...t),e({timing:ur()-r})}catch(i){n(i)}}),Gl||(Gl=setTimeout(pm,0))}),e2=4,t2=2e3,od={};let n2=0;function sd(t,e,n,r,i,a,o,s,l,u){const c="TroikaTextSDFGenerator_JS_"+n2++%e2;let f=od[c];return f||(f=od[c]={workerModule:ba({name:c,workerId:c,dependencies:[dm,ur],init(d,h){const p=d().javascript.generate;return function(...g){const m=h();return{textureData:p(...g),timing:h()-m}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(t,e,n,r,i,a).then(({textureData:d,timing:h})=>{const p=ur(),g=new Uint8Array(d.length*4);for(let m=0;m<d.length;m++)g[m*4+u]=d[m];return ss.webglUtils.renderImageData(o,g,s,l,t,e,1<<3-u),h+=ur()-p,--f.requests===0&&(f.idleTimer=setTimeout(()=>{Nx(c)},t2)),{timing:h}})}function r2(t){t._warm||(ss.webgl.isSupported(t),t._warm=!0)}const i2=ss.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function a2(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(i){var a=e._bin,o=new Uint8Array(i);if(a.readASCII(o,0,4)=="ttcf"){var s=4;a.readUshort(o,s),s+=2,a.readUshort(o,s),s+=2;var l=a.readUint(o,s);s+=4;for(var u=[],c=0;c<l;c++){var f=a.readUint(o,s);s+=4,u.push(e._readFont(o,f))}return u}return[e._readFont(o,0)]},_readFont:function(i,a){var o=e._bin,s=a;o.readFixed(i,a),a+=4;var l=o.readUshort(i,a);a+=2,o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2;for(var u=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],c={_data:i,_offset:s},f={},d=0;d<l;d++){var h=o.readASCII(i,a,4);a+=4,o.readUint(i,a),a+=4;var p=o.readUint(i,a);a+=4;var g=o.readUint(i,a);a+=4,f[h]={offset:p,length:g}}for(d=0;d<u.length;d++){var m=u[d];f[m]&&(c[m.trim()]=e[m.trim()].parse(i,f[m].offset,f[m].length,c))}return c},_tabOffset:function(i,a,o){for(var s=e._bin,l=s.readUshort(i,o+4),u=o+12,c=0;c<l;c++){var f=s.readASCII(i,u,4);u+=4,s.readUint(i,u),u+=4;var d=s.readUint(i,u);if(u+=4,s.readUint(i,u),u+=4,f==a)return d}return 0}};e._bin={readFixed:function(i,a){return(i[a]<<8|i[a+1])+(i[a+2]<<8|i[a+3])/65540},readF2dot14:function(i,a){return e._bin.readShort(i,a)/16384},readInt:function(i,a){return e._bin._view(i).getInt32(a)},readInt8:function(i,a){return e._bin._view(i).getInt8(a)},readShort:function(i,a){return e._bin._view(i).getInt16(a)},readUshort:function(i,a){return e._bin._view(i).getUint16(a)},readUshorts:function(i,a,o){for(var s=[],l=0;l<o;l++)s.push(e._bin.readUshort(i,a+2*l));return s},readUint:function(i,a){return e._bin._view(i).getUint32(a)},readUint64:function(i,a){return 4294967296*e._bin.readUint(i,a)+e._bin.readUint(i,a+4)},readASCII:function(i,a,o){for(var s="",l=0;l<o;l++)s+=String.fromCharCode(i[a+l]);return s},readUnicode:function(i,a,o){for(var s="",l=0;l<o;l++){var u=i[a++]<<8|i[a++];s+=String.fromCharCode(u)}return s},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,a,o){var s=e._bin._tdec;return s&&a==0&&o==i.length?s.decode(i):e._bin.readASCII(i,a,o)},readBytes:function(i,a,o){for(var s=[],l=0;l<o;l++)s.push(i[a+l]);return s},readASCIIArray:function(i,a,o){for(var s=[],l=0;l<o;l++)s.push(String.fromCharCode(i[a+l]));return s},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,a,o,s,l){var u=e._bin,c={},f=a;u.readFixed(i,a),a+=4;var d=u.readUshort(i,a);a+=2;var h=u.readUshort(i,a);a+=2;var p=u.readUshort(i,a);return a+=2,c.scriptList=e._lctf.readScriptList(i,f+d),c.featureList=e._lctf.readFeatureList(i,f+h),c.lookupList=e._lctf.readLookupList(i,f+p,l),c},e._lctf.readLookupList=function(i,a,o){var s=e._bin,l=a,u=[],c=s.readUshort(i,a);a+=2;for(var f=0;f<c;f++){var d=s.readUshort(i,a);a+=2;var h=e._lctf.readLookupTable(i,l+d,o);u.push(h)}return u},e._lctf.readLookupTable=function(i,a,o){var s=e._bin,l=a,u={tabs:[]};u.ltype=s.readUshort(i,a),a+=2,u.flag=s.readUshort(i,a),a+=2;var c=s.readUshort(i,a);a+=2;for(var f=u.ltype,d=0;d<c;d++){var h=s.readUshort(i,a);a+=2;var p=o(i,f,l+h,u);u.tabs.push(p)}return u},e._lctf.numOfOnes=function(i){for(var a=0,o=0;o<32;o++)i>>>o&1&&a++;return a},e._lctf.readClassDef=function(i,a){var o=e._bin,s=[],l=o.readUshort(i,a);if(a+=2,l==1){var u=o.readUshort(i,a);a+=2;var c=o.readUshort(i,a);a+=2;for(var f=0;f<c;f++)s.push(u+f),s.push(u+f),s.push(o.readUshort(i,a)),a+=2}if(l==2){var d=o.readUshort(i,a);for(a+=2,f=0;f<d;f++)s.push(o.readUshort(i,a)),a+=2,s.push(o.readUshort(i,a)),a+=2,s.push(o.readUshort(i,a)),a+=2}return s},e._lctf.getInterval=function(i,a){for(var o=0;o<i.length;o+=3){var s=i[o],l=i[o+1];if(i[o+2],s<=a&&a<=l)return o}return-1},e._lctf.readCoverage=function(i,a){var o=e._bin,s={};s.fmt=o.readUshort(i,a),a+=2;var l=o.readUshort(i,a);return a+=2,s.fmt==1&&(s.tab=o.readUshorts(i,a,l)),s.fmt==2&&(s.tab=o.readUshorts(i,a,3*l)),s},e._lctf.coverageIndex=function(i,a){var o=i.tab;if(i.fmt==1)return o.indexOf(a);if(i.fmt==2){var s=e._lctf.getInterval(o,a);if(s!=-1)return o[s+2]+(a-o[s])}return-1},e._lctf.readFeatureList=function(i,a){var o=e._bin,s=a,l=[],u=o.readUshort(i,a);a+=2;for(var c=0;c<u;c++){var f=o.readASCII(i,a,4);a+=4;var d=o.readUshort(i,a);a+=2;var h=e._lctf.readFeatureTable(i,s+d);h.tag=f.trim(),l.push(h)}return l},e._lctf.readFeatureTable=function(i,a){var o=e._bin,s=a,l={},u=o.readUshort(i,a);a+=2,u>0&&(l.featureParams=s+u);var c=o.readUshort(i,a);a+=2,l.tab=[];for(var f=0;f<c;f++)l.tab.push(o.readUshort(i,a+2*f));return l},e._lctf.readScriptList=function(i,a){var o=e._bin,s=a,l={},u=o.readUshort(i,a);a+=2;for(var c=0;c<u;c++){var f=o.readASCII(i,a,4);a+=4;var d=o.readUshort(i,a);a+=2,l[f.trim()]=e._lctf.readScriptTable(i,s+d)}return l},e._lctf.readScriptTable=function(i,a){var o=e._bin,s=a,l={},u=o.readUshort(i,a);a+=2,l.default=e._lctf.readLangSysTable(i,s+u);var c=o.readUshort(i,a);a+=2;for(var f=0;f<c;f++){var d=o.readASCII(i,a,4);a+=4;var h=o.readUshort(i,a);a+=2,l[d.trim()]=e._lctf.readLangSysTable(i,s+h)}return l},e._lctf.readLangSysTable=function(i,a){var o=e._bin,s={};o.readUshort(i,a),a+=2,s.reqFeature=o.readUshort(i,a),a+=2;var l=o.readUshort(i,a);return a+=2,s.features=o.readUshorts(i,a,l),s},e.CFF={},e.CFF.parse=function(i,a,o){var s=e._bin;(i=new Uint8Array(i.buffer,a,o))[a=0],i[++a],i[++a],i[++a],a++;var l=[];a=e.CFF.readIndex(i,a,l);for(var u=[],c=0;c<l.length-1;c++)u.push(s.readASCII(i,a+l[c],l[c+1]-l[c]));a+=l[l.length-1];var f=[];a=e.CFF.readIndex(i,a,f);var d=[];for(c=0;c<f.length-1;c++)d.push(e.CFF.readDict(i,a+f[c],a+f[c+1]));a+=f[f.length-1];var h=d[0],p=[];a=e.CFF.readIndex(i,a,p);var g=[];for(c=0;c<p.length-1;c++)g.push(s.readASCII(i,a+p[c],p[c+1]-p[c]));if(a+=p[p.length-1],e.CFF.readSubrs(i,a,h),h.CharStrings){a=h.CharStrings,p=[],a=e.CFF.readIndex(i,a,p);var m=[];for(c=0;c<p.length-1;c++)m.push(s.readBytes(i,a+p[c],p[c+1]-p[c]));h.CharStrings=m}if(h.ROS){a=h.FDArray;var v=[];for(a=e.CFF.readIndex(i,a,v),h.FDArray=[],c=0;c<v.length-1;c++){var _=e.CFF.readDict(i,a+v[c],a+v[c+1]);e.CFF._readFDict(i,_,g),h.FDArray.push(_)}a+=v[v.length-1],a=h.FDSelect,h.FDSelect=[];var w=i[a];if(a++,w!=3)throw w;var y=s.readUshort(i,a);for(a+=2,c=0;c<y+1;c++)h.FDSelect.push(s.readUshort(i,a),i[a+2]),a+=3}return h.Encoding&&(h.Encoding=e.CFF.readEncoding(i,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=e.CFF.readCharset(i,h.charset,h.CharStrings.length)),e.CFF._readFDict(i,h,g),h},e.CFF._readFDict=function(i,a,o){var s;for(var l in a.Private&&(s=a.Private[1],a.Private=e.CFF.readDict(i,s,s+a.Private[0]),a.Private.Subrs&&e.CFF.readSubrs(i,s+a.Private.Subrs,a.Private)),a)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(a[l]=o[a[l]-426+35])},e.CFF.readSubrs=function(i,a,o){var s=e._bin,l=[];a=e.CFF.readIndex(i,a,l);var u,c=l.length;u=c<1240?107:c<33900?1131:32768,o.Bias=u,o.Subrs=[];for(var f=0;f<l.length-1;f++)o.Subrs.push(s.readBytes(i,a+l[f],l[f+1]-l[f]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,a){for(var o=0;o<i.charset.length;o++)if(i.charset[o]==a)return o;return-1},e.CFF.glyphBySE=function(i,a){return a<0||a>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[a])},e.CFF.readEncoding=function(i,a,o){e._bin;var s=[".notdef"],l=i[a];if(a++,l!=0)throw"error: unknown encoding format: "+l;var u=i[a];a++;for(var c=0;c<u;c++)s.push(i[a+c]);return s},e.CFF.readCharset=function(i,a,o){var s=e._bin,l=[".notdef"],u=i[a];if(a++,u==0)for(var c=0;c<o;c++){var f=s.readUshort(i,a);a+=2,l.push(f)}else{if(u!=1&&u!=2)throw"error: format: "+u;for(;l.length<o;){f=s.readUshort(i,a),a+=2;var d=0;for(u==1?(d=i[a],a++):(d=s.readUshort(i,a),a+=2),c=0;c<=d;c++)l.push(f),f++}}return l},e.CFF.readIndex=function(i,a,o){var s=e._bin,l=s.readUshort(i,a)+1,u=i[a+=2];if(a++,u==1)for(var c=0;c<l;c++)o.push(i[a+c]);else if(u==2)for(c=0;c<l;c++)o.push(s.readUshort(i,a+2*c));else if(u==3)for(c=0;c<l;c++)o.push(16777215&s.readUint(i,a+3*c-1));else if(l!=1)throw"unsupported offset size: "+u+", count: "+l;return(a+=l*u)-1},e.CFF.getCharString=function(i,a,o){var s=e._bin,l=i[a],u=i[a+1];i[a+2],i[a+3],i[a+4];var c=1,f=null,d=null;l<=20&&(f=l,c=1),l==12&&(f=100*l+u,c=2),21<=l&&l<=27&&(f=l,c=1),l==28&&(d=s.readShort(i,a+1),c=3),29<=l&&l<=31&&(f=l,c=1),32<=l&&l<=246&&(d=l-139,c=1),247<=l&&l<=250&&(d=256*(l-247)+u+108,c=2),251<=l&&l<=254&&(d=256*-(l-251)-u-108,c=2),l==255&&(d=s.readInt(i,a+1)/65535,c=5),o.val=d??"o"+f,o.size=c},e.CFF.readCharString=function(i,a,o){for(var s=a+o,l=e._bin,u=[];a<s;){var c=i[a],f=i[a+1];i[a+2],i[a+3],i[a+4];var d=1,h=null,p=null;c<=20&&(h=c,d=1),c==12&&(h=100*c+f,d=2),c!=19&&c!=20||(h=c,d=2),21<=c&&c<=27&&(h=c,d=1),c==28&&(p=l.readShort(i,a+1),d=3),29<=c&&c<=31&&(h=c,d=1),32<=c&&c<=246&&(p=c-139,d=1),247<=c&&c<=250&&(p=256*(c-247)+f+108,d=2),251<=c&&c<=254&&(p=256*-(c-251)-f-108,d=2),c==255&&(p=l.readInt(i,a+1)/65535,d=5),u.push(p??"o"+h),a+=d}return u},e.CFF.readDict=function(i,a,o){for(var s=e._bin,l={},u=[];a<o;){var c=i[a],f=i[a+1];i[a+2],i[a+3],i[a+4];var d=1,h=null,p=null;if(c==28&&(p=s.readShort(i,a+1),d=3),c==29&&(p=s.readInt(i,a+1),d=5),32<=c&&c<=246&&(p=c-139,d=1),247<=c&&c<=250&&(p=256*(c-247)+f+108,d=2),251<=c&&c<=254&&(p=256*-(c-251)-f-108,d=2),c==255)throw p=s.readInt(i,a+1)/65535,d=5,"unknown number";if(c==30){var g=[];for(d=1;;){var m=i[a+d];d++;var v=m>>4,_=15&m;if(v!=15&&g.push(v),_!=15&&g.push(_),_==15)break}for(var w="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],b=0;b<g.length;b++)w+=y[g[b]];p=parseFloat(w)}c<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][c],d=1,c==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],d=2)),h!=null?(l[h]=u.length==1?u[0]:u,u=[]):u.push(p),a+=d}return l},e.cmap={},e.cmap.parse=function(i,a,o){i=new Uint8Array(i.buffer,a,o),a=0;var s=e._bin,l={};s.readUshort(i,a),a+=2;var u=s.readUshort(i,a);a+=2;var c=[];l.tables=[];for(var f=0;f<u;f++){var d=s.readUshort(i,a);a+=2;var h=s.readUshort(i,a);a+=2;var p=s.readUint(i,a);a+=4;var g="p"+d+"e"+h,m=c.indexOf(p);if(m==-1){var v;m=l.tables.length,c.push(p);var _=s.readUshort(i,p);_==0?v=e.cmap.parse0(i,p):_==4?v=e.cmap.parse4(i,p):_==6?v=e.cmap.parse6(i,p):_==12?v=e.cmap.parse12(i,p):console.debug("unknown format: "+_,d,h,p),l.tables.push(v)}if(l[g]!=null)throw"multiple tables for one platform+encoding";l[g]=m}return l},e.cmap.parse0=function(i,a){var o=e._bin,s={};s.format=o.readUshort(i,a),a+=2;var l=o.readUshort(i,a);a+=2,o.readUshort(i,a),a+=2,s.map=[];for(var u=0;u<l-6;u++)s.map.push(i[a+u]);return s},e.cmap.parse4=function(i,a){var o=e._bin,s=a,l={};l.format=o.readUshort(i,a),a+=2;var u=o.readUshort(i,a);a+=2,o.readUshort(i,a),a+=2;var c=o.readUshort(i,a);a+=2;var f=c/2;l.searchRange=o.readUshort(i,a),a+=2,l.entrySelector=o.readUshort(i,a),a+=2,l.rangeShift=o.readUshort(i,a),a+=2,l.endCount=o.readUshorts(i,a,f),a+=2*f,a+=2,l.startCount=o.readUshorts(i,a,f),a+=2*f,l.idDelta=[];for(var d=0;d<f;d++)l.idDelta.push(o.readShort(i,a)),a+=2;for(l.idRangeOffset=o.readUshorts(i,a,f),a+=2*f,l.glyphIdArray=[];a<s+u;)l.glyphIdArray.push(o.readUshort(i,a)),a+=2;return l},e.cmap.parse6=function(i,a){var o=e._bin,s={};s.format=o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2,s.firstCode=o.readUshort(i,a),a+=2;var l=o.readUshort(i,a);a+=2,s.glyphIdArray=[];for(var u=0;u<l;u++)s.glyphIdArray.push(o.readUshort(i,a)),a+=2;return s},e.cmap.parse12=function(i,a){var o=e._bin,s={};s.format=o.readUshort(i,a),a+=2,a+=2,o.readUint(i,a),a+=4,o.readUint(i,a),a+=4;var l=o.readUint(i,a);a+=4,s.groups=[];for(var u=0;u<l;u++){var c=a+12*u,f=o.readUint(i,c+0),d=o.readUint(i,c+4),h=o.readUint(i,c+8);s.groups.push([f,d,h])}return s},e.glyf={},e.glyf.parse=function(i,a,o,s){for(var l=[],u=0;u<s.maxp.numGlyphs;u++)l.push(null);return l},e.glyf._parseGlyf=function(i,a){var o=e._bin,s=i._data,l=e._tabOffset(s,"glyf",i._offset)+i.loca[a];if(i.loca[a]==i.loca[a+1])return null;var u={};if(u.noc=o.readShort(s,l),l+=2,u.xMin=o.readShort(s,l),l+=2,u.yMin=o.readShort(s,l),l+=2,u.xMax=o.readShort(s,l),l+=2,u.yMax=o.readShort(s,l),l+=2,u.xMin>=u.xMax||u.yMin>=u.yMax)return null;if(u.noc>0){u.endPts=[];for(var c=0;c<u.noc;c++)u.endPts.push(o.readUshort(s,l)),l+=2;var f=o.readUshort(s,l);if(l+=2,s.length-l<f)return null;u.instructions=o.readBytes(s,l,f),l+=f;var d=u.endPts[u.noc-1]+1;for(u.flags=[],c=0;c<d;c++){var h=s[l];if(l++,u.flags.push(h),(8&h)!=0){var p=s[l];l++;for(var g=0;g<p;g++)u.flags.push(h),c++}}for(u.xs=[],c=0;c<d;c++){var m=(2&u.flags[c])!=0,v=(16&u.flags[c])!=0;m?(u.xs.push(v?s[l]:-s[l]),l++):v?u.xs.push(0):(u.xs.push(o.readShort(s,l)),l+=2)}for(u.ys=[],c=0;c<d;c++)m=(4&u.flags[c])!=0,v=(32&u.flags[c])!=0,m?(u.ys.push(v?s[l]:-s[l]),l++):v?u.ys.push(0):(u.ys.push(o.readShort(s,l)),l+=2);var _=0,w=0;for(c=0;c<d;c++)_+=u.xs[c],w+=u.ys[c],u.xs[c]=_,u.ys[c]=w}else{var y;u.parts=[];do{y=o.readUshort(s,l),l+=2;var b={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(u.parts.push(b),b.glyphIndex=o.readUshort(s,l),l+=2,1&y){var S=o.readShort(s,l);l+=2;var E=o.readShort(s,l);l+=2}else S=o.readInt8(s,l),l++,E=o.readInt8(s,l),l++;2&y?(b.m.tx=S,b.m.ty=E):(b.p1=S,b.p2=E),8&y?(b.m.a=b.m.d=o.readF2dot14(s,l),l+=2):64&y?(b.m.a=o.readF2dot14(s,l),l+=2,b.m.d=o.readF2dot14(s,l),l+=2):128&y&&(b.m.a=o.readF2dot14(s,l),l+=2,b.m.b=o.readF2dot14(s,l),l+=2,b.m.c=o.readF2dot14(s,l),l+=2,b.m.d=o.readF2dot14(s,l),l+=2)}while(32&y);if(256&y){var x=o.readUshort(s,l);for(l+=2,u.instr=[],c=0;c<x;c++)u.instr.push(s[l]),l++}}return u},e.GPOS={},e.GPOS.parse=function(i,a,o,s){return e._lctf.parse(i,a,o,s,e.GPOS.subt)},e.GPOS.subt=function(i,a,o,s){var l=e._bin,u=o,c={};if(c.fmt=l.readUshort(i,o),o+=2,a==1||a==2||a==3||a==7||a==8&&c.fmt<=2){var f=l.readUshort(i,o);o+=2,c.coverage=e._lctf.readCoverage(i,f+u)}if(a==1&&c.fmt==1){var d=l.readUshort(i,o);o+=2;var h=e._lctf.numOfOnes(d);d!=0&&(c.pos=e.GPOS.readValueRecord(i,o,d))}else if(a==2&&c.fmt>=1&&c.fmt<=2){d=l.readUshort(i,o),o+=2;var p=l.readUshort(i,o);o+=2,h=e._lctf.numOfOnes(d);var g=e._lctf.numOfOnes(p);if(c.fmt==1){c.pairsets=[];var m=l.readUshort(i,o);o+=2;for(var v=0;v<m;v++){var _=u+l.readUshort(i,o);o+=2;var w=l.readUshort(i,_);_+=2;for(var y=[],b=0;b<w;b++){var S=l.readUshort(i,_);_+=2,d!=0&&(P=e.GPOS.readValueRecord(i,_,d),_+=2*h),p!=0&&(N=e.GPOS.readValueRecord(i,_,p),_+=2*g),y.push({gid2:S,val1:P,val2:N})}c.pairsets.push(y)}}if(c.fmt==2){var E=l.readUshort(i,o);o+=2;var x=l.readUshort(i,o);o+=2;var A=l.readUshort(i,o);o+=2;var V=l.readUshort(i,o);for(o+=2,c.classDef1=e._lctf.readClassDef(i,u+E),c.classDef2=e._lctf.readClassDef(i,u+x),c.matrix=[],v=0;v<A;v++){var F=[];for(b=0;b<V;b++){var P=null,N=null;d!=0&&(P=e.GPOS.readValueRecord(i,o,d),o+=2*h),p!=0&&(N=e.GPOS.readValueRecord(i,o,p),o+=2*g),F.push({val1:P,val2:N})}c.matrix.push(F)}}}else{if(a==9&&c.fmt==1){var W=l.readUshort(i,o);o+=2;var H=l.readUint(i,o);if(o+=4,s.ltype==9)s.ltype=W;else if(s.ltype!=W)throw"invalid extension substitution";return e.GPOS.subt(i,s.ltype,u+H)}console.debug("unsupported GPOS table LookupType",a,"format",c.fmt)}return c},e.GPOS.readValueRecord=function(i,a,o){var s=e._bin,l=[];return l.push(1&o?s.readShort(i,a):0),a+=1&o?2:0,l.push(2&o?s.readShort(i,a):0),a+=2&o?2:0,l.push(4&o?s.readShort(i,a):0),a+=4&o?2:0,l.push(8&o?s.readShort(i,a):0),a+=8&o?2:0,l},e.GSUB={},e.GSUB.parse=function(i,a,o,s){return e._lctf.parse(i,a,o,s,e.GSUB.subt)},e.GSUB.subt=function(i,a,o,s){var l=e._bin,u=o,c={};if(c.fmt=l.readUshort(i,o),o+=2,a!=1&&a!=4&&a!=5&&a!=6)return null;if(a==1||a==4||a==5&&c.fmt<=2||a==6&&c.fmt<=2){var f=l.readUshort(i,o);o+=2,c.coverage=e._lctf.readCoverage(i,u+f)}if(a==1&&c.fmt>=1&&c.fmt<=2){if(c.fmt==1)c.delta=l.readShort(i,o),o+=2;else if(c.fmt==2){var d=l.readUshort(i,o);o+=2,c.newg=l.readUshorts(i,o,d),o+=2*c.newg.length}}else if(a==4){c.vals=[],d=l.readUshort(i,o),o+=2;for(var h=0;h<d;h++){var p=l.readUshort(i,o);o+=2,c.vals.push(e.GSUB.readLigatureSet(i,u+p))}}else if(a==5&&c.fmt==2){if(c.fmt==2){var g=l.readUshort(i,o);o+=2,c.cDef=e._lctf.readClassDef(i,u+g),c.scset=[];var m=l.readUshort(i,o);for(o+=2,h=0;h<m;h++){var v=l.readUshort(i,o);o+=2,c.scset.push(v==0?null:e.GSUB.readSubClassSet(i,u+v))}}}else if(a==6&&c.fmt==3){if(c.fmt==3){for(h=0;h<3;h++){d=l.readUshort(i,o),o+=2;for(var _=[],w=0;w<d;w++)_.push(e._lctf.readCoverage(i,u+l.readUshort(i,o+2*w)));o+=2*d,h==0&&(c.backCvg=_),h==1&&(c.inptCvg=_),h==2&&(c.ahedCvg=_)}d=l.readUshort(i,o),o+=2,c.lookupRec=e.GSUB.readSubstLookupRecords(i,o,d)}}else{if(a==7&&c.fmt==1){var y=l.readUshort(i,o);o+=2;var b=l.readUint(i,o);if(o+=4,s.ltype==9)s.ltype=y;else if(s.ltype!=y)throw"invalid extension substitution";return e.GSUB.subt(i,s.ltype,u+b)}console.debug("unsupported GSUB table LookupType",a,"format",c.fmt)}return c},e.GSUB.readSubClassSet=function(i,a){var o=e._bin.readUshort,s=a,l=[],u=o(i,a);a+=2;for(var c=0;c<u;c++){var f=o(i,a);a+=2,l.push(e.GSUB.readSubClassRule(i,s+f))}return l},e.GSUB.readSubClassRule=function(i,a){var o=e._bin.readUshort,s={},l=o(i,a),u=o(i,a+=2);a+=2,s.input=[];for(var c=0;c<l-1;c++)s.input.push(o(i,a)),a+=2;return s.substLookupRecords=e.GSUB.readSubstLookupRecords(i,a,u),s},e.GSUB.readSubstLookupRecords=function(i,a,o){for(var s=e._bin.readUshort,l=[],u=0;u<o;u++)l.push(s(i,a),s(i,a+2)),a+=4;return l},e.GSUB.readChainSubClassSet=function(i,a){var o=e._bin,s=a,l=[],u=o.readUshort(i,a);a+=2;for(var c=0;c<u;c++){var f=o.readUshort(i,a);a+=2,l.push(e.GSUB.readChainSubClassRule(i,s+f))}return l},e.GSUB.readChainSubClassRule=function(i,a){for(var o=e._bin,s={},l=["backtrack","input","lookahead"],u=0;u<l.length;u++){var c=o.readUshort(i,a);a+=2,u==1&&c--,s[l[u]]=o.readUshorts(i,a,c),a+=2*s[l[u]].length}return c=o.readUshort(i,a),a+=2,s.subst=o.readUshorts(i,a,2*c),a+=2*s.subst.length,s},e.GSUB.readLigatureSet=function(i,a){var o=e._bin,s=a,l=[],u=o.readUshort(i,a);a+=2;for(var c=0;c<u;c++){var f=o.readUshort(i,a);a+=2,l.push(e.GSUB.readLigature(i,s+f))}return l},e.GSUB.readLigature=function(i,a){var o=e._bin,s={chain:[]};s.nglyph=o.readUshort(i,a),a+=2;var l=o.readUshort(i,a);a+=2;for(var u=0;u<l-1;u++)s.chain.push(o.readUshort(i,a)),a+=2;return s},e.head={},e.head.parse=function(i,a,o){var s=e._bin,l={};return s.readFixed(i,a),a+=4,l.fontRevision=s.readFixed(i,a),a+=4,s.readUint(i,a),a+=4,s.readUint(i,a),a+=4,l.flags=s.readUshort(i,a),a+=2,l.unitsPerEm=s.readUshort(i,a),a+=2,l.created=s.readUint64(i,a),a+=8,l.modified=s.readUint64(i,a),a+=8,l.xMin=s.readShort(i,a),a+=2,l.yMin=s.readShort(i,a),a+=2,l.xMax=s.readShort(i,a),a+=2,l.yMax=s.readShort(i,a),a+=2,l.macStyle=s.readUshort(i,a),a+=2,l.lowestRecPPEM=s.readUshort(i,a),a+=2,l.fontDirectionHint=s.readShort(i,a),a+=2,l.indexToLocFormat=s.readShort(i,a),a+=2,l.glyphDataFormat=s.readShort(i,a),a+=2,l},e.hhea={},e.hhea.parse=function(i,a,o){var s=e._bin,l={};return s.readFixed(i,a),a+=4,l.ascender=s.readShort(i,a),a+=2,l.descender=s.readShort(i,a),a+=2,l.lineGap=s.readShort(i,a),a+=2,l.advanceWidthMax=s.readUshort(i,a),a+=2,l.minLeftSideBearing=s.readShort(i,a),a+=2,l.minRightSideBearing=s.readShort(i,a),a+=2,l.xMaxExtent=s.readShort(i,a),a+=2,l.caretSlopeRise=s.readShort(i,a),a+=2,l.caretSlopeRun=s.readShort(i,a),a+=2,l.caretOffset=s.readShort(i,a),a+=2,a+=8,l.metricDataFormat=s.readShort(i,a),a+=2,l.numberOfHMetrics=s.readUshort(i,a),a+=2,l},e.hmtx={},e.hmtx.parse=function(i,a,o,s){for(var l=e._bin,u={aWidth:[],lsBearing:[]},c=0,f=0,d=0;d<s.maxp.numGlyphs;d++)d<s.hhea.numberOfHMetrics&&(c=l.readUshort(i,a),a+=2,f=l.readShort(i,a),a+=2),u.aWidth.push(c),u.lsBearing.push(f);return u},e.kern={},e.kern.parse=function(i,a,o,s){var l=e._bin,u=l.readUshort(i,a);if(a+=2,u==1)return e.kern.parseV1(i,a-2,o,s);var c=l.readUshort(i,a);a+=2;for(var f={glyph1:[],rval:[]},d=0;d<c;d++){a+=2,o=l.readUshort(i,a),a+=2;var h=l.readUshort(i,a);a+=2;var p=h>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;a=e.kern.readFormat0(i,a,f)}return f},e.kern.parseV1=function(i,a,o,s){var l=e._bin;l.readFixed(i,a),a+=4;var u=l.readUint(i,a);a+=4;for(var c={glyph1:[],rval:[]},f=0;f<u;f++){l.readUint(i,a),a+=4;var d=l.readUshort(i,a);a+=2,l.readUshort(i,a),a+=2;var h=d>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;a=e.kern.readFormat0(i,a,c)}return c},e.kern.readFormat0=function(i,a,o){var s=e._bin,l=-1,u=s.readUshort(i,a);a+=2,s.readUshort(i,a),a+=2,s.readUshort(i,a),a+=2,s.readUshort(i,a),a+=2;for(var c=0;c<u;c++){var f=s.readUshort(i,a);a+=2;var d=s.readUshort(i,a);a+=2;var h=s.readShort(i,a);a+=2,f!=l&&(o.glyph1.push(f),o.rval.push({glyph2:[],vals:[]}));var p=o.rval[o.rval.length-1];p.glyph2.push(d),p.vals.push(h),l=f}return a},e.loca={},e.loca.parse=function(i,a,o,s){var l=e._bin,u=[],c=s.head.indexToLocFormat,f=s.maxp.numGlyphs+1;if(c==0)for(var d=0;d<f;d++)u.push(l.readUshort(i,a+(d<<1))<<1);if(c==1)for(d=0;d<f;d++)u.push(l.readUint(i,a+(d<<2)));return u},e.maxp={},e.maxp.parse=function(i,a,o){var s=e._bin,l={},u=s.readUint(i,a);return a+=4,l.numGlyphs=s.readUshort(i,a),a+=2,u==65536&&(l.maxPoints=s.readUshort(i,a),a+=2,l.maxContours=s.readUshort(i,a),a+=2,l.maxCompositePoints=s.readUshort(i,a),a+=2,l.maxCompositeContours=s.readUshort(i,a),a+=2,l.maxZones=s.readUshort(i,a),a+=2,l.maxTwilightPoints=s.readUshort(i,a),a+=2,l.maxStorage=s.readUshort(i,a),a+=2,l.maxFunctionDefs=s.readUshort(i,a),a+=2,l.maxInstructionDefs=s.readUshort(i,a),a+=2,l.maxStackElements=s.readUshort(i,a),a+=2,l.maxSizeOfInstructions=s.readUshort(i,a),a+=2,l.maxComponentElements=s.readUshort(i,a),a+=2,l.maxComponentDepth=s.readUshort(i,a),a+=2),l},e.name={},e.name.parse=function(i,a,o){var s=e._bin,l={};s.readUshort(i,a),a+=2;var u=s.readUshort(i,a);a+=2,s.readUshort(i,a);for(var c,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=a+=2,h=0;h<u;h++){var p=s.readUshort(i,a);a+=2;var g=s.readUshort(i,a);a+=2;var m=s.readUshort(i,a);a+=2;var v=s.readUshort(i,a);a+=2;var _=s.readUshort(i,a);a+=2;var w=s.readUshort(i,a);a+=2;var y,b=f[v],S=d+12*u+w;if(p==0)y=s.readUnicode(i,S,_/2);else if(p==3&&g==0)y=s.readUnicode(i,S,_/2);else if(g==0)y=s.readASCII(i,S,_);else if(g==1)y=s.readUnicode(i,S,_/2);else if(g==3)y=s.readUnicode(i,S,_/2);else{if(p!=1)throw"unknown encoding "+g+", platformID: "+p;y=s.readASCII(i,S,_),console.debug("reading unknown MAC encoding "+g+" as ASCII")}var E="p"+p+","+m.toString(16);l[E]==null&&(l[E]={}),l[E][b!==void 0?b:v]=y,l[E]._lang=m}for(var x in l)if(l[x].postScriptName!=null&&l[x]._lang==1033)return l[x];for(var x in l)if(l[x].postScriptName!=null&&l[x]._lang==0)return l[x];for(var x in l)if(l[x].postScriptName!=null&&l[x]._lang==3084)return l[x];for(var x in l)if(l[x].postScriptName!=null)return l[x];for(var x in l){c=x;break}return console.debug("returning name table with languageID "+l[c]._lang),l[c]},e["OS/2"]={},e["OS/2"].parse=function(i,a,o){var s=e._bin.readUshort(i,a);a+=2;var l={};if(s==0)e["OS/2"].version0(i,a,l);else if(s==1)e["OS/2"].version1(i,a,l);else if(s==2||s==3||s==4)e["OS/2"].version2(i,a,l);else{if(s!=5)throw"unknown OS/2 table version: "+s;e["OS/2"].version5(i,a,l)}return l},e["OS/2"].version0=function(i,a,o){var s=e._bin;return o.xAvgCharWidth=s.readShort(i,a),a+=2,o.usWeightClass=s.readUshort(i,a),a+=2,o.usWidthClass=s.readUshort(i,a),a+=2,o.fsType=s.readUshort(i,a),a+=2,o.ySubscriptXSize=s.readShort(i,a),a+=2,o.ySubscriptYSize=s.readShort(i,a),a+=2,o.ySubscriptXOffset=s.readShort(i,a),a+=2,o.ySubscriptYOffset=s.readShort(i,a),a+=2,o.ySuperscriptXSize=s.readShort(i,a),a+=2,o.ySuperscriptYSize=s.readShort(i,a),a+=2,o.ySuperscriptXOffset=s.readShort(i,a),a+=2,o.ySuperscriptYOffset=s.readShort(i,a),a+=2,o.yStrikeoutSize=s.readShort(i,a),a+=2,o.yStrikeoutPosition=s.readShort(i,a),a+=2,o.sFamilyClass=s.readShort(i,a),a+=2,o.panose=s.readBytes(i,a,10),a+=10,o.ulUnicodeRange1=s.readUint(i,a),a+=4,o.ulUnicodeRange2=s.readUint(i,a),a+=4,o.ulUnicodeRange3=s.readUint(i,a),a+=4,o.ulUnicodeRange4=s.readUint(i,a),a+=4,o.achVendID=[s.readInt8(i,a),s.readInt8(i,a+1),s.readInt8(i,a+2),s.readInt8(i,a+3)],a+=4,o.fsSelection=s.readUshort(i,a),a+=2,o.usFirstCharIndex=s.readUshort(i,a),a+=2,o.usLastCharIndex=s.readUshort(i,a),a+=2,o.sTypoAscender=s.readShort(i,a),a+=2,o.sTypoDescender=s.readShort(i,a),a+=2,o.sTypoLineGap=s.readShort(i,a),a+=2,o.usWinAscent=s.readUshort(i,a),a+=2,o.usWinDescent=s.readUshort(i,a),a+=2},e["OS/2"].version1=function(i,a,o){var s=e._bin;return a=e["OS/2"].version0(i,a,o),o.ulCodePageRange1=s.readUint(i,a),a+=4,o.ulCodePageRange2=s.readUint(i,a),a+=4},e["OS/2"].version2=function(i,a,o){var s=e._bin;return a=e["OS/2"].version1(i,a,o),o.sxHeight=s.readShort(i,a),a+=2,o.sCapHeight=s.readShort(i,a),a+=2,o.usDefault=s.readUshort(i,a),a+=2,o.usBreak=s.readUshort(i,a),a+=2,o.usMaxContext=s.readUshort(i,a),a+=2},e["OS/2"].version5=function(i,a,o){var s=e._bin;return a=e["OS/2"].version2(i,a,o),o.usLowerOpticalPointSize=s.readUshort(i,a),a+=2,o.usUpperOpticalPointSize=s.readUshort(i,a),a+=2},e.post={},e.post.parse=function(i,a,o){var s=e._bin,l={};return l.version=s.readFixed(i,a),a+=4,l.italicAngle=s.readFixed(i,a),a+=4,l.underlinePosition=s.readShort(i,a),a+=2,l.underlineThickness=s.readShort(i,a),a+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,a){var o=i.cmap,s=-1;if(o.p0e4!=null?s=o.p0e4:o.p3e1!=null?s=o.p3e1:o.p1e0!=null?s=o.p1e0:o.p0e3!=null&&(s=o.p0e3),s==-1)throw"no familiar platform and encoding!";var l=o.tables[s];if(l.format==0)return a>=l.map.length?0:l.map[a];if(l.format==4){for(var u=-1,c=0;c<l.endCount.length;c++)if(a<=l.endCount[c]){u=c;break}return u==-1||l.startCount[u]>a?0:65535&(l.idRangeOffset[u]!=0?l.glyphIdArray[a-l.startCount[u]+(l.idRangeOffset[u]>>1)-(l.idRangeOffset.length-u)]:a+l.idDelta[u])}if(l.format==12){if(a>l.groups[l.groups.length-1][1])return 0;for(c=0;c<l.groups.length;c++){var f=l.groups[c];if(f[0]<=a&&a<=f[1])return f[2]+(a-f[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(i,a){var o={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[a]){var s=i.SVG.entries[a];return s==null?o:(typeof s=="string"&&(s=e.SVG.toPath(s),i.SVG.entries[a]=s),s)}if(i.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},u=i.CFF,c=i.CFF.Private;if(u.ROS){for(var f=0;u.FDSelect[f+2]<=a;)f+=2;c=u.FDArray[u.FDSelect[f+1]].Private}e.U._drawCFF(i.CFF.CharStrings[a],l,u,c,o)}else i.glyf&&e.U._drawGlyf(a,i,o);return o},e.U._drawGlyf=function(i,a,o){var s=a.glyf[i];s==null&&(s=a.glyf[i]=e.glyf._parseGlyf(a,i)),s!=null&&(s.noc>-1?e.U._simpleGlyph(s,o):e.U._compoGlyph(s,a,o))},e.U._simpleGlyph=function(i,a){for(var o=0;o<i.noc;o++){for(var s=o==0?0:i.endPts[o-1]+1,l=i.endPts[o],u=s;u<=l;u++){var c=u==s?l:u-1,f=u==l?s:u+1,d=1&i.flags[u],h=1&i.flags[c],p=1&i.flags[f],g=i.xs[u],m=i.ys[u];if(u==s)if(d){if(!h){e.U.P.moveTo(a,g,m);continue}e.U.P.moveTo(a,i.xs[c],i.ys[c])}else h?e.U.P.moveTo(a,i.xs[c],i.ys[c]):e.U.P.moveTo(a,(i.xs[c]+g)/2,(i.ys[c]+m)/2);d?h&&e.U.P.lineTo(a,g,m):p?e.U.P.qcurveTo(a,g,m,i.xs[f],i.ys[f]):e.U.P.qcurveTo(a,g,m,(g+i.xs[f])/2,(m+i.ys[f])/2)}e.U.P.closePath(a)}},e.U._compoGlyph=function(i,a,o){for(var s=0;s<i.parts.length;s++){var l={cmds:[],crds:[]},u=i.parts[s];e.U._drawGlyf(u.glyphIndex,a,l);for(var c=u.m,f=0;f<l.crds.length;f+=2){var d=l.crds[f],h=l.crds[f+1];o.crds.push(d*c.a+h*c.b+c.tx),o.crds.push(d*c.c+h*c.d+c.ty)}for(f=0;f<l.cmds.length;f++)o.cmds.push(l.cmds[f])}},e.U._getGlyphClass=function(i,a){var o=e._lctf.getInterval(a,i);return o==-1?0:a[o+2]},e.U.getPairAdjustment=function(i,a,o){var s=!1;if(i.GPOS)for(var l=i.GPOS,u=l.lookupList,c=l.featureList,f=[],d=0;d<c.length;d++){var h=c[d];if(h.tag=="kern"){s=!0;for(var p=0;p<h.tab.length;p++)if(!f[h.tab[p]]){f[h.tab[p]]=!0;for(var g=u[h.tab[p]],m=0;m<g.tabs.length;m++)if(g.tabs[m]!=null){var v,_=g.tabs[m];if((!_.coverage||(v=e._lctf.coverageIndex(_.coverage,a))!=-1)&&g.ltype!=1){if(g.ltype==2){var w=null;if(_.fmt==1){var y=_.pairsets[v];for(d=0;d<y.length;d++)y[d].gid2==o&&(w=y[d])}else if(_.fmt==2){var b=e.U._getGlyphClass(a,_.classDef1),S=e.U._getGlyphClass(o,_.classDef2);w=_.matrix[b][S]}if(w){var E=0;return w.val1&&w.val1[2]&&(E+=w.val1[2]),w.val2&&w.val2[0]&&(E+=w.val2[0]),E}}}}}}}if(i.kern&&!s){var x=i.kern.glyph1.indexOf(a);if(x!=-1){var A=i.kern.rval[x].glyph2.indexOf(o);if(A!=-1)return i.kern.rval[x].vals[A]}}return 0},e.U._applySubs=function(i,a,o,s){for(var l=i.length-a-1,u=0;u<o.tabs.length;u++)if(o.tabs[u]!=null){var c,f=o.tabs[u];if(!f.coverage||(c=e._lctf.coverageIndex(f.coverage,i[a]))!=-1){if(o.ltype==1)i[a],f.fmt==1?i[a]=i[a]+f.delta:i[a]=f.newg[c];else if(o.ltype==4)for(var d=f.vals[c],h=0;h<d.length;h++){var p=d[h],g=p.chain.length;if(!(g>l)){for(var m=!0,v=0,_=0;_<g;_++){for(;i[a+v+(1+_)]==-1;)v++;p.chain[_]!=i[a+v+(1+_)]&&(m=!1)}if(m){for(i[a]=p.nglyph,_=0;_<g+v;_++)i[a+_+1]=-1;break}}}else if(o.ltype==5&&f.fmt==2)for(var w=e._lctf.getInterval(f.cDef,i[a]),y=f.cDef[w+2],b=f.scset[y],S=0;S<b.length;S++){var E=b[S],x=E.input;if(!(x.length>l)){for(m=!0,_=0;_<x.length;_++){var A=e._lctf.getInterval(f.cDef,i[a+1+_]);if(w==-1&&f.cDef[A+2]!=x[_]){m=!1;break}}if(m){var V=E.substLookupRecords;for(h=0;h<V.length;h+=2)V[h],V[h+1]}}}else if(o.ltype==6&&f.fmt==3){if(!e.U._glsCovered(i,f.backCvg,a-f.backCvg.length)||!e.U._glsCovered(i,f.inptCvg,a)||!e.U._glsCovered(i,f.ahedCvg,a+f.inptCvg.length))continue;var F=f.lookupRec;for(S=0;S<F.length;S+=2){w=F[S];var P=s[F[S+1]];e.U._applySubs(i,a+w,P,s)}}}}},e.U._glsCovered=function(i,a,o){for(var s=0;s<a.length;s++)if(e._lctf.coverageIndex(a[s],i[o+s])==-1)return!1;return!0},e.U.glyphsToPath=function(i,a,o){for(var s={cmds:[],crds:[]},l=0,u=0;u<a.length;u++){var c=a[u];if(c!=-1){for(var f=u<a.length-1&&a[u+1]!=-1?a[u+1]:0,d=e.U.glyphToPath(i,c),h=0;h<d.crds.length;h+=2)s.crds.push(d.crds[h]+l),s.crds.push(d.crds[h+1]);for(o&&s.cmds.push(o),h=0;h<d.cmds.length;h++)s.cmds.push(d.cmds[h]);o&&s.cmds.push("X"),l+=i.hmtx.aWidth[c],u<a.length-1&&(l+=e.U.getPairAdjustment(i,c,f))}}return s},e.U.P={},e.U.P.moveTo=function(i,a,o){i.cmds.push("M"),i.crds.push(a,o)},e.U.P.lineTo=function(i,a,o){i.cmds.push("L"),i.crds.push(a,o)},e.U.P.curveTo=function(i,a,o,s,l,u,c){i.cmds.push("C"),i.crds.push(a,o,s,l,u,c)},e.U.P.qcurveTo=function(i,a,o,s,l){i.cmds.push("Q"),i.crds.push(a,o,s,l)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,a,o,s,l){for(var u=a.stack,c=a.nStems,f=a.haveWidth,d=a.width,h=a.open,p=0,g=a.x,m=a.y,v=0,_=0,w=0,y=0,b=0,S=0,E=0,x=0,A=0,V=0,F={val:0,size:0};p<i.length;){e.CFF.getCharString(i,p,F);var P=F.val;if(p+=F.size,P=="o1"||P=="o18")u.length%2!=0&&!f&&(d=u.shift()+s.nominalWidthX),c+=u.length>>1,u.length=0,f=!0;else if(P=="o3"||P=="o23")u.length%2!=0&&!f&&(d=u.shift()+s.nominalWidthX),c+=u.length>>1,u.length=0,f=!0;else if(P=="o4")u.length>1&&!f&&(d=u.shift()+s.nominalWidthX,f=!0),h&&e.U.P.closePath(l),m+=u.pop(),e.U.P.moveTo(l,g,m),h=!0;else if(P=="o5")for(;u.length>0;)g+=u.shift(),m+=u.shift(),e.U.P.lineTo(l,g,m);else if(P=="o6"||P=="o7")for(var N=u.length,W=P=="o6",H=0;H<N;H++){var L=u.shift();W?g+=L:m+=L,W=!W,e.U.P.lineTo(l,g,m)}else if(P=="o8"||P=="o24"){N=u.length;for(var G=0;G+6<=N;)v=g+u.shift(),_=m+u.shift(),w=v+u.shift(),y=_+u.shift(),g=w+u.shift(),m=y+u.shift(),e.U.P.curveTo(l,v,_,w,y,g,m),G+=6;P=="o24"&&(g+=u.shift(),m+=u.shift(),e.U.P.lineTo(l,g,m))}else{if(P=="o11")break;if(P=="o1234"||P=="o1235"||P=="o1236"||P=="o1237")P=="o1234"&&(_=m,w=(v=g+u.shift())+u.shift(),V=y=_+u.shift(),S=y,x=m,g=(E=(b=(A=w+u.shift())+u.shift())+u.shift())+u.shift(),e.U.P.curveTo(l,v,_,w,y,A,V),e.U.P.curveTo(l,b,S,E,x,g,m)),P=="o1235"&&(v=g+u.shift(),_=m+u.shift(),w=v+u.shift(),y=_+u.shift(),A=w+u.shift(),V=y+u.shift(),b=A+u.shift(),S=V+u.shift(),E=b+u.shift(),x=S+u.shift(),g=E+u.shift(),m=x+u.shift(),u.shift(),e.U.P.curveTo(l,v,_,w,y,A,V),e.U.P.curveTo(l,b,S,E,x,g,m)),P=="o1236"&&(v=g+u.shift(),_=m+u.shift(),w=v+u.shift(),V=y=_+u.shift(),S=y,E=(b=(A=w+u.shift())+u.shift())+u.shift(),x=S+u.shift(),g=E+u.shift(),e.U.P.curveTo(l,v,_,w,y,A,V),e.U.P.curveTo(l,b,S,E,x,g,m)),P=="o1237"&&(v=g+u.shift(),_=m+u.shift(),w=v+u.shift(),y=_+u.shift(),A=w+u.shift(),V=y+u.shift(),b=A+u.shift(),S=V+u.shift(),E=b+u.shift(),x=S+u.shift(),Math.abs(E-g)>Math.abs(x-m)?g=E+u.shift():m=x+u.shift(),e.U.P.curveTo(l,v,_,w,y,A,V),e.U.P.curveTo(l,b,S,E,x,g,m));else if(P=="o14"){if(u.length>0&&!f&&(d=u.shift()+o.nominalWidthX,f=!0),u.length==4){var B=u.shift(),q=u.shift(),$=u.shift(),R=u.shift(),O=e.CFF.glyphBySE(o,$),D=e.CFF.glyphBySE(o,R);e.U._drawCFF(o.CharStrings[O],a,o,s,l),a.x=B,a.y=q,e.U._drawCFF(o.CharStrings[D],a,o,s,l)}h&&(e.U.P.closePath(l),h=!1)}else if(P=="o19"||P=="o20")u.length%2!=0&&!f&&(d=u.shift()+s.nominalWidthX),c+=u.length>>1,u.length=0,f=!0,p+=c+7>>3;else if(P=="o21")u.length>2&&!f&&(d=u.shift()+s.nominalWidthX,f=!0),m+=u.pop(),g+=u.pop(),h&&e.U.P.closePath(l),e.U.P.moveTo(l,g,m),h=!0;else if(P=="o22")u.length>1&&!f&&(d=u.shift()+s.nominalWidthX,f=!0),g+=u.pop(),h&&e.U.P.closePath(l),e.U.P.moveTo(l,g,m),h=!0;else if(P=="o25"){for(;u.length>6;)g+=u.shift(),m+=u.shift(),e.U.P.lineTo(l,g,m);v=g+u.shift(),_=m+u.shift(),w=v+u.shift(),y=_+u.shift(),g=w+u.shift(),m=y+u.shift(),e.U.P.curveTo(l,v,_,w,y,g,m)}else if(P=="o26")for(u.length%2&&(g+=u.shift());u.length>0;)v=g,_=m+u.shift(),g=w=v+u.shift(),m=(y=_+u.shift())+u.shift(),e.U.P.curveTo(l,v,_,w,y,g,m);else if(P=="o27")for(u.length%2&&(m+=u.shift());u.length>0;)_=m,w=(v=g+u.shift())+u.shift(),y=_+u.shift(),g=w+u.shift(),m=y,e.U.P.curveTo(l,v,_,w,y,g,m);else if(P=="o10"||P=="o29"){var T=P=="o10"?s:o;if(u.length==0)console.debug("error: empty stack");else{var C=u.pop(),j=T.Subrs[C+T.Bias];a.x=g,a.y=m,a.nStems=c,a.haveWidth=f,a.width=d,a.open=h,e.U._drawCFF(j,a,o,s,l),g=a.x,m=a.y,c=a.nStems,f=a.haveWidth,d=a.width,h=a.open}}else if(P=="o30"||P=="o31"){var k=u.length,z=(G=0,P=="o31");for(G+=k-(N=-3&k);G<N;)z?(_=m,w=(v=g+u.shift())+u.shift(),m=(y=_+u.shift())+u.shift(),N-G==5?(g=w+u.shift(),G++):g=w,z=!1):(v=g,_=m+u.shift(),w=v+u.shift(),y=_+u.shift(),g=w+u.shift(),N-G==5?(m=y+u.shift(),G++):m=y,z=!0),e.U.P.curveTo(l,v,_,w,y,g,m),G+=4}else{if((P+"").charAt(0)=="o")throw console.debug("Unknown operation: "+P,i),P;u.push(P)}}}a.x=g,a.y=m,a.nStems=c,a.haveWidth=f,a.width=d,a.open=h};var n=e,r={Typr:n};return t.Typr=n,t.default=r,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function o2(){return function(t){var e=Uint8Array,n=Uint16Array,r=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(P,N){for(var W=new n(31),H=0;H<31;++H)W[H]=N+=1<<P[H-1];var L=new r(W[30]);for(H=1;H<30;++H)for(var G=W[H];G<W[H+1];++G)L[G]=G-W[H]<<5|H;return[W,L]},l=s(i,2),u=l[0],c=l[1];u[28]=258,c[258]=28;for(var f=s(a,0)[0],d=new n(32768),h=0;h<32768;++h){var p=(43690&h)>>>1|(21845&h)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,d[h]=((65280&p)>>>8|(255&p)<<8)>>>1}var g=function(P,N,W){for(var H=P.length,L=0,G=new n(N);L<H;++L)++G[P[L]-1];var B,q=new n(N);for(L=0;L<N;++L)q[L]=q[L-1]+G[L-1]<<1;if(W){B=new n(1<<N);var $=15-N;for(L=0;L<H;++L)if(P[L])for(var R=L<<4|P[L],O=N-P[L],D=q[P[L]-1]++<<O,T=D|(1<<O)-1;D<=T;++D)B[d[D]>>>$]=R}else for(B=new n(H),L=0;L<H;++L)P[L]&&(B[L]=d[q[P[L]-1]++]>>>15-P[L]);return B},m=new e(288);for(h=0;h<144;++h)m[h]=8;for(h=144;h<256;++h)m[h]=9;for(h=256;h<280;++h)m[h]=7;for(h=280;h<288;++h)m[h]=8;var v=new e(32);for(h=0;h<32;++h)v[h]=5;var _=g(m,9,1),w=g(v,5,1),y=function(P){for(var N=P[0],W=1;W<P.length;++W)P[W]>N&&(N=P[W]);return N},b=function(P,N,W){var H=N/8|0;return(P[H]|P[H+1]<<8)>>(7&N)&W},S=function(P,N){var W=N/8|0;return(P[W]|P[W+1]<<8|P[W+2]<<16)>>(7&N)},E=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],x=function(P,N,W){var H=new Error(N||E[P]);if(H.code=P,Error.captureStackTrace&&Error.captureStackTrace(H,x),!W)throw H;return H},A=function(P,N,W){var H=P.length;if(!H||W&&!W.l&&H<5)return N||new e(0);var L=!N||W,G=!W||W.i;W||(W={}),N||(N=new e(3*H));var B,q=function(_e){var Ne=N.length;if(_e>Ne){var $e=new e(Math.max(2*Ne,_e));$e.set(N),N=$e}},$=W.f||0,R=W.p||0,O=W.b||0,D=W.l,T=W.d,C=W.m,j=W.n,k=8*H;do{if(!D){W.f=$=b(P,R,1);var z=b(P,R+1,3);if(R+=3,!z){var J=P[(oe=((B=R)/8|0)+(7&B&&1)+4)-4]|P[oe-3]<<8,Q=oe+J;if(Q>H){G&&x(0);break}L&&q(O+J),N.set(P.subarray(oe,Q),O),W.b=O+=J,W.p=R=8*Q;continue}if(z==1)D=_,T=w,C=9,j=5;else if(z==2){var X=b(P,R,31)+257,Y=b(P,R+10,15)+4,ae=X+b(P,R+5,31)+1;R+=14;for(var te=new e(ae),K=new e(19),U=0;U<Y;++U)K[o[U]]=b(P,R+3*U,7);R+=3*Y;var M=y(K),Z=(1<<M)-1,ie=g(K,M,1);for(U=0;U<ae;){var oe,ne=ie[b(P,R,Z)];if(R+=15&ne,(oe=ne>>>4)<16)te[U++]=oe;else{var de=0,ce=0;for(oe==16?(ce=3+b(P,R,3),R+=2,de=te[U-1]):oe==17?(ce=3+b(P,R,7),R+=3):oe==18&&(ce=11+b(P,R,127),R+=7);ce--;)te[U++]=de}}var pe=te.subarray(0,X),fe=te.subarray(X);C=y(pe),j=y(fe),D=g(pe,C,1),T=g(fe,j,1)}else x(1);if(R>k){G&&x(0);break}}L&&q(O+131072);for(var Pe=(1<<C)-1,xe=(1<<j)-1,me=R;;me=R){var Ae=(de=D[S(P,R)&Pe])>>>4;if((R+=15&de)>k){G&&x(0);break}if(de||x(2),Ae<256)N[O++]=Ae;else{if(Ae==256){me=R,D=null;break}var Re=Ae-254;if(Ae>264){var at=i[U=Ae-257];Re=b(P,R,(1<<at)-1)+u[U],R+=at}var Se=T[S(P,R)&xe],Ye=Se>>>4;if(Se||x(3),R+=15&Se,fe=f[Ye],Ye>3&&(at=a[Ye],fe+=S(P,R)&(1<<at)-1,R+=at),R>k){G&&x(0);break}L&&q(O+131072);for(var Oe=O+Re;O<Oe;O+=4)N[O]=N[O-fe],N[O+1]=N[O+1-fe],N[O+2]=N[O+2-fe],N[O+3]=N[O+3-fe];O=Oe}}W.l=D,W.p=me,W.b=O,D&&($=1,W.m=C,W.d=T,W.n=j)}while(!$);return O==N.length?N:function(_e,Ne,$e){(Ne==null||Ne<0)&&(Ne=0),($e==null||$e>_e.length)&&($e=_e.length);var ot=new(_e instanceof n?n:_e instanceof r?r:e)($e-Ne);return ot.set(_e.subarray(Ne,$e)),ot}(N,0,O)},V=new e(0),F=typeof TextDecoder<"u"&&new TextDecoder;try{F.decode(V,{stream:!0})}catch{}return t.convert_streams=function(P){var N=new DataView(P),W=0;function H(){var X=N.getUint16(W);return W+=2,X}function L(){var X=N.getUint32(W);return W+=4,X}function G(X){J.setUint16(Q,X),Q+=2}function B(X){J.setUint32(Q,X),Q+=4}for(var q={signature:L(),flavor:L(),length:L(),numTables:H(),reserved:H(),totalSfntSize:L(),majorVersion:H(),minorVersion:H(),metaOffset:L(),metaLength:L(),metaOrigLength:L(),privOffset:L(),privLength:L()},$=0;Math.pow(2,$)<=q.numTables;)$++;$--;for(var R=16*Math.pow(2,$),O=16*q.numTables-R,D=12,T=[],C=0;C<q.numTables;C++)T.push({tag:L(),offset:L(),compLength:L(),origLength:L(),origChecksum:L()}),D+=16;var j,k=new Uint8Array(12+16*T.length+T.reduce(function(X,Y){return X+Y.origLength+4},0)),z=k.buffer,J=new DataView(z),Q=0;return B(q.flavor),G(q.numTables),G(R),G($),G(O),T.forEach(function(X){B(X.tag),B(X.origChecksum),B(D),B(X.origLength),X.outOffset=D,(D+=X.origLength)%4!=0&&(D+=4-D%4)}),T.forEach(function(X){var Y,ae=P.slice(X.offset,X.offset+X.compLength);if(X.compLength!=X.origLength){var te=new Uint8Array(X.origLength);Y=new Uint8Array(ae,2),A(Y,te)}else te=new Uint8Array(ae);k.set(te,X.outOffset);var K=0;(D=X.outOffset+X.origLength)%4!=0&&(K=4-D%4),k.set(new Uint8Array(K).buffer,X.outOffset+X.origLength),j=D+K}),z.slice(0,j)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function s2(t,e){const n={M:2,L:2,Q:4,C:6,Z:0},r={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,a=2,o=4,s=8,l=16,u=32;let c;function f(b){if(!c){const S={R:a,L:i,D:o,C:l,U:u,T:s};c=new Map;for(let E in r){let x=0;r[E].split(",").forEach(A=>{let[V,F]=A.split("+");V=parseInt(V,36),F=F?parseInt(F,36):0,c.set(x+=V,S[E]);for(let P=F;P--;)c.set(++x,S[E])})}}return c.get(b)||u}const d=1,h=2,p=3,g=4,m=[null,"isol","init","fina","medi"];function v(b){const S=new Uint8Array(b.length);let E=u,x=d,A=-1;for(let V=0;V<b.length;V++){const F=b.codePointAt(V);let P=f(F)|0,N=d;P&s||(E&(i|o|l)?P&(a|o|l)?(N=p,(x===d||x===p)&&S[A]++):P&(i|u)&&(x===h||x===g)&&S[A]--:E&(a|u)&&(x===h||x===g)&&S[A]--,x=S[V]=N,E=P,A=V,F>65535&&V++)}return S}function _(b,S){const E=[];for(let A=0;A<S.length;A++){const V=S.codePointAt(A);V>65535&&A++,E.push(t.U.codeToGlyph(b,V))}const x=b.GSUB;if(x){const{lookupList:A,featureList:V}=x;let F;const P=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,N=[];V.forEach(W=>{if(P.test(W.tag))for(let H=0;H<W.tab.length;H++){if(N[W.tab[H]])continue;N[W.tab[H]]=!0;const L=A[W.tab[H]],G=/^(isol|init|fina|medi)$/.test(W.tag);G&&!F&&(F=v(S));for(let B=0;B<E.length;B++)(!F||!G||m[F[B]]===W.tag)&&t.U._applySubs(E,B,L,A)}})}return E}function w(...b){for(let S=0;S<b.length;S++)if(typeof b[S]=="number")return b[S]}function y(b){const S=Object.create(null),E=b["OS/2"],x=b.hhea,A=b.head.unitsPerEm,V=w(E&&E.sTypoAscender,x&&x.ascender,A),F={unitsPerEm:A,ascender:V,descender:w(E&&E.sTypoDescender,x&&x.descender,0),capHeight:w(E&&E.sCapHeight,V),xHeight:w(E&&E.sxHeight,V),lineGap:w(E&&E.sTypoLineGap,x&&x.lineGap),forEachGlyph(P,N,W,H){let L=0;const G=1/F.unitsPerEm*N,B=_(b,P);let q=0,$=-1;return B.forEach((R,O)=>{if(R!==-1){let D=S[R];if(!D){const{cmds:T,crds:C}=t.U.glyphToPath(b,R);let j="",k=0;for(let Y=0,ae=T.length;Y<ae;Y++){const te=n[T[Y]];j+=T[Y];for(let K=1;K<=te;K++)j+=(K>1?",":"")+C[k++]}let z,J,Q,X;if(C.length){z=J=1/0,Q=X=-1/0;for(let Y=0,ae=C.length;Y<ae;Y+=2){let te=C[Y],K=C[Y+1];te<z&&(z=te),K<J&&(J=K),te>Q&&(Q=te),K>X&&(X=K)}}else z=Q=J=X=0;D=S[R]={index:R,advanceWidth:b.hmtx.aWidth[R],xMin:z,yMin:J,xMax:Q,yMax:X,path:j,pathCommandCount:T.length}}$!==-1&&(L+=t.U.getPairAdjustment(b,$,R)*G),H.call(null,D,L,q),D.advanceWidth&&(L+=D.advanceWidth*G),W&&(L+=W*N),$=R}q+=P.codePointAt(q)>65535?2:1}),L}};return F}return function(S){const E=new Uint8Array(S,0,4),x=t._bin.readASCII(E,0,4);if(x==="wOFF")S=e(S);else if(x==="wOF2")throw new Error("woff2 fonts not supported");return y(t.parse(S)[0])}}const l2=ba({name:"Typr Font Parser",dependencies:[a2,o2,s2],init(t,e,n){const r=t(),i=e();return n(r,i)}}),Dr={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},u2=new Xt;function Er(){return(self.performance||Date).now()}const ld=Object.create(null);function mm(t,e){t=d2({},t);const n=Er();if(t.font=h2(t.font||Dr.defaultFontURL),t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||Dr.sdfGlyphSize,t.colorRanges!=null){let f={};for(let d in t.colorRanges)if(t.colorRanges.hasOwnProperty(d)){let h=t.colorRanges[d];typeof h!="number"&&(h=u2.set(h).getHex()),f[d]=h}t.colorRanges=f}Object.freeze(t);const{textureWidth:r,sdfExponent:i}=Dr,{sdfGlyphSize:a}=t,o=r/a*4;let s=ld[a];if(!s){const f=document.createElement("canvas");f.width=r,f.height=a*256/o,s=ld[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:f,sdfTexture:new lg(f,void 0,void 0,void 0,cl,cl),contextLost:!1,glyphsByFont:new Map},s.sdfTexture.generateMipmaps=!1,c2(s)}const{sdfTexture:l,sdfCanvas:u}=s;let c=s.glyphsByFont.get(t.font);c||s.glyphsByFont.set(t.font,c=new Map),m2(t).then(f=>{const{glyphIds:d,glyphPositions:h,fontSize:p,unitsPerEm:g,timings:m}=f,v=[],_=new Float32Array(d.length*4),w=p/g;let y=0,b=0;const S=Er();d.forEach((F,P)=>{let N=c.get(F);if(!N){const{path:G,pathBounds:B}=f.glyphData[F],q=Math.max(B[2]-B[0],B[3]-B[1])/a*(Dr.sdfMargin*a+.5),$=s.glyphCount++,R=[B[0]-q,B[1]-q,B[2]+q,B[3]+q];c.set(F,N={path:G,atlasIndex:$,sdfViewBox:R}),v.push(N)}const{sdfViewBox:W}=N,H=h[b++],L=h[b++];_[y++]=H+W[0]*w,_[y++]=L+W[1]*w,_[y++]=H+W[2]*w,_[y++]=L+W[3]*w,d[P]=N.atlasIndex}),m.quads=(m.quads||0)+(Er()-S);const E=Er();m.sdf={};const x=u.height,A=Math.ceil(s.glyphCount/o),V=Math.pow(2,Math.ceil(Math.log2(A*a)));V>x&&(console.info(`Increasing SDF texture size ${x}->${V}`),i2(u,r,V),l.dispose()),Promise.all(v.map(F=>gm(F,s,t.gpuAccelerateSDF).then(({timing:P})=>{m.sdf[F.atlasIndex]=P}))).then(()=>{v.length&&!s.contextLost&&(vm(s),l.needsUpdate=!0),m.sdfTotal=Er()-E,m.total=Er()-n,e(Object.freeze({parameters:t,sdfTexture:l,sdfGlyphSize:a,sdfExponent:i,glyphBounds:_,glyphAtlasIndices:d,glyphColors:f.glyphColors,caretPositions:f.caretPositions,caretHeight:f.caretHeight,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{s.contextLost||r2(u)})}function gm({path:t,atlasIndex:e,sdfViewBox:n},{sdfGlyphSize:r,sdfCanvas:i,contextLost:a},o){if(a)return Promise.resolve({timing:-1});const{textureWidth:s,sdfExponent:l}=Dr,u=Math.max(n[2]-n[0],n[3]-n[1]),c=Math.floor(e/4),f=c%(s/r)*r,d=Math.floor(c/(s/r))*r,h=e%4;return Zx(r,r,t,n,u,l,i,f,d,h,o)}function c2(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",n=>{console.log("Context Lost",n),n.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",n=>{console.log("Context Restored",n),t.contextLost=!1;const r=[];t.glyphsByFont.forEach(i=>{i.forEach(a=>{r.push(gm(a,t,!0))})}),Promise.all(r).then(()=>{vm(t),t.sdfTexture.needsUpdate=!0})})}function f2({font:t,characters:e,sdfGlyphSize:n},r){let i=Array.isArray(e)?e.join(`
`):""+e;mm({font:t,sdfGlyphSize:n,text:i},r)}function d2(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}let Wa;function h2(t){return Wa||(Wa=typeof document>"u"?{}:document.createElement("a")),Wa.href=t,Wa.href}function vm(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:n}=t,{width:r,height:i}=e,a=t.sdfCanvas.getContext("webgl");let o=n.image.data;(!o||o.length!==r*i*4)&&(o=new Uint8Array(r*i*4),n.image={width:r,height:i,data:o},n.flipY=!1,n.isDataTexture=!0),a.readPixels(0,0,r,i,a.RGBA,a.UNSIGNED_BYTE,o)}}const p2=ba({name:"Typesetter",dependencies:[Dr,l2,Xx,zx],init(t,e,n,r){const{defaultFontURL:i}=t;return n(e,r(),{defaultFontURL:i})}}),m2=ba({name:"Typesetter",dependencies:[p2],init(t){return function(e){return new Promise(n=>{t.typeset(e,n)})}},getTransferables(t){const e=[t.glyphPositions.buffer,t.glyphIds.buffer];return t.caretPositions&&e.push(t.caretPositions.buffer),t.glyphColors&&e.push(t.glyphColors.buffer),e}}),ud={};function g2(t){let e=ud[t];if(!e){const n=new Xl(1,1,t,t),r=n.clone(),i=n.attributes,a=r.attributes,o=new Yl,s=i.uv.count;for(let l=0;l<s;l++)a.position.array[l*3]*=-1,a.normal.array[l*3+2]*=-1;["position","normal","uv"].forEach(l=>{o.setAttribute(l,new Qa([...i[l].array,...a[l].array],i[l].itemSize))}),o.setIndex([...n.index.array,...r.index.array.map(l=>l+s)]),o.translate(.5,.5,0),e=ud[t]=o}return e}const v2="aTroikaGlyphBounds",cd="aTroikaGlyphIndex",y2="aTroikaGlyphColor";class b2 extends ug{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Vd,this.boundingBox=new Kl}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const n=this.getIndex().count;this.setDrawRange(e===cg?n/2:0,e===yt?n:n/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let n=g2(e);["position","normal","uv"].forEach(r=>{this.attributes[r]=n.attributes[r].clone()}),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,n,r,i,a){el(this,v2,e,4),el(this,cd,n,1),el(this,y2,a,3),this._blockBounds=r,this._chunkedBounds=i,this.instanceCount=n.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:n,boundingBox:r}=this;if(n){const{PI:i,floor:a,min:o,max:s,sin:l,cos:u}=Math,c=i/2,f=i*2,d=Math.abs(n),h=e[0]/d,p=e[2]/d,g=a((h+c)/f)!==a((p+c)/f)?-d:o(l(h)*d,l(p)*d),m=a((h-c)/f)!==a((p-c)/f)?d:s(l(h)*d,l(p)*d),v=a((h+i)/f)!==a((p+i)/f)?d*2:s(d-u(h)*d,d-u(p)*d);r.min.set(g,e[1],n<0?-v:0),r.max.set(m,e[3],n<0?0:v)}else r.min.set(e[0],e[1],0),r.max.set(e[2],e[3],0);r.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let n=this.getAttribute(cd).count,r=this._chunkedBounds;if(r)for(let i=r.length;i--;){n=r[i].end;let a=r[i].rect;if(a[1]<e.w&&a[3]>e.y&&a[0]<e.z&&a[2]>e.x)break}this.instanceCount=n}}function el(t,e,n,r){const i=t.getAttribute(e);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(t.setAttribute(e,new fg(n,r)),delete t._maxInstanceCount,t.dispose()):i&&t.deleteAttribute(e)}const _2=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,w2=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,E2=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,x2=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function T2(t){const e=Fl(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new De},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new fl(0,0,0,0)},uTroikaClipRect:{value:new fl(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new De},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Xt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new ir},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:_2,vertexTransform:w2,fragmentDefs:E2,fragmentColorTransform:x2,customRewriter({vertexShader:n,fragmentShader:r}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(r)&&(r=r.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(n)||(n=n.replace(hm,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:n,fragmentShader:r}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Ku=new dg({color:16777215,side:yt,transparent:!0}),fd=8421504,dd=new Fd,$a=new Ee,tl=new Ee,ki=[],S2=new Ee,nl="+x+y";function hd(t){return Array.isArray(t)?t[0]:t}let ym=()=>{const t=new Cr(new Xl(1,1),Ku);return ym=()=>t,t},bm=()=>{const t=new Cr(new Xl(1,1,32,1),Ku);return bm=()=>t,t};const A2={type:"syncstart"},k2={type:"synccomplete"},_m=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],O2=_m.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let wm=class extends Cr{constructor(){const e=new b2;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=fd,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=nl,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(A2),mm({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},n=>{this._isSyncing=!1,this._textRenderInfo=n,this.geometry.updateGlyphs(n.glyphBounds,n.glyphAtlasIndices,n.blockBounds,n.chunkedBounds,n.glyphColors);const r=this._queuedSyncs;r&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{r.forEach(i=>i&&i())})),this.dispatchEvent(k2),e&&e()})))}onBeforeRender(e,n,r,i,a,o){this.sync(),a.isTroikaTextMaterial&&this._prepareForRender(a),a._hadOwnSide=a.hasOwnProperty("side"),this.geometry.setSide(a._actualSide=a.side),a.side=sg}onAfterRender(e,n,r,i,a,o){a._hadOwnSide?a.side=a._actualSide:delete a.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Ku.clone());if((!e||e.baseMaterial!==n)&&(e=this._derivedMaterial=T2(n),n.addEventListener("dispose",function r(){n.removeEventListener("dispose",r),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let r=e._outlineMtl;return r||(r=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),r.isTextOutlineMaterial=!0,r.depthWrite=!1,r.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),r.dispose()})),[r,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return hd(this.material).getDepthMaterial()}get customDistanceMaterial(){return hd(this.material).getDistanceMaterial()}_prepareForRender(e){const n=e.isTextOutlineMaterial,r=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:s,blockBounds:l}=i;r.uTroikaSDFTexture.value=s,r.uTroikaSDFTextureSize.value.set(s.image.width,s.image.height),r.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,r.uTroikaSDFExponent.value=i.sdfExponent,r.uTroikaTotalBounds.value.fromArray(l),r.uTroikaUseGlyphColors.value=!n&&!!i.glyphColors;let u=0,c=0,f=0,d,h,p,g=0,m=0;if(n){let{outlineWidth:_,outlineOffsetX:w,outlineOffsetY:y,outlineBlur:b,outlineOpacity:S}=this;u=this._parsePercent(_)||0,c=Math.max(0,this._parsePercent(b)||0),d=S,g=this._parsePercent(w)||0,m=this._parsePercent(y)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(p=this.strokeColor,r.uTroikaStrokeColor.value.set(p??fd),h=this.strokeOpacity,h==null&&(h=1)),d=this.fillOpacity;r.uTroikaDistanceOffset.value=u,r.uTroikaPositionOffset.value.set(g,m),r.uTroikaBlurRadius.value=c,r.uTroikaStrokeWidth.value=f,r.uTroikaStrokeOpacity.value=h,r.uTroikaFillOpacity.value=d??1,r.uTroikaCurveRadius.value=this.curveRadius||0;let v=this.clipRect;if(v&&Array.isArray(v)&&v.length===4)r.uTroikaClipRect.value.fromArray(v);else{const _=(this.fontSize||.1)*100;r.uTroikaClipRect.value.set(l[0]-_,l[1]-_,l[2]+_,l[3]+_)}this.geometry.applyClipRect(r.uTroikaClipRect.value)}r.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const a=n?this.outlineColor||0:this.color;if(a==null)delete e.color;else{const s=e.hasOwnProperty("color")?e.color:e.color=new Xt;(a!==s._input||typeof a=="object")&&s.set(s._input=a)}let o=this.orientation||nl;if(o!==e._orientation){let s=r.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==nl&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,u,c,f,d]=l;$a.set(0,0,0)[c]=u==="-"?1:-1,tl.set(0,0,0)[d]=f==="-"?-1:1,dd.lookAt(S2,$a.cross(tl),tl),s.setFromMatrix4(dd)}else s.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let n=e.match(/^(-?[\d.]+)%$/),r=n?parseFloat(n[1]):NaN;e=(isNaN(r)?0:r/100)*this.fontSize}return e}localPositionToTextCoords(e,n=new De){n.copy(e);const r=this.curveRadius;return r&&(n.x=Math.atan2(e.x,Math.abs(r)-Math.abs(e.z))*Math.abs(r)),n}worldPositionToTextCoords(e,n=new De){return $a.copy(e),this.localPositionToTextCoords(this.worldToLocal($a),n)}raycast(e,n){const{textRenderInfo:r,curveRadius:i}=this;if(r){const a=r.blockBounds,o=i?bm():ym(),s=o.geometry,{position:l,uv:u}=s.attributes;for(let c=0;c<u.count;c++){let f=a[0]+u.getX(c)*(a[2]-a[0]);const d=a[1]+u.getY(c)*(a[3]-a[1]);let h=0;i&&(h=i-Math.cos(f/i)*i,f=Math.sin(f/i)*i),l.setXYZ(c,f,d,h)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,ki.length=0,o.raycast(e,ki);for(let c=0;c<ki.length;c++)ki[c].object=this,n.push(ki[c])}}copy(e){const n=this.geometry;return super.copy(e),this.geometry=n,O2.forEach(r=>{this[r]=e[r]}),this}clone(){return new this.constructor().copy(this)}};_m.forEach(t=>{const e="_private_"+t;Object.defineProperty(wm.prototype,t,{get(){return this[e]},set(n){n!==this[e]&&(this[e]=n,this._needsSync=!0)}})});const D2=I.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:n="middle",font:r,fontSize:i=1,children:a,characters:o,onSync:s,...l},u)=>{const c=xt(({invalidate:p})=>p),[f]=I.useState(()=>new wm),[d,h]=I.useMemo(()=>{const p=[];let g="";return I.Children.forEach(a,m=>{typeof m=="string"||typeof m=="number"?g+=m:p.push(m)}),[p,g]},[a]);return hg(()=>new Promise(p=>f2({font:r,characters:o},p)),["troika-text",r,o]),I.useLayoutEffect(()=>void f.sync(()=>{c(),s&&s(f)})),I.useEffect(()=>()=>f.dispose(),[f]),I.createElement("primitive",yn({object:f,ref:u,font:r,text:h,anchorX:e,anchorY:n,fontSize:i,sdfGlyphSize:t},l),d)}),C2=I.forwardRef(function({src:e,skipFill:n,skipStrokes:r,fillMaterial:i,strokeMaterial:a,fillMeshProps:o,strokeMeshProps:s,...l},u){const c=pg(ji,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),f=I.useMemo(()=>r?[]:c.paths.map(d=>{var h;return((h=d.userData)==null?void 0:h.style.stroke)===void 0||d.userData.style.stroke==="none"?null:d.subPaths.map(p=>ji.pointsToStroke(p.getPoints(),d.userData.style))}),[c,r]);return I.useEffect(()=>()=>f.forEach(d=>d&&d.map(h=>h.dispose())),[f]),I.createElement("object3D",yn({ref:u},l),I.createElement("object3D",{scale:[1,-1,1]},c.paths.map((d,h)=>{var p,g;return I.createElement(I.Fragment,{key:h},!n&&((p=d.userData)==null?void 0:p.style.fill)!==void 0&&d.userData.style.fill!=="none"&&ji.createShapes(d).map((m,v)=>I.createElement("mesh",yn({key:v},o),I.createElement("shapeGeometry",{args:[m]}),I.createElement("meshBasicMaterial",yn({color:d.userData.style.fill,opacity:d.userData.style.fillOpacity,transparent:!0,side:yt,depthWrite:!1},i)))),!r&&((g=d.userData)==null?void 0:g.style.stroke)!==void 0&&d.userData.style.stroke!=="none"&&d.subPaths.map((m,v)=>I.createElement("mesh",yn({key:v,geometry:f[h][v]},s),I.createElement("meshBasicMaterial",yn({color:d.userData.style.stroke,opacity:d.userData.style.strokeOpacity,transparent:!0,side:yt,depthWrite:!1},a)))))})))});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const be={LEFT:1,RIGHT:2,MIDDLE:4},ee=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),xr={NONE:0,IN:1,OUT:-1};function nr(t){return t.isPerspectiveCamera}function zn(t){return t.isOrthographicCamera}const Tr=Math.PI*2,pd=Math.PI/2,Em=1e-5,Oi=Math.PI/180;function mn(t,e,n){return Math.max(e,Math.min(n,t))}function He(t,e=Em){return Math.abs(t)<e}function Fe(t,e,n=Em){return He(t-e,n)}function md(t,e){return Math.round(t/e)*e}function Di(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Ci(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function Ha(t,e,n,r,i=1/0,a){r=Math.max(1e-4,r);const o=2/r,s=o*a,l=1/(1+s+.48*s*s+.235*s*s*s);let u=t-e;const c=e,f=i*r;u=mn(u,-f,f),e=t-u;const d=(n.value+o*u)*a;n.value=(n.value-o*d)*l;let h=e+(u+d)*l;return c-t>0==h>c&&(h=c,n.value=(h-c)/a),h}function gd(t,e,n,r,i=1/0,a,o){r=Math.max(1e-4,r);const s=2/r,l=s*a,u=1/(1+l+.48*l*l+.235*l*l*l);let c=e.x,f=e.y,d=e.z,h=t.x-c,p=t.y-f,g=t.z-d;const m=c,v=f,_=d,w=i*r,y=w*w,b=h*h+p*p+g*g;if(b>y){const H=Math.sqrt(b);h=h/H*w,p=p/H*w,g=g/H*w}c=t.x-h,f=t.y-p,d=t.z-g;const S=(n.x+s*h)*a,E=(n.y+s*p)*a,x=(n.z+s*g)*a;n.x=(n.x-s*S)*u,n.y=(n.y-s*E)*u,n.z=(n.z-s*x)*u,o.x=c+(h+S)*u,o.y=f+(p+E)*u,o.z=d+(g+x)*u;const A=m-t.x,V=v-t.y,F=_-t.z,P=o.x-m,N=o.y-v,W=o.z-_;return A*P+V*N+F*W>0&&(o.x=m,o.y=v,o.z=_,n.x=(o.x-m)/a,n.y=(o.y-v)/a,n.z=(o.z-_)/a),o}function rl(t,e){e.set(0,0),t.forEach(n=>{e.x+=n.clientX,e.y+=n.clientY}),e.x/=t.length,e.y/=t.length}function il(t,e){return zn(t)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}let P2=class{constructor(){this._listeners={}}addEventListener(e,n){const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e)}}};const M2="2.7.0",Ya=1/8,xm=typeof window<"u",R2=xm&&/Mac/.test(navigator.platform),I2=!(xm&&"PointerEvent"in window);let ye,vd,Ka,al,Dt,Te,Me,Sr,Pi,hn,pn,rr,yd,bd,zt,Mi,Ar,_d,ol,wd,sl,ll,Xa,qn=class Nl extends P2{static install(e){ye=e.THREE,vd=Object.freeze(new ye.Vector3(0,0,0)),Ka=Object.freeze(new ye.Vector3(0,1,0)),al=Object.freeze(new ye.Vector3(0,0,1)),Dt=new ye.Vector2,Te=new ye.Vector3,Me=new ye.Vector3,Sr=new ye.Vector3,Pi=new ye.Vector3,hn=new ye.Vector3,pn=new ye.Vector3,rr=new ye.Vector3,yd=new ye.Vector3,bd=new ye.Vector3,zt=new ye.Spherical,Mi=new ye.Spherical,Ar=new ye.Box3,_d=new ye.Box3,ol=new ye.Sphere,wd=new ye.Quaternion,sl=new ye.Quaternion,ll=new ye.Matrix4,Xa=new ye.Raycaster}static get ACTION(){return ee}constructor(e,n){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=ee.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=xr.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new ye.Vector3,this._focalOffsetVelocity=new ye.Vector3,this._zoomVelocity={value:0},this._truckInternal=(y,b,S)=>{let E,x;if(nr(this._camera)){const A=Te.copy(this._camera.position).sub(this._target),V=this._camera.getEffectiveFOV()*Oi,F=A.length()*Math.tan(V*.5);E=this.truckSpeed*y*F/this._elementRect.height,x=this.truckSpeed*b*F/this._elementRect.height}else if(zn(this._camera)){const A=this._camera;E=y*(A.right-A.left)/A.zoom/this._elementRect.width,x=b*(A.top-A.bottom)/A.zoom/this._elementRect.height}else return;this.verticalDragToForward?(S?this.setFocalOffset(this._focalOffsetEnd.x+E,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(E,0,!0),this.forward(-x,!0)):S?this.setFocalOffset(this._focalOffsetEnd.x+E,this._focalOffsetEnd.y+x,this._focalOffsetEnd.z,!0):this.truck(E,x,!0)},this._rotateInternal=(y,b)=>{const S=Tr*this.azimuthRotateSpeed*y/this._elementRect.height,E=Tr*this.polarRotateSpeed*b/this._elementRect.height;this.rotate(S,E,!0)},this._dollyInternal=(y,b,S)=>{const E=Math.pow(.95,-y*this.dollySpeed),x=this._sphericalEnd.radius,A=this._sphericalEnd.radius*E,V=ye.MathUtils.clamp(A,this.minDistance,this.maxDistance),F=V-A;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(A,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(F,!0),this._dollyToNoClamp(V,!0)):this._dollyToNoClamp(V,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?A:V)-x,this._dollyControlCoord.set(b,S)),this._lastDollyDirection=Math.sign(-y)},this._zoomInternal=(y,b,S)=>{const E=Math.pow(.95,y*this.dollySpeed),x=this._zoom,A=this._zoom*E;this.zoomTo(A,!0),this.dollyToCursor&&(this._changedZoom+=A-x,this._dollyControlCoord.set(b,S))},typeof ye>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new ye.Quaternion().setFromUnitVectors(this._camera.up,Ka),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=ee.NONE,this._target=new ye.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new ye.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new ye.Spherical().setFromVector3(Te.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new ye.Vector3,new ye.Vector3,new ye.Vector3,new ye.Vector3],this._updateNearPlaneCorners(),this._boundary=new ye.Box3(new ye.Vector3(-1/0,-1/0,-1/0),new ye.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new ye.Vector2,this.mouseButtons={left:ee.ROTATE,middle:ee.DOLLY,right:ee.TRUCK,wheel:nr(this._camera)?ee.DOLLY:zn(this._camera)?ee.ZOOM:ee.NONE},this.touches={one:ee.TOUCH_ROTATE,two:nr(this._camera)?ee.TOUCH_DOLLY_TRUCK:zn(this._camera)?ee.TOUCH_ZOOM_TRUCK:ee.NONE,three:ee.TOUCH_TRUCK};const r=new ye.Vector2,i=new ye.Vector2,a=new ye.Vector2,o=y=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const E=this._domElement.getBoundingClientRect(),x=y.clientX/E.width,A=y.clientY/E.height;if(x<this._interactiveArea.left||x>this._interactiveArea.right||A<this._interactiveArea.top||A>this._interactiveArea.bottom)return}const b=y.pointerType!=="mouse"?null:(y.buttons&be.LEFT)===be.LEFT?be.LEFT:(y.buttons&be.MIDDLE)===be.MIDDLE?be.MIDDLE:(y.buttons&be.RIGHT)===be.RIGHT?be.RIGHT:null;if(b!==null){const E=this._findPointerByMouseButton(b);E&&this._disposePointer(E)}if((y.buttons&be.LEFT)===be.LEFT&&this._lockedPointer)return;const S={pointerId:y.pointerId,clientX:y.clientX,clientY:y.clientY,deltaX:0,deltaY:0,mouseButton:b};this._activePointers.push(S),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),this._isDragging=!0,g(y)},s=y=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const E=this._domElement.getBoundingClientRect(),x=y.clientX/E.width,A=y.clientY/E.height;if(x<this._interactiveArea.left||x>this._interactiveArea.right||A<this._interactiveArea.top||A>this._interactiveArea.bottom)return}const b=(y.buttons&be.LEFT)===be.LEFT?be.LEFT:(y.buttons&be.MIDDLE)===be.MIDDLE?be.MIDDLE:(y.buttons&be.RIGHT)===be.RIGHT?be.RIGHT:null;if(b!==null){const E=this._findPointerByMouseButton(b);E&&this._disposePointer(E)}const S={pointerId:1,clientX:y.clientX,clientY:y.clientY,deltaX:0,deltaY:0,mouseButton:(y.buttons&be.LEFT)===be.LEFT?be.LEFT:(y.buttons&be.MIDDLE)===be.LEFT?be.MIDDLE:(y.buttons&be.RIGHT)===be.LEFT?be.RIGHT:null};this._activePointers.push(S),this._domElement.ownerDocument.removeEventListener("mousemove",u),this._domElement.ownerDocument.removeEventListener("mouseup",f),this._domElement.ownerDocument.addEventListener("mousemove",u),this._domElement.ownerDocument.addEventListener("mouseup",f),this._isDragging=!0,g(y)},l=y=>{y.cancelable&&y.preventDefault();const b=y.pointerId,S=this._lockedPointer||this._findPointerById(b);if(S){if(S.clientX=y.clientX,S.clientY=y.clientY,S.deltaX=y.movementX,S.deltaY=y.movementY,this._state=0,y.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(y.buttons&be.LEFT)===be.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(y.buttons&be.MIDDLE)===be.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(y.buttons&be.RIGHT)===be.RIGHT&&(this._state=this._state|this.mouseButtons.right);m()}},u=y=>{const b=this._lockedPointer||this._findPointerById(1);b&&(b.clientX=y.clientX,b.clientY=y.clientY,b.deltaX=y.movementX,b.deltaY=y.movementY,this._state=0,(this._lockedPointer||(y.buttons&be.LEFT)===be.LEFT)&&(this._state=this._state|this.mouseButtons.left),(y.buttons&be.MIDDLE)===be.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(y.buttons&be.RIGHT)===be.RIGHT&&(this._state=this._state|this.mouseButtons.right),m())},c=y=>{const b=this._findPointerById(y.pointerId);if(!(b&&b===this._lockedPointer)){if(b&&this._disposePointer(b),y.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=ee.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=ee.NONE;v()}},f=()=>{const y=this._findPointerById(1);y&&y===this._lockedPointer||(y&&this._disposePointer(y),this._state=ee.NONE,v())};let d=-1;const h=y=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===ee.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const A=this._domElement.getBoundingClientRect(),V=y.clientX/A.width,F=y.clientY/A.height;if(V<this._interactiveArea.left||V>this._interactiveArea.right||F<this._interactiveArea.top||F>this._interactiveArea.bottom)return}if(y.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===ee.ROTATE||this.mouseButtons.wheel===ee.TRUCK){const A=performance.now();d-A<1e3&&this._getClientRect(this._elementRect),d=A}const b=R2?-1:-3,S=y.deltaMode===1?y.deltaY/b:y.deltaY/(b*10),E=this.dollyToCursor?(y.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,x=this.dollyToCursor?(y.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case ee.ROTATE:{this._rotateInternal(y.deltaX,y.deltaY),this._isUserControllingRotate=!0;break}case ee.TRUCK:{this._truckInternal(y.deltaX,y.deltaY,!1),this._isUserControllingTruck=!0;break}case ee.OFFSET:{this._truckInternal(y.deltaX,y.deltaY,!0),this._isUserControllingOffset=!0;break}case ee.DOLLY:{this._dollyInternal(-S,E,x),this._isUserControllingDolly=!0;break}case ee.ZOOM:{this._zoomInternal(-S,E,x),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},p=y=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Nl.ACTION.NONE){const b=y instanceof PointerEvent?y.pointerId:(y instanceof MouseEvent,0),S=this._findPointerById(b);S&&this._disposePointer(S),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mousemove",u),this._domElement.ownerDocument.removeEventListener("mouseup",f);return}y.preventDefault()}},g=y=>{if(!this._enabled)return;if(rl(this._activePointers,Dt),this._getClientRect(this._elementRect),r.copy(Dt),i.copy(Dt),this._activePointers.length>=2){const S=Dt.x-this._activePointers[1].clientX,E=Dt.y-this._activePointers[1].clientY,x=Math.sqrt(S*S+E*E);a.set(0,x);const A=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,V=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;i.set(A,V)}if(this._state=0,!y)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in y&&y.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(y.buttons&be.LEFT)===be.LEFT&&(this._state=this._state|this.mouseButtons.left),(y.buttons&be.MIDDLE)===be.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(y.buttons&be.RIGHT)===be.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&ee.ROTATE)===ee.ROTATE||(this._state&ee.TOUCH_ROTATE)===ee.TOUCH_ROTATE||(this._state&ee.TOUCH_DOLLY_ROTATE)===ee.TOUCH_DOLLY_ROTATE||(this._state&ee.TOUCH_ZOOM_ROTATE)===ee.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&ee.TRUCK)===ee.TRUCK||(this._state&ee.TOUCH_TRUCK)===ee.TOUCH_TRUCK||(this._state&ee.TOUCH_DOLLY_TRUCK)===ee.TOUCH_DOLLY_TRUCK||(this._state&ee.TOUCH_ZOOM_TRUCK)===ee.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&ee.DOLLY)===ee.DOLLY||(this._state&ee.TOUCH_DOLLY)===ee.TOUCH_DOLLY||(this._state&ee.TOUCH_DOLLY_TRUCK)===ee.TOUCH_DOLLY_TRUCK||(this._state&ee.TOUCH_DOLLY_OFFSET)===ee.TOUCH_DOLLY_OFFSET||(this._state&ee.TOUCH_DOLLY_ROTATE)===ee.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&ee.ZOOM)===ee.ZOOM||(this._state&ee.TOUCH_ZOOM)===ee.TOUCH_ZOOM||(this._state&ee.TOUCH_ZOOM_TRUCK)===ee.TOUCH_ZOOM_TRUCK||(this._state&ee.TOUCH_ZOOM_OFFSET)===ee.TOUCH_ZOOM_OFFSET||(this._state&ee.TOUCH_ZOOM_ROTATE)===ee.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&ee.OFFSET)===ee.OFFSET||(this._state&ee.TOUCH_OFFSET)===ee.TOUCH_OFFSET||(this._state&ee.TOUCH_DOLLY_OFFSET)===ee.TOUCH_DOLLY_OFFSET||(this._state&ee.TOUCH_ZOOM_OFFSET)===ee.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},m=()=>{if(!this._enabled)return;rl(this._activePointers,Dt);const b=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,S=b?-b.deltaX:i.x-Dt.x,E=b?-b.deltaY:i.y-Dt.y;if(i.copy(Dt),((this._state&ee.ROTATE)===ee.ROTATE||(this._state&ee.TOUCH_ROTATE)===ee.TOUCH_ROTATE||(this._state&ee.TOUCH_DOLLY_ROTATE)===ee.TOUCH_DOLLY_ROTATE||(this._state&ee.TOUCH_ZOOM_ROTATE)===ee.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(S,E),this._isUserControllingRotate=!0),(this._state&ee.DOLLY)===ee.DOLLY||(this._state&ee.ZOOM)===ee.ZOOM){const x=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,A=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0,V=this.dollyDragInverted?-1:1;(this._state&ee.DOLLY)===ee.DOLLY?(this._dollyInternal(V*E*Ya,x,A),this._isUserControllingDolly=!0):(this._zoomInternal(V*E*Ya,x,A),this._isUserControllingZoom=!0)}if((this._state&ee.TOUCH_DOLLY)===ee.TOUCH_DOLLY||(this._state&ee.TOUCH_ZOOM)===ee.TOUCH_ZOOM||(this._state&ee.TOUCH_DOLLY_TRUCK)===ee.TOUCH_DOLLY_TRUCK||(this._state&ee.TOUCH_ZOOM_TRUCK)===ee.TOUCH_ZOOM_TRUCK||(this._state&ee.TOUCH_DOLLY_OFFSET)===ee.TOUCH_DOLLY_OFFSET||(this._state&ee.TOUCH_ZOOM_OFFSET)===ee.TOUCH_ZOOM_OFFSET||(this._state&ee.TOUCH_DOLLY_ROTATE)===ee.TOUCH_DOLLY_ROTATE||(this._state&ee.TOUCH_ZOOM_ROTATE)===ee.TOUCH_ZOOM_ROTATE){const x=Dt.x-this._activePointers[1].clientX,A=Dt.y-this._activePointers[1].clientY,V=Math.sqrt(x*x+A*A),F=a.y-V;a.set(0,V);const P=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,N=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&ee.TOUCH_DOLLY)===ee.TOUCH_DOLLY||(this._state&ee.TOUCH_DOLLY_ROTATE)===ee.TOUCH_DOLLY_ROTATE||(this._state&ee.TOUCH_DOLLY_TRUCK)===ee.TOUCH_DOLLY_TRUCK||(this._state&ee.TOUCH_DOLLY_OFFSET)===ee.TOUCH_DOLLY_OFFSET?(this._dollyInternal(F*Ya,P,N),this._isUserControllingDolly=!0):(this._zoomInternal(F*Ya,P,N),this._isUserControllingZoom=!0)}((this._state&ee.TRUCK)===ee.TRUCK||(this._state&ee.TOUCH_TRUCK)===ee.TOUCH_TRUCK||(this._state&ee.TOUCH_DOLLY_TRUCK)===ee.TOUCH_DOLLY_TRUCK||(this._state&ee.TOUCH_ZOOM_TRUCK)===ee.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(S,E,!1),this._isUserControllingTruck=!0),((this._state&ee.OFFSET)===ee.OFFSET||(this._state&ee.TOUCH_OFFSET)===ee.TOUCH_OFFSET||(this._state&ee.TOUCH_DOLLY_OFFSET)===ee.TOUCH_DOLLY_OFFSET||(this._state&ee.TOUCH_ZOOM_OFFSET)===ee.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(S,E,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},v=()=>{rl(this._activePointers,Dt),i.copy(Dt),(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",u),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mouseup",f),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",_),this._domElement.ownerDocument.addEventListener("pointerlockerror",w),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),g())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",_),this._domElement.ownerDocument.removeEventListener("pointerlockerror",w))};const _=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},w=()=>{this.unlockPointer()};this._addAllEventListeners=y=>{this._domElement=y,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),I2&&this._domElement.addEventListener("mousedown",s),this._domElement.addEventListener("pointercancel",c),this._domElement.addEventListener("wheel",h,{passive:!1}),this._domElement.addEventListener("contextmenu",p)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",s),this._domElement.removeEventListener("pointercancel",c),this._domElement.removeEventListener("wheel",h,{passive:!1}),this._domElement.removeEventListener("contextmenu",p),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",u),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mouseup",f),this._domElement.ownerDocument.removeEventListener("pointerlockchange",_),this._domElement.ownerDocument.removeEventListener("pointerlockerror",w))},this.cancel=()=>{this._state!==ee.NONE&&(this._state=ee.NONE,this._activePointers.length=0,v())},n&&this.connect(n),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=mn(e.width,0,1),this._interactiveArea.height=mn(e.height,0,1),this._interactiveArea.x=mn(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=mn(e.x,0,1-this._interactiveArea.height)}addEventListener(e,n){super.addEventListener(e,n)}removeEventListener(e,n){super.removeEventListener(e,n)}rotate(e,n,r=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+n,r)}rotateAzimuthTo(e,n=!1){return this.rotateTo(e,this._sphericalEnd.phi,n)}rotatePolarTo(e,n=!1){return this.rotateTo(this._sphericalEnd.theta,e,n)}rotateTo(e,n,r=!1){this._isUserControllingRotate=!1;const i=mn(e,this.minAzimuthAngle,this.maxAzimuthAngle),a=mn(n,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=a,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,r||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!r||Fe(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Fe(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,n=!1){return this.dollyTo(this._sphericalEnd.radius-e,n)}dollyTo(e,n=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=xr.NONE,this._changedDolly=0,this._dollyToNoClamp(mn(e,this.minDistance,this.maxDistance),n)}_dollyToNoClamp(e,n=!1){const r=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const o=this._collisionTest(),s=Fe(o,this._spherical.radius);if(!(r>e)&&s)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,o)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,n||(this._spherical.radius=this._sphericalEnd.radius);const a=!n||Fe(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(a)}dollyInFixed(e,n=!1){this._targetEnd.add(this._getCameraDirection(Pi).multiplyScalar(e)),n||this._target.copy(this._targetEnd);const r=!n||Fe(this._target.x,this._targetEnd.x,this.restThreshold)&&Fe(this._target.y,this._targetEnd.y,this.restThreshold)&&Fe(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}zoom(e,n=!1){return this.zoomTo(this._zoomEnd+e,n)}zoomTo(e,n=!1){this._isUserControllingZoom=!1,this._zoomEnd=mn(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,n||(this._zoom=this._zoomEnd);const r=!n||Fe(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(r)}pan(e,n,r=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,n,r)}truck(e,n,r=!1){this._camera.updateMatrix(),hn.setFromMatrixColumn(this._camera.matrix,0),pn.setFromMatrixColumn(this._camera.matrix,1),hn.multiplyScalar(e),pn.multiplyScalar(-n);const i=Te.copy(hn).add(pn),a=Me.copy(this._targetEnd).add(i);return this.moveTo(a.x,a.y,a.z,r)}forward(e,n=!1){Te.setFromMatrixColumn(this._camera.matrix,0),Te.crossVectors(this._camera.up,Te),Te.multiplyScalar(e);const r=Me.copy(this._targetEnd).add(Te);return this.moveTo(r.x,r.y,r.z,n)}elevate(e,n=!1){return Te.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Te.x,this._targetEnd.y+Te.y,this._targetEnd.z+Te.z,n)}moveTo(e,n,r,i=!1){this._isUserControllingTruck=!1;const a=Te.set(e,n,r).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,a,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const o=!i||Fe(this._target.x,this._targetEnd.x,this.restThreshold)&&Fe(this._target.y,this._targetEnd.y,this.restThreshold)&&Fe(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,n,r,i=!1){const s=Te.set(e,n,r).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(s.x,s.y,s.z,i)}fitToBox(e,n,{cover:r=!1,paddingLeft:i=0,paddingRight:a=0,paddingBottom:o=0,paddingTop:s=0}={}){const l=[],u=e.isBox3?Ar.copy(e):Ar.setFromObject(e);u.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=md(this._sphericalEnd.theta,pd),f=md(this._sphericalEnd.phi,pd);l.push(this.rotateTo(c,f,n));const d=Te.setFromSpherical(this._sphericalEnd).normalize(),h=wd.setFromUnitVectors(d,al),p=Fe(Math.abs(d.y),1);p&&h.multiply(sl.setFromAxisAngle(Ka,c)),h.multiply(this._yAxisUpSpaceInverse);const g=_d.makeEmpty();Me.copy(u.min).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.min).setX(u.max.x).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.min).setY(u.max.y).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.max).setZ(u.min.z).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.min).setZ(u.max.z).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.max).setY(u.min.y).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.max).setX(u.min.x).applyQuaternion(h),g.expandByPoint(Me),Me.copy(u.max).applyQuaternion(h),g.expandByPoint(Me),g.min.x-=i,g.min.y-=o,g.max.x+=a,g.max.y+=s,h.setFromUnitVectors(al,d),p&&h.premultiply(sl.invert()),h.premultiply(this._yAxisUpSpace);const m=g.getSize(Te),v=g.getCenter(Me).applyQuaternion(h);if(nr(this._camera)){const _=this.getDistanceToFitBox(m.x,m.y,m.z,r);l.push(this.moveTo(v.x,v.y,v.z,n)),l.push(this.dollyTo(_,n)),l.push(this.setFocalOffset(0,0,0,n))}else if(zn(this._camera)){const _=this._camera,w=_.right-_.left,y=_.top-_.bottom,b=r?Math.max(w/m.x,y/m.y):Math.min(w/m.x,y/m.y);l.push(this.moveTo(v.x,v.y,v.z,n)),l.push(this.zoomTo(b,n)),l.push(this.setFocalOffset(0,0,0,n))}return Promise.all(l)}fitToSphere(e,n){const r=[],a=e instanceof ye.Sphere?ol.copy(e):Nl.createBoundingSphere(e,ol);if(r.push(this.moveTo(a.center.x,a.center.y,a.center.z,n)),nr(this._camera)){const o=this.getDistanceToFitSphere(a.radius);r.push(this.dollyTo(o,n))}else if(zn(this._camera)){const o=this._camera.right-this._camera.left,s=this._camera.top-this._camera.bottom,l=2*a.radius,u=Math.min(o/l,s/l);r.push(this.zoomTo(u,n))}return r.push(this.setFocalOffset(0,0,0,n)),Promise.all(r)}setLookAt(e,n,r,i,a,o,s=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=xr.NONE,this._changedDolly=0;const l=Me.set(i,a,o),u=Te.set(e,n,r);this._targetEnd.copy(l),this._sphericalEnd.setFromVector3(u.sub(l).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,s||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const c=!s||Fe(this._target.x,this._targetEnd.x,this.restThreshold)&&Fe(this._target.y,this._targetEnd.y,this.restThreshold)&&Fe(this._target.z,this._targetEnd.z,this.restThreshold)&&Fe(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Fe(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Fe(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,n,r,i,a,o,s,l,u,c,f,d,h,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=xr.NONE,this._changedDolly=0;const g=Te.set(i,a,o),m=Me.set(e,n,r);zt.setFromVector3(m.sub(g).applyQuaternion(this._yAxisUpSpace));const v=Sr.set(c,f,d),_=Me.set(s,l,u);Mi.setFromVector3(_.sub(v).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(g.lerp(v,h));const w=Mi.theta-zt.theta,y=Mi.phi-zt.phi,b=Mi.radius-zt.radius;this._sphericalEnd.set(zt.radius+b*h,zt.phi+y*h,zt.theta+w*h),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const S=!p||Fe(this._target.x,this._targetEnd.x,this.restThreshold)&&Fe(this._target.y,this._targetEnd.y,this.restThreshold)&&Fe(this._target.z,this._targetEnd.z,this.restThreshold)&&Fe(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Fe(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Fe(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(S)}setPosition(e,n,r,i=!1){return this.setLookAt(e,n,r,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(e,n,r,i=!1){const a=this.getPosition(Te),o=this.setLookAt(a.x,a.y,a.z,e,n,r,i);return this._sphericalEnd.phi=mn(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,n,r,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,n,r),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const a=!i||Fe(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Fe(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Fe(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}setOrbitPoint(e,n,r){this._camera.updateMatrixWorld(),hn.setFromMatrixColumn(this._camera.matrixWorldInverse,0),pn.setFromMatrixColumn(this._camera.matrixWorldInverse,1),rr.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=Te.set(e,n,r),a=i.distanceTo(this._camera.position),o=i.sub(this._camera.position);hn.multiplyScalar(o.x),pn.multiplyScalar(o.y),rr.multiplyScalar(o.z),Te.copy(hn).add(pn).add(rr),Te.z=Te.z+a,this.dollyTo(a,!1),this.setFocalOffset(-Te.x,Te.y,-Te.z,!1),this.moveTo(e,n,r,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,n,r,i){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new ye.Vector4,typeof e=="number"?this._viewport.set(e,n,r,i):this._viewport.copy(e)}getDistanceToFitBox(e,n,r,i=!1){if(il(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const a=e/n,o=this._camera.getEffectiveFOV()*Oi,s=this._camera.aspect;return((i?a>s:a<s)?n:e/s)*.5/Math.tan(o*.5)+r*.5}getDistanceToFitSphere(e){if(il(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const n=this._camera.getEffectiveFOV()*Oi,r=Math.atan(Math.tan(n*.5)*this._camera.aspect)*2,i=1<this._camera.aspect?n:r;return e/Math.sin(i*.5)}getTarget(e,n=!0){return(e&&e.isVector3?e:new ye.Vector3).copy(n?this._targetEnd:this._target)}getPosition(e,n=!0){return(e&&e.isVector3?e:new ye.Vector3).setFromSpherical(n?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(n?this._targetEnd:this._target)}getSpherical(e,n=!0){return(e&&e instanceof ye.Spherical?e:new ye.Spherical).copy(n?this._sphericalEnd:this._spherical)}getFocalOffset(e,n=!0){return(e&&e.isVector3?e:new ye.Vector3).copy(n?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Tr,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Tr),this._spherical.theta+=Tr*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Tr)}reset(e=!1){if(!Fe(this._camera.up.x,this._cameraUp0.x)||!Fe(this._camera.up.y,this._cameraUp0.y)||!Fe(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const r=this.getPosition(Te);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}const n=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(n)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Ka),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Te.subVectors(this._target,this._camera.position).normalize(),n=Me.crossVectors(e,this._camera.up);this._camera.up.crossVectors(n,e),this._camera.updateMatrixWorld();const r=this.getPosition(Te);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}update(e){const n=this._sphericalEnd.theta-this._spherical.theta,r=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,a=yd.subVectors(this._targetEnd,this._target),o=bd.subVectors(this._focalOffsetEnd,this._focalOffset),s=this._zoomEnd-this._zoom;if(He(n))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const f=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Ha(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,f,1/0,e),this._needsUpdate=!0}if(He(r))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const f=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Ha(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,f,1/0,e),this._needsUpdate=!0}if(He(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const f=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Ha(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,f,this.maxSpeed,e),this._needsUpdate=!0}if(He(a.x)&&He(a.y)&&He(a.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const f=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;gd(this._target,this._targetEnd,this._targetVelocity,f,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(He(o.x)&&He(o.y)&&He(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const f=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;gd(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,f,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(He(s))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const f=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Ha(this._zoom,this._zoomEnd,this._zoomVelocity,f,1/0,e)}if(this.dollyToCursor){if(nr(this._camera)&&this._changedDolly!==0){const f=this._spherical.radius-this._lastDistance,d=this._camera,h=this._getCameraDirection(Pi),p=Te.copy(h).cross(d.up).normalize();p.lengthSq()===0&&(p.x=1);const g=Me.crossVectors(p,h),m=this._sphericalEnd.radius*Math.tan(d.getEffectiveFOV()*Oi*.5),_=(this._sphericalEnd.radius-f-this._sphericalEnd.radius)/this._sphericalEnd.radius,w=Sr.copy(this._targetEnd).add(p.multiplyScalar(this._dollyControlCoord.x*m*d.aspect)).add(g.multiplyScalar(this._dollyControlCoord.y*m)),y=Te.copy(this._targetEnd).lerp(w,_),b=this._lastDollyDirection===xr.IN&&this._spherical.radius<=this.minDistance,S=this._lastDollyDirection===xr.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(b||S)){this._sphericalEnd.radius-=f,this._spherical.radius-=f;const x=Me.copy(h).multiplyScalar(-f);y.add(x)}this._boundary.clampPoint(y,y);const E=Me.subVectors(y,this._targetEnd);this._targetEnd.copy(y),this._target.add(E),this._changedDolly-=f,He(this._changedDolly)&&(this._changedDolly=0)}else if(zn(this._camera)&&this._changedZoom!==0){const f=this._zoom-this._lastZoom,d=this._camera,h=Te.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(d.near+d.far)/(d.near-d.far)).unproject(d),p=Me.set(0,0,-1).applyQuaternion(d.quaternion),g=Sr.copy(h).add(p.multiplyScalar(-h.dot(d.up))),v=-(this._zoom-f-this._zoom)/this._zoom,_=this._getCameraDirection(Pi),w=this._targetEnd.dot(_),y=Te.copy(this._targetEnd).lerp(g,v),b=y.dot(_),S=_.multiplyScalar(b-w);y.sub(S),this._boundary.clampPoint(y,y);const E=Me.subVectors(y,this._targetEnd);this._targetEnd.copy(y),this._target.add(E),this._changedZoom-=f,He(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);const l=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,l),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!He(this._focalOffset.x)||!He(this._focalOffset.y)||!He(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),hn.setFromMatrixColumn(this._camera.matrix,0),pn.setFromMatrixColumn(this._camera.matrix,1),rr.setFromMatrixColumn(this._camera.matrix,2),hn.multiplyScalar(this._focalOffset.x),pn.multiplyScalar(-this._focalOffset.y),rr.multiplyScalar(this._focalOffset.z),Te.copy(hn).add(pn).add(rr),this._camera.position.add(Te)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Te.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const c=this._needsUpdate;return c&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):c?(this.dispatchEvent({type:"update"}),He(n,this.restThreshold)&&He(r,this.restThreshold)&&He(i,this.restThreshold)&&He(a.x,this.restThreshold)&&He(a.y,this.restThreshold)&&He(a.z,this.restThreshold)&&He(o.x,this.restThreshold)&&He(o.y,this.restThreshold)&&He(o.z,this.restThreshold)&&He(s,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!c&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=c,this._needsUpdate=!1,c}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Di(this.maxDistance),minZoom:this.minZoom,maxZoom:Di(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Di(this.maxPolarAngle),minAzimuthAngle:Di(this.minAzimuthAngle),maxAzimuthAngle:Di(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Te.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,n=!1){const r=JSON.parse(e);this.enabled=r.enabled,this.minDistance=r.minDistance,this.maxDistance=Ci(r.maxDistance),this.minZoom=r.minZoom,this.maxZoom=Ci(r.maxZoom),this.minPolarAngle=r.minPolarAngle,this.maxPolarAngle=Ci(r.maxPolarAngle),this.minAzimuthAngle=Ci(r.minAzimuthAngle),this.maxAzimuthAngle=Ci(r.maxAzimuthAngle),this.smoothTime=r.smoothTime,this.draggingSmoothTime=r.draggingSmoothTime,this.dollySpeed=r.dollySpeed,this.truckSpeed=r.truckSpeed,this.dollyToCursor=r.dollyToCursor,this.verticalDragToForward=r.verticalDragToForward,this._target0.fromArray(r.target0),this._position0.fromArray(r.position0),this._zoom0=r.zoom0,this._focalOffset0.fromArray(r.focalOffset0),this.moveTo(r.target[0],r.target[1],r.target[2],n),zt.setFromVector3(Te.fromArray(r.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(zt.theta,zt.phi,n),this.dollyTo(zt.radius,n),this.zoomTo(r.zoom,n),this.setFocalOffset(r.focalOffset[0],r.focalOffset[1],r.focalOffset[2],n),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",M2),this._addAllEventListeners(e)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(n=>n.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(n=>n.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,n,r){const i=n.lengthSq();if(i===0)return e;const a=Me.copy(n).add(e),s=this._boundary.clampPoint(a,Sr).sub(a),l=s.lengthSq();if(l===0)return e.add(n);if(l===i)return e;if(r===0)return e.add(n).add(s);{const u=1+r*l/n.dot(s);return e.add(Me.copy(n).multiplyScalar(u)).add(s.multiplyScalar(1-r))}}_updateNearPlaneCorners(){if(nr(this._camera)){const e=this._camera,n=e.near,r=e.getEffectiveFOV()*Oi,i=Math.tan(r*.5)*n,a=i*e.aspect;this._nearPlaneCorners[0].set(-a,-i,0),this._nearPlaneCorners[1].set(a,-i,0),this._nearPlaneCorners[2].set(a,i,0),this._nearPlaneCorners[3].set(-a,i,0)}else if(zn(this._camera)){const e=this._camera,n=1/e.zoom,r=e.left*n,i=e.right*n,a=e.top*n,o=e.bottom*n;this._nearPlaneCorners[0].set(r,a,0),this._nearPlaneCorners[1].set(i,a,0),this._nearPlaneCorners[2].set(i,o,0),this._nearPlaneCorners[3].set(r,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||il(this._camera,"_collisionTest"))return e;const r=this._getTargetDirection(Pi);ll.lookAt(vd,r,this._camera.up);for(let i=0;i<4;i++){const a=Me.copy(this._nearPlaneCorners[i]);a.applyMatrix4(ll);const o=Sr.addVectors(this._target,a);Xa.set(o,r),Xa.far=this._spherical.radius+1;const s=Xa.intersectObjects(this.colliderMeshes);s.length!==0&&s[0].distance<e&&(e=s[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const n=this._domElement.getBoundingClientRect();return e.x=n.left,e.y=n.top,this._viewport?(e.x+=this._viewport.x,e.y+=n.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=n.width,e.height=n.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(n=>{const r=()=>{this.removeEventListener("rest",r),n()};this.addEventListener("rest",r)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,n=new ye.Sphere){const r=n,i=r.center;Ar.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&Ar.expandByObject(o)}),Ar.getCenter(i);let a=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const s=o,l=s.geometry.clone();l.applyMatrix4(s.matrixWorld);const c=l.attributes.position;for(let f=0,d=c.count;f<d;f++)Te.fromBufferAttribute(c,f),a=Math.max(a,i.distanceToSquared(Te))}),r.radius=Math.sqrt(a),r}};var ls={exports:{}},Ed={ellipse:"",chars:[" ","-"],max:140,truncate:!0};function Tm(t,e,n,r){if(t<=e)return t;if(e<2)return t.slice(0,e-n.length)+n;for(var i=e-n.length,a=Math.floor(i/2),o=a,s=t.length-a,l=0;l<a;l++){var u=t.charAt(l),c=t.length-l,f=t.charAt(c);r.indexOf(u)!==-1&&(o=l),r.indexOf(f)!==-1&&(s=c)}return t.slice(0,o)+n+t.slice(s)}function Sm(t,e,n,r,i){if(t.length<=e)return t;for(var a=e-n.length,o=a,s=0;s<=a;s++){var l=t.charAt(s);r.indexOf(l)!==-1&&(o=s)}return!i&&o==a?"":t.slice(0,o)+n}ls.exports=function(t,e,n){if(typeof t!="string"||t.length===0||e===0)return"";n=n||{};for(var r in Ed)(n[r]===null||typeof n[r]>"u")&&(n[r]=Ed[r]);return n.max=e||n.max,n.truncate=="middle"?Tm(t,n.max,n.ellipse,n.chars):Sm(t,n.max,n.ellipse,n.chars,n.truncate)};ls.exports.ellipsizeMiddle=Tm;ls.exports.ellipsize=Sm;var L2=ls.exports;const U2=Vt(L2),Yn=({text:t,fontSize:e,fontUrl:n,color:r,opacity:i,stroke:a,active:o,ellipsis:s})=>{const l=s&&!o?U2(t,s):t,u=I.useMemo(()=>new Xt(r),[r]),c=I.useMemo(()=>a?new Xt(a):void 0,[a]);return re.jsx(Yu,{position:[0,0,1],children:re.jsx(D2,{font:n,fontSize:e,color:u,fillOpacity:i,textAlign:"center",outlineWidth:a?1:0,outlineColor:c,depthOffset:0,maxWidth:100,overflowWrap:"break-word",children:l})})};Yn.defaultProps={opacity:1,fontSize:7,color:"#2A6475",ellipsis:75};try{Yn.displayName="Label",Yn.__docgenInfo={description:"",displayName:"Label",props:{text:{defaultValue:null,description:"Text to render.",name:"text",required:!0,type:{name:"string"}},fontUrl:{defaultValue:null,description:`Font URL.
Reference: https://github.com/reaviz/reagraph/issues/23`,name:"fontUrl",required:!1,type:{name:"string"}},fontSize:{defaultValue:{value:"7"},description:"Size of the font.",name:"fontSize",required:!1,type:{name:"number"}},color:{defaultValue:{value:"#2A6475"},description:"Color of the text.",name:"color",required:!1,type:{name:"ColorRepresentation"}},stroke:{defaultValue:null,description:"Stroke of the text.",name:"stroke",required:!1,type:{name:"ColorRepresentation"}},opacity:{defaultValue:{value:"1"},description:"Opacity for the label.",name:"opacity",required:!1,type:{name:"number"}},ellipsis:{defaultValue:{value:"75"},description:"The lenth of which to start the ellipsis.",name:"ellipsis",required:!1,type:{name:"number"}},active:{defaultValue:null,description:"Whether the label is active ( dragging, hover, focus ).",name:"active",required:!1,type:{name:"boolean"}}}}}catch{}const zr=({color:t,id:e,size:n,opacity:r,animated:i})=>{const{scale:a,nodeOpacity:o}=Ut({from:{scale:[1e-5,1e-5,1e-5],nodeOpacity:0},to:{scale:[n,n,n],nodeOpacity:r},config:{...Lt,duration:i?void 0:0}}),s=I.useMemo(()=>new Xt(t),[t]);return re.jsxs(Je.mesh,{userData:{id:e,type:"node"},scale:a,children:[re.jsx("sphereGeometry",{attach:"geometry",args:[1,25,25]}),re.jsx(Je.meshPhongMaterial,{attach:"material",side:yt,transparent:!0,fog:!0,opacity:o,color:s})]})};zr.defaultProps={opacity:1,active:!1};try{zr.displayName="Sphere",zr.__docgenInfo={description:"",displayName:"Sphere",props:{color:{defaultValue:null,description:"Color of the node. Handles selected/etc.",name:"color",required:!0,type:{name:"ColorRepresentation"}},node:{defaultValue:null,description:"The internal node model.",name:"node",required:!0,type:{name:"InternalGraphNode"}},size:{defaultValue:null,description:"Size of the node.",name:"size",required:!0,type:{name:"number"}},active:{defaultValue:{value:"false"},description:"Whether the node is active or not.",name:"active",required:!1,type:{name:"boolean"}},opacity:{defaultValue:{value:"1"},description:"Opacity of the node. Mainly used for selection.",name:"opacity",required:!1,type:{name:"number"}},animated:{defaultValue:null,description:"Animation of the node.",name:"animated",required:!0,type:{name:"boolean"}},id:{defaultValue:null,description:"ID of the node.",name:"id",required:!0,type:{name:"string"}}}}}catch{}const Po=({color:t,size:e,opacity:n,animated:r})=>{const i=I.useMemo(()=>new Xt(t),[t]),{ringSize:a,ringOpacity:o}=Ut({from:{ringOpacity:0,ringSize:[1e-5,1e-5,1e-5]},to:{ringOpacity:n,ringSize:[e/2,e/2,1]},config:{...Lt,duration:r?void 0:0}});return re.jsx(Yu,{position:[0,0,1],children:re.jsxs(Je.mesh,{scale:a,children:[re.jsx("ringGeometry",{attach:"geometry",args:[4,4.5,25]}),re.jsx(Je.meshBasicMaterial,{attach:"material",color:i,transparent:!0,depthTest:!1,opacity:o,side:yt,fog:!0})]})})};Po.defaultProps={color:"#D8E6EA",size:1,opacity:.5};try{Po.displayName="Ring",Po.__docgenInfo={description:"",displayName:"Ring",props:{color:{defaultValue:{value:"#D8E6EA"},description:"The color of the ring.",name:"color",required:!1,type:{name:"ColorRepresentation"}},animated:{defaultValue:null,description:"Whether the ring should be animated.",name:"animated",required:!1,type:{name:"boolean"}},size:{defaultValue:{value:"1"},description:"The size of the ring.",name:"size",required:!1,type:{name:"number"}},opacity:{defaultValue:{value:"0.5"},description:"The opacity of the ring.",name:"opacity",required:!1,type:{name:"number"}}}}}catch{}const Am=I.createContext({controls:null,resetControls:()=>{},zoomIn:()=>{},zoomOut:()=>{},panLeft:()=>{},panRight:()=>{},panUp:()=>{},panDown:()=>{}}),Xu=()=>{const t=I.useContext(Am);if(t===void 0)throw new Error("`useCameraControls` hook must be used within a `ControlsProvider` component");return t};var km={exports:{}};(function(t){(function(e,n,r){if(!e)return;for(var i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},a={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l,u=1;u<20;++u)i[111+u]="f"+u;for(u=0;u<=9;++u)i[u+96]=u.toString();function c(E,x,A){if(E.addEventListener){E.addEventListener(x,A,!1);return}E.attachEvent("on"+x,A)}function f(E){if(E.type=="keypress"){var x=String.fromCharCode(E.which);return E.shiftKey||(x=x.toLowerCase()),x}return i[E.which]?i[E.which]:a[E.which]?a[E.which]:String.fromCharCode(E.which).toLowerCase()}function d(E,x){return E.sort().join(",")===x.sort().join(",")}function h(E){var x=[];return E.shiftKey&&x.push("shift"),E.altKey&&x.push("alt"),E.ctrlKey&&x.push("ctrl"),E.metaKey&&x.push("meta"),x}function p(E){if(E.preventDefault){E.preventDefault();return}E.returnValue=!1}function g(E){if(E.stopPropagation){E.stopPropagation();return}E.cancelBubble=!0}function m(E){return E=="shift"||E=="ctrl"||E=="alt"||E=="meta"}function v(){if(!l){l={};for(var E in i)E>95&&E<112||i.hasOwnProperty(E)&&(l[i[E]]=E)}return l}function _(E,x,A){return A||(A=v()[E]?"keydown":"keypress"),A=="keypress"&&x.length&&(A="keydown"),A}function w(E){return E==="+"?["+"]:(E=E.replace(/\+{2}/g,"+plus"),E.split("+"))}function y(E,x){var A,V,F,P=[];for(A=w(E),F=0;F<A.length;++F)V=A[F],s[V]&&(V=s[V]),x&&x!="keypress"&&o[V]&&(V=o[V],P.push("shift")),m(V)&&P.push(V);return x=_(V,P,x),{key:V,modifiers:P,action:x}}function b(E,x){return E===null||E===n?!1:E===x?!0:b(E.parentNode,x)}function S(E){var x=this;if(E=E||n,!(x instanceof S))return new S(E);x.target=E,x._callbacks={},x._directMap={};var A={},V,F=!1,P=!1,N=!1;function W(R){R=R||{};var O=!1,D;for(D in A){if(R[D]){O=!0;continue}A[D]=0}O||(N=!1)}function H(R,O,D,T,C,j){var k,z,J=[],Q=D.type;if(!x._callbacks[R])return[];for(Q=="keyup"&&m(R)&&(O=[R]),k=0;k<x._callbacks[R].length;++k)if(z=x._callbacks[R][k],!(!T&&z.seq&&A[z.seq]!=z.level)&&Q==z.action&&(Q=="keypress"&&!D.metaKey&&!D.ctrlKey||d(O,z.modifiers))){var X=!T&&z.combo==C,Y=T&&z.seq==T&&z.level==j;(X||Y)&&x._callbacks[R].splice(k,1),J.push(z)}return J}function L(R,O,D,T){x.stopCallback(O,O.target||O.srcElement,D,T)||R(O,D)===!1&&(p(O),g(O))}x._handleKey=function(R,O,D){var T=H(R,O,D),C,j={},k=0,z=!1;for(C=0;C<T.length;++C)T[C].seq&&(k=Math.max(k,T[C].level));for(C=0;C<T.length;++C){if(T[C].seq){if(T[C].level!=k)continue;z=!0,j[T[C].seq]=1,L(T[C].callback,D,T[C].combo,T[C].seq);continue}z||L(T[C].callback,D,T[C].combo)}var J=D.type=="keypress"&&P;D.type==N&&!m(R)&&!J&&W(j),P=z&&D.type=="keydown"};function G(R){typeof R.which!="number"&&(R.which=R.keyCode);var O=f(R);if(O){if(R.type=="keyup"&&F===O){F=!1;return}x.handleKey(O,h(R),R)}}function B(){clearTimeout(V),V=setTimeout(W,1e3)}function q(R,O,D,T){A[R]=0;function C(Q){return function(){N=Q,++A[R],B()}}function j(Q){L(D,Q,R),T!=="keyup"&&(F=f(Q)),setTimeout(W,10)}for(var k=0;k<O.length;++k){var z=k+1===O.length,J=z?j:C(T||y(O[k+1]).action);$(O[k],J,T,R,k)}}function $(R,O,D,T,C){x._directMap[R+":"+D]=O,R=R.replace(/\s+/g," ");var j=R.split(" "),k;if(j.length>1){q(R,j,O,D);return}k=y(R,D),x._callbacks[k.key]=x._callbacks[k.key]||[],H(k.key,k.modifiers,{type:k.action},T,R,C),x._callbacks[k.key][T?"unshift":"push"]({callback:O,modifiers:k.modifiers,action:k.action,seq:T,level:C,combo:R})}x._bindMultiple=function(R,O,D){for(var T=0;T<R.length;++T)$(R[T],O,D)},c(E,"keypress",G),c(E,"keydown",G),c(E,"keyup",G)}S.prototype.bind=function(E,x,A){var V=this;return E=E instanceof Array?E:[E],V._bindMultiple.call(V,E,x,A),V},S.prototype.unbind=function(E,x){var A=this;return A.bind.call(A,E,function(){},x)},S.prototype.trigger=function(E,x){var A=this;return A._directMap[E+":"+x]&&A._directMap[E+":"+x]({},E),A},S.prototype.reset=function(){var E=this;return E._callbacks={},E._directMap={},E},S.prototype.stopCallback=function(E,x){var A=this;if((" "+x.className+" ").indexOf(" mousetrap ")>-1||b(x,A.target))return!1;if("composedPath"in E&&typeof E.composedPath=="function"){var V=E.composedPath()[0];V!==E.target&&(x=V)}return x.tagName=="INPUT"||x.tagName=="SELECT"||x.tagName=="TEXTAREA"||x.isContentEditable},S.prototype.handleKey=function(){var E=this;return E._handleKey.apply(E,arguments)},S.addKeycodes=function(E){for(var x in E)E.hasOwnProperty(x)&&(i[x]=E[x]);l=null},S.init=function(){var E=S(n);for(var x in E)x.charAt(0)!=="_"&&(S[x]=function(A){return function(){return E[A].apply(E,arguments)}}(x))},S.init(),e.Mousetrap=S,t.exports&&(t.exports=S),typeof r=="function"&&r.amd&&r(function(){return S})})(typeof window<"u"?window:null,typeof window<"u"?document:null)})(km);var V2=km.exports;const xd=Vt(V2),F2=()=>{const t=new Map;let e=[];const n=a=>{a.forEach(o=>{if(!o.disabled)if(o.ref){if(!o.ref.current)return;const s=o.ref.current;t.has(s)||t.set(s,new xd(s)),t.get(s).bind(o.keys,o.callback,o.action)}else t.get(void 0)||t.set(void 0,xd),t.get(void 0).bind(o.keys,o.callback,o.action)})},r=a=>{e=[...e,...a],n(a)},i=a=>{e=e.filter(o=>!a.includes(o)),a.forEach(o=>{var s,l;if(o.ref){if(!o.ref.current)return;(s=t.get(o.ref.current))==null||s.unbind(o.keys,o.action)}else(l=t.get(void 0))==null||l.unbind(o.keys,o.action)});for(const[o]of t){if(o===void 0){if(e.some(s=>s.ref===void 0))continue}else if(e.some(s=>{var l;return((l=s.ref)==null?void 0:l.current)===o}))continue;t.delete(o)}n(e)};return()=>{const[a,o]=I.useState([]);return I.useEffect(()=>{o(e)},[]),[a,r,i]}},G2=F2(),Om=t=>{const[e,n,r]=G2();return I.useLayoutEffect(()=>(t&&n(t),()=>{t&&r(t)}),[n,r,t]),I.useMemo(()=>e.reduce((i,a)=>(i.find(o=>o.keys===a.keys&&o.ref&&a.ref)||i.push(a),i),[]),[e])};let N2=!1;try{navigator&&(N2=navigator.platform.toUpperCase().indexOf("MAC")>=0)}catch(t){console.warn(t)}/*!
 * hold-event
 * https://github.com/yomotsu/hold-event
 * (c) 2020 @yomotsu
 * Released under the MIT License.
 */var Bi;(function(t){t.HOLD_START="holdStart",t.HOLD_END="holdEnd",t.HOLDING="holding"})(Bi||(Bi={}));class j2{constructor(){this._listeners={}}addEventListener(e,n){const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}removeEventListener(e,n){const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}dispatchEvent(e){const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e)}}}class z2 extends j2{constructor(e){super(),this._enabled=!0,this._holding=!1,this._intervalId=-1,this._deltaTime=0,this._elapsedTime=0,this._lastTime=0,this._holdStart=n=>{if(!this._enabled||this._holding)return;this._deltaTime=0,this._elapsedTime=0,this._lastTime=performance.now(),this.dispatchEvent({type:Bi.HOLD_START,deltaTime:this._deltaTime,elapsedTime:this._elapsedTime,originalEvent:n}),this._holding=!0;const r=()=>{this._intervalId=this.holdIntervalDelay?window.setTimeout(r,this.holdIntervalDelay):window.requestAnimationFrame(r);const i=performance.now();this._deltaTime=i-this._lastTime,this._elapsedTime+=this._deltaTime,this._lastTime=performance.now(),this.dispatchEvent({type:Bi.HOLDING,deltaTime:this._deltaTime,elapsedTime:this._elapsedTime,originalEvent:n})};this._intervalId=this.holdIntervalDelay?window.setTimeout(r,this.holdIntervalDelay):window.requestAnimationFrame(r)},this._holdEnd=n=>{if(!this._enabled||!this._holding)return;const r=performance.now();this._deltaTime=r-this._lastTime,this._elapsedTime+=this._deltaTime,this._lastTime=performance.now(),this.dispatchEvent({type:Bi.HOLD_END,deltaTime:this._deltaTime,elapsedTime:this._elapsedTime,originalEvent:n}),window.clearTimeout(this._intervalId),window.cancelAnimationFrame(this._intervalId),this._holding=!1},this.holdIntervalDelay=e}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._enabled||this._holdEnd())}}class us extends z2{constructor(e,n){super(n),this._holdStart=this._holdStart.bind(this),this._holdEnd=this._holdEnd.bind(this);const r=a=>{q2(a)||a.keyCode===e&&this._holdStart(a)},i=a=>{a.keyCode===e&&this._holdEnd(a)};document.addEventListener("keydown",r),document.addEventListener("keyup",i),window.addEventListener("blur",this._holdEnd)}}function q2(t){const e=t.target;return e.tagName==="INPUT"||e.tagName==="SELECT"||e.tagName==="TEXTAREA"||e.isContentEditable}var Cd,Pd;qn.install({THREE:{MOUSE:mg,Vector2:De,Vector3:Ee,Vector4:fl,Quaternion:Gd,Matrix4:Fd,Spherical:gg,Box3:Kl,Sphere:Vd,Raycaster:vg,MathUtils:{DEG2RAD:(Cd=dl)==null?void 0:Cd.DEG2RAD,clamp:(Pd=dl)==null?void 0:Pd.clamp}}});Md({ThreeCameraControls:qn});const cs={ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},Td=new us(cs.ARROW_LEFT,100),Sd=new us(cs.ARROW_RIGHT,100),Ad=new us(cs.ARROW_UP,100),kd=new us(cs.ARROW_DOWN,100),Mo=I.forwardRef(({mode:t,children:e,animated:n,disabled:r},i)=>{const a=I.useRef(null),o=xt(w=>w.camera),s=xt(w=>w.gl),l=t==="orbit",u=he(w=>w.setPanning);zo((w,y)=>{var b,S;(b=a.current)!=null&&b.enabled&&((S=a.current)==null||S.update(y)),l&&(a.current.azimuthAngle+=20*y*dl.DEG2RAD)},-1),I.useEffect(()=>()=>{var w;return(w=a.current)==null?void 0:w.dispose()},[]);const c=I.useCallback(()=>{var w;(w=a.current)==null||w.zoom(o.zoom/2,n)},[n,o.zoom]),f=I.useCallback(()=>{var w;(w=a.current)==null||w.zoom(-o.zoom/2,n)},[n,o.zoom]),d=I.useCallback(w=>{var y;l||(y=a.current)==null||y.truck(-.03*w.deltaTime,0,n)},[n,l]),h=I.useCallback(w=>{var y;l||(y=a.current)==null||y.truck(.03*w.deltaTime,0,n)},[n,l]),p=I.useCallback(w=>{var y;l||(y=a.current)==null||y.truck(0,.03*w.deltaTime,n)},[n,l]),g=I.useCallback(w=>{var y;l||(y=a.current)==null||y.truck(0,-.03*w.deltaTime,n)},[n,l]),m=I.useCallback(w=>{w.code==="Space"&&(t==="rotate"?a.current.mouseButtons.left=qn.ACTION.TRUCK:a.current.mouseButtons.left=qn.ACTION.ROTATE)},[t]),v=I.useCallback(w=>{w.code==="Space"&&(t==="rotate"?a.current.mouseButtons.left=qn.ACTION.ROTATE:a.current.mouseButtons.left=qn.ACTION.TRUCK)},[t]);I.useEffect(()=>(Td.addEventListener("holding",h),Sd.addEventListener("holding",d),Ad.addEventListener("holding",p),kd.addEventListener("holding",g),window.addEventListener("keydown",m),window.addEventListener("keyup",v),()=>{Td.removeEventListener("holding",h),Sd.removeEventListener("holding",d),Ad.removeEventListener("holding",p),kd.removeEventListener("holding",g),window.removeEventListener("keydown",m),window.removeEventListener("keyup",v)}),[m,v,g,h,d,p]),I.useEffect(()=>{const w=()=>u(!0),y=()=>u(!1),b=a.current;return b&&(b.addEventListener("control",w),b.addEventListener("controlend",y)),()=>{b&&(b.removeEventListener("control",w),b.removeEventListener("controlend",y))}},[a,u]),I.useEffect(()=>{t==="rotate"?a.current.mouseButtons.left=qn.ACTION.ROTATE:a.current.mouseButtons.left=qn.ACTION.TRUCK},[t]),Om([{name:"Zoom In",category:"Graph",keys:"command+shift+i",callback:w=>{w.preventDefault(),c()}},{name:"Zoom Out",category:"Graph",keys:"command+shift+o",callback:w=>{w.preventDefault(),f()}}]);const _=I.useMemo(()=>({controls:a.current,zoomIn:()=>c(),zoomOut:()=>f(),panLeft:(w=100)=>h({deltaTime:w}),panRight:(w=100)=>d({deltaTime:w}),panDown:(w=100)=>g({deltaTime:w}),panUp:(w=100)=>p({deltaTime:w}),resetControls:w=>{var y;return(y=a.current)==null?void 0:y.reset(w)}}),[c,f,h,d,g,p,a.current]);return I.useImperativeHandle(i,()=>_),re.jsxs(Am.Provider,{value:_,children:[re.jsx("threeCameraControls",{ref:a,args:[o,s.domElement],enabled:!r,smoothTime:.1,minDistance:1e3,maxDistance:5e4}),e]})});Mo.defaultProps={mode:"rotate"};try{Mo.displayName="CameraControls",Mo.__docgenInfo={description:"",displayName:"CameraControls",props:{mode:{defaultValue:{value:"rotate"},description:"Mode of the camera.",name:"mode",required:!1,type:{name:"enum",value:[{value:'"pan"'},{value:'"rotate"'},{value:'"orbit"'}]}},children:{defaultValue:null,description:"Children symbols.",name:"children",required:!1,type:{name:"ReactNode"}},animated:{defaultValue:null,description:"Animate transitions to centering.",name:"animated",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"Disable the controls.",name:"disabled",required:!1,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<CameraControlsContextProps>"}}}}}catch{}const ul=50,B2=({animated:t})=>{const e=he(l=>l.nodes),n=xt(l=>l.invalidate),{controls:r}=Xu(),i=I.useMemo(()=>{const{maxX:l,maxY:u}=El(e);return Math.max(l,u)},[e]),a=I.useCallback((l,u=ul,c=!1)=>{const{minX:f,maxX:d,minY:h,maxY:p,minZ:g,maxZ:m}=El(l);r==null||r.fitToBox(new Kl(new Ee(f,h,g),new Ee(d,p,m)),t,{cover:c,paddingLeft:u,paddingRight:u,paddingBottom:u,paddingTop:u}),n()},[n,r,t]),o=I.useCallback(l=>{let u=null,c=ul;l!=null&&l.length&&(c=i+ul,u=l.reduce((f,d)=>{const h=e.find(p=>p.id===d);if(h)f.push(h);else throw new Error(`Attempted to center ${d} but it was not found in the nodes`);return f},[])),a(u||e,c,!!u)},[a,e,i]),s=I.useRef(!1);return I.useLayoutEffect(()=>{r&&(e!=null&&e.length)&&!s.current&&(a(e),s.current=!0)},[r,a,e]),Om([{name:"Center",category:"Graph",keys:["command+shift+c"],callback:()=>a(e)}]),{centerNodes:a,centerNodesById:o}},ia=({image:t,id:e,size:n,opacity:r,animated:i})=>{const a=I.useMemo(()=>new yg().load(t),[t]),{scale:o,spriteOpacity:s}=Ut({from:{scale:[1e-5,1e-5,1e-5],spriteOpacity:0},to:{scale:[n,n,n],spriteOpacity:r},config:{...Lt,duration:i?void 0:0}});return re.jsx(Je.sprite,{userData:{id:e,type:"node"},scale:o,children:re.jsx(Je.spriteMaterial,{attach:"material",opacity:s,fog:!0,depthTest:!1,transparent:!0,side:yt,children:re.jsx("primitive",{attach:"map",object:a,minFilter:cl})})})};ia.defaultProps={opacity:1};try{ia.displayName="Icon",ia.__docgenInfo={description:"",displayName:"Icon",props:{image:{defaultValue:null,description:"The image to display on the icon.",name:"image",required:!0,type:{name:"string"}},color:{defaultValue:null,description:"Color of the node. Handles selected/etc.",name:"color",required:!0,type:{name:"ColorRepresentation"}},node:{defaultValue:null,description:"The internal node model.",name:"node",required:!0,type:{name:"InternalGraphNode"}},size:{defaultValue:null,description:"Size of the node.",name:"size",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"Whether the node is active or not.",name:"active",required:!0,type:{name:"boolean"}},opacity:{defaultValue:{value:"1"},description:"Opacity of the node. Mainly used for selection.",name:"opacity",required:!1,type:{name:"number"}},animated:{defaultValue:null,description:"Animation of the node.",name:"animated",required:!0,type:{name:"boolean"}},id:{defaultValue:null,description:"ID of the node.",name:"id",required:!0,type:{name:"string"}}}}}catch{}const jl=({color:t,id:e,size:n,opacity:r,node:i,active:a,animated:o,image:s})=>re.jsxs(re.Fragment,{children:[re.jsx(zr,{id:e,size:n,opacity:r,animated:o,color:t,node:i,active:a}),re.jsx(ia,{id:e,image:s,size:n+8,opacity:r,animated:o,color:t,node:i,active:a})]});jl.defaultProps={opacity:1,active:!1,selected:!1};try{jl.displayName="SphereWithIcon",jl.__docgenInfo={description:"",displayName:"SphereWithIcon",props:{image:{defaultValue:null,description:"The image to display on the icon.",name:"image",required:!0,type:{name:"string"}},color:{defaultValue:null,description:"Color of the node. Handles selected/etc.",name:"color",required:!0,type:{name:"ColorRepresentation"}},node:{defaultValue:null,description:"The internal node model.",name:"node",required:!0,type:{name:"InternalGraphNode"}},size:{defaultValue:null,description:"Size of the node.",name:"size",required:!0,type:{name:"number"}},active:{defaultValue:{value:"false"},description:"Whether the node is active or not.",name:"active",required:!1,type:{name:"boolean"}},opacity:{defaultValue:{value:"1"},description:"Opacity of the node. Mainly used for selection.",name:"opacity",required:!1,type:{name:"number"}},animated:{defaultValue:null,description:"Animation of the node.",name:"animated",required:!0,type:{name:"boolean"}},id:{defaultValue:null,description:"ID of the node.",name:"id",required:!0,type:{name:"string"}}}}}catch{}const Ro=({id:t,image:e,color:n,size:r,opacity:i,animated:a,...o})=>{const s=r/25,{scale:l}=Ut({from:{scale:[1e-5,1e-5,1e-5]},to:{scale:[s,s,s]},config:{...Lt,duration:a?void 0:0}}),u=I.useMemo(()=>new Xt(n),[n]);return re.jsx(Je.group,{userData:{id:t,type:"node"},scale:l,children:re.jsx(Yu,{position:[0,0,1],children:re.jsx(C2,{...o,src:e,fillMaterial:{fog:!0,depthTest:!1,transparent:!0,color:u,opacity:i,side:yt,...o.fillMaterial||{}},fillMeshProps:{position:[-25,-25,1],...o.fillMeshProps||{}}})})})};Ro.defaultProps={opacity:1};try{Ro.displayName="Svg",Ro.__docgenInfo={description:"",displayName:"Svg",props:{color:{defaultValue:null,description:"Color of the node. Handles selected/etc.",name:"color",required:!0,type:{name:"ColorRepresentation"}},node:{defaultValue:null,description:"The internal node model.",name:"node",required:!0,type:{name:"InternalGraphNode"}},size:{defaultValue:null,description:"Size of the node.",name:"size",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"Whether the node is active or not.",name:"active",required:!0,type:{name:"boolean"}},opacity:{defaultValue:{value:"1"},description:"Opacity of the node. Mainly used for selection.",name:"opacity",required:!1,type:{name:"number"}},animated:{defaultValue:null,description:"Animation of the node.",name:"animated",required:!0,type:{name:"boolean"}},id:{defaultValue:null,description:"ID of the node.",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"A Read-only _string_ to check `this` object type.\n@remarks This can be used to find a specific type of Object3D in a scene.\n@remarks Sub-classes will update this value.\n@defaultValue `Object3D`",name:"type",required:!1,type:{name:"string"}},position:{defaultValue:null,description:"",name:"position",required:!1,type:{name:"Vector3"}},onPointerOver:{defaultValue:null,description:"",name:"onPointerOver",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerOut:{defaultValue:null,description:"",name:"onPointerOut",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(event: ThreeEvent<MouseEvent>) => void"}},onDoubleClick:{defaultValue:null,description:"",name:"onDoubleClick",required:!1,type:{name:"(event: ThreeEvent<MouseEvent>) => void"}},onContextMenu:{defaultValue:null,description:"",name:"onContextMenu",required:!1,type:{name:"(event: ThreeEvent<MouseEvent>) => void"}},rotation:{defaultValue:null,description:"",name:"rotation",required:!1,type:{name:"Euler"}},up:{defaultValue:null,description:"",name:"up",required:!1,type:{name:"Vector3"}},scale:{defaultValue:null,description:"",name:"scale",required:!1,type:{name:"Vector3"}},matrix:{defaultValue:null,description:"",name:"matrix",required:!1,type:{name:"Matrix4"}},quaternion:{defaultValue:null,description:"",name:"quaternion",required:!1,type:{name:"Quaternion"}},layers:{defaultValue:null,description:"",name:"layers",required:!1,type:{name:"Layers"}},dispose:{defaultValue:null,description:"",name:"dispose",required:!1,type:{name:"() => void"}},isObject3D:{defaultValue:null,description:"Flag to check if a given object is of type {@link Object3D}.\n@remarks This is a _constant_ value\n@defaultValue `true`",name:"isObject3D",required:!1,type:{name:"true"}},uuid:{defaultValue:null,description:`{@link http://en.wikipedia.org/wiki/Universally_unique_identifier | UUID} of this object instance.
@remarks This gets automatically assigned and shouldn't be edited.`,name:"uuid",required:!1,type:{name:"string"}},name:{defaultValue:null,description:`Optional name of the object
@remarks _(doesn't need to be unique)_.
@defaultValue \`""\``,name:"name",required:!1,type:{name:"string"}},parent:{defaultValue:null,description:"Object's parent in the {@link https://en.wikipedia.org/wiki/Scene_graph | scene graph}.\n@remarks An object can have at most one parent.\n@defaultValue `null`",name:"parent",required:!1,type:{name:"Object3D<Event>"}},modelViewMatrix:{defaultValue:null,description:"@defaultValue `new THREE.Matrix4()`",name:"modelViewMatrix",required:!1,type:{name:"Matrix4"}},normalMatrix:{defaultValue:null,description:"@defaultValue `new THREE.Matrix3()`",name:"normalMatrix",required:!1,type:{name:"Matrix3"}},matrixWorld:{defaultValue:null,description:"The global transform of the object.\n@remarks If the {@link Object3D } has no parent, then it's identical to the local transform {@link THREE.Object3D.matrix .matrix}.\n@defaultValue `new THREE.Matrix4()`",name:"matrixWorld",required:!1,type:{name:"Matrix4"}},matrixAutoUpdate:{defaultValue:null,description:"When this is set, it calculates the matrix of position, (rotation or quaternion) and\nscale every frame and also recalculates the matrixWorld property.\n@defaultValue {@link DEFAULT_MATRIX_AUTO_UPDATE } - that is `(true)`.",name:"matrixAutoUpdate",required:!1,type:{name:"boolean"}},matrixWorldAutoUpdate:{defaultValue:null,description:"If set, then the renderer checks every frame if the object and its children need matrix updates.\nWhen it isn't, then you have to maintain all matrices in the object and its children yourself.\n@defaultValue {@link DEFAULT_MATRIX_WORLD_AUTO_UPDATE } - that is `(true)`.",name:"matrixWorldAutoUpdate",required:!1,type:{name:"boolean"}},matrixWorldNeedsUpdate:{defaultValue:null,description:"When this is set, it calculates the matrixWorld in that frame and resets this property to false.\n@defaultValue `false`",name:"matrixWorldNeedsUpdate",required:!1,type:{name:"boolean"}},visible:{defaultValue:null,description:"Object gets rendered if `true`.\n@defaultValue `true`",name:"visible",required:!1,type:{name:"boolean"}},castShadow:{defaultValue:null,description:"Whether the object gets rendered into shadow map.\n@defaultValue `false`",name:"castShadow",required:!1,type:{name:"boolean"}},receiveShadow:{defaultValue:null,description:"Whether the material receives shadows.\n@defaultValue `false`",name:"receiveShadow",required:!1,type:{name:"boolean"}},frustumCulled:{defaultValue:null,description:"When this is set, it checks every frame if the object is in the frustum of the camera before rendering the object.\nIf set to `false` the object gets rendered every frame even if it is not in the frustum of the camera.\n@defaultValue `true`",name:"frustumCulled",required:!1,type:{name:"boolean"}},renderOrder:{defaultValue:null,description:`This value allows the default rendering order of {@link https://en.wikipedia.org/wiki/Scene_graph | scene graph}
objects to be overridden although opaque and transparent objects remain sorted independently.
@remarks When this property is set for an instance of {@link Group Group}, all descendants objects will be sorted and rendered together.
@remarks Sorting is from lowest to highest renderOrder.
@defaultValue \`0\``,name:"renderOrder",required:!1,type:{name:"number"}},animations:{defaultValue:null,description:"Array with object's animation clips.\n@defaultValue `[]`",name:"animations",required:!1,type:{name:"AnimationClip[]"}},userData:{defaultValue:{value:"`{}`"},description:`An object that can be used to store custom data about the {@link Object3D}.
@remarks It should not hold references to _functions_ as these **will not** be cloned.`,name:"userData",required:!1,type:{name:"{ [key: string]: any; }"}},customDepthMaterial:{defaultValue:null,description:`Custom depth material to be used when rendering to the depth map.
@remarks Can only be used in context of meshes.
@remarks When shadow-casting with a {@link THREE.DirectionalLight DirectionalLight} or {@link THREE.SpotLight SpotLight},
if you are modifying vertex positions in the vertex shader you must specify a customDepthMaterial for proper shadows.
@defaultValue \`undefined\``,name:"customDepthMaterial",required:!1,type:{name:"Material"}},customDistanceMaterial:{defaultValue:null,description:"Same as {@link customDepthMaterial}, but used with {@link THREE.Object3DPointLight PointLight}.\n@defaultValue `undefined`",name:"customDistanceMaterial",required:!1,type:{name:"Material"}},onBeforeRender:{defaultValue:null,description:`An optional callback that is executed immediately before a 3D object is rendered.
@remarks This function is called with the following parameters: renderer, scene, camera, geometry, material, group.
@remarks Please notice that this callback is only executed for \`renderable\` 3D objects.
Meaning 3D objects which define their visual appearance with geometries and materials like
instances of {@link THREE.Object3DMesh Mesh}, {@link THREE.Object3DLine Line}, {@link THREE.Object3DPoints Points} or {@link THREE.Object3DSprite Sprite}.
Instances of {@link THREE.Object3DObject3D Object3D}, {@link THREE.Object3DGroup Group} or {@link THREE.Object3DBone Bone}are not renderable and thus this callback is not executed for such objects.
@defaultValue \`() => {}\``,name:"onBeforeRender",required:!1,type:{name:"(renderer: WebGLRenderer, scene: Scene, camera: Camera, geometry: BufferGeometry<NormalBufferAttributes>, material: Material, group: Group) => void"}},onAfterRender:{defaultValue:null,description:`An optional callback that is executed immediately after a 3D object is rendered.
@remarks This function is called with the following parameters: renderer, scene, camera, geometry, material, group.
@remarks Please notice that this callback is only executed for \`renderable\` 3D objects.
Meaning 3D objects which define their visual appearance with geometries and materials like
instances of {@link THREE.Object3DMesh Mesh}, {@link THREE.Object3DLine Line}, {@link THREE.Object3DPoints Points} or {@link THREE.Object3DSprite Sprite}.
Instances of {@link THREE.Object3DObject3D Object3D}, {@link THREE.Object3DGroup Group} or {@link THREE.Object3DBone Bone}are not renderable and thus this callback is not executed for such objects.
@defaultValue \`() => {}\``,name:"onAfterRender",required:!1,type:{name:"(renderer: WebGLRenderer, scene: Scene, camera: Camera, geometry: BufferGeometry<NormalBufferAttributes>, material: Material, group: Group) => void"}},applyMatrix4:{defaultValue:null,description:`Applies the matrix transform to the object and updates the object's position, rotation and scale.
@param matrix`,name:"applyMatrix4",required:!1,type:{name:"(matrix: Matrix4) => void"}},applyQuaternion:{defaultValue:null,description:`Applies the rotation represented by the quaternion to the object.
@param quaternion`,name:"applyQuaternion",required:!1,type:{name:"(quaternion: Quaternion) => Object3D<Event>"}},setRotationFromAxisAngle:{defaultValue:null,description:"Calls {@link THREE.Quaternion.setFromAxisAnglesetFromAxisAngle}({@link axis}, {@link angle}) on the {@link quaternion.quaternion}.\n@param axis A normalized vector in object space.\n@param angle Angle in radians. Expects a `Float`",name:"setRotationFromAxisAngle",required:!1,type:{name:"(axis: Vector3, angle: number) => void"}},setRotationFromEuler:{defaultValue:null,description:`Calls {@link THREE.Quaternion.setFromEulersetFromEuler}({@link euler}) on the {@link quaternion.quaternion}.
@param euler Euler angle specifying rotation amount.`,name:"setRotationFromEuler",required:!1,type:{name:"(euler: Euler) => void"}},setRotationFromMatrix:{defaultValue:null,description:`Calls {@link THREE.Quaternion.setFromRotationMatrixsetFromRotationMatrix}({@link m}) on the {@link quaternion.quaternion}.
@remarks Note that this assumes that the upper 3x3 of m is a pure rotation matrix (i.e, unscaled).
@param m Rotate the quaternion by the rotation component of the matrix.`,name:"setRotationFromMatrix",required:!1,type:{name:"(m: Matrix4) => void"}},setRotationFromQuaternion:{defaultValue:null,description:`Copy the given {@link THREE.QuaternionQuaternion} into {@link quaternion.quaternion}.
@param q Normalized Quaternion.`,name:"setRotationFromQuaternion",required:!1,type:{name:"(q: Quaternion) => void"}},rotateOnAxis:{defaultValue:null,description:`Rotate an object along an axis in object space.
@remarks The axis is assumed to be normalized.
@param axis A normalized vector in object space.
@param angle The angle in radians. Expects a \`Float\``,name:"rotateOnAxis",required:!1,type:{name:"(axis: Vector3, angle: number) => Object3D<Event>"}},rotateOnWorldAxis:{defaultValue:null,description:`Rotate an object along an axis in world space.
@remarks The axis is assumed to be normalized
@remarks Method Assumes no rotated parent.
@param axis A normalized vector in world space.
@param angle The angle in radians. Expects a \`Float\``,name:"rotateOnWorldAxis",required:!1,type:{name:"(axis: Vector3, angle: number) => Object3D<Event>"}},rotateX:{defaultValue:null,description:"Rotates the object around _x_ axis in local space.\n@param rad The angle to rotate in radians. Expects a `Float`",name:"rotateX",required:!1,type:{name:"(angle: number) => Object3D<Event>"}},rotateY:{defaultValue:null,description:"Rotates the object around _y_ axis in local space.\n@param rad The angle to rotate in radians. Expects a `Float`",name:"rotateY",required:!1,type:{name:"(angle: number) => Object3D<Event>"}},rotateZ:{defaultValue:null,description:"Rotates the object around _z_ axis in local space.\n@param rad The angle to rotate in radians. Expects a `Float`",name:"rotateZ",required:!1,type:{name:"(angle: number) => Object3D<Event>"}},translateOnAxis:{defaultValue:null,description:`Translate an object by distance along an axis in object space
@remarks The axis is assumed to be normalized.
@param axis A normalized vector in object space.
@param distance The distance to translate. Expects a \`Float\``,name:"translateOnAxis",required:!1,type:{name:"(axis: Vector3, distance: number) => Object3D<Event>"}},translateX:{defaultValue:null,description:"Translates object along x axis in object space by {@link distance} units.\n@param distance Expects a `Float`",name:"translateX",required:!1,type:{name:"(distance: number) => Object3D<Event>"}},translateY:{defaultValue:null,description:"Translates object along _y_ axis in object space by {@link distance} units.\n@param distance Expects a `Float`",name:"translateY",required:!1,type:{name:"(distance: number) => Object3D<Event>"}},translateZ:{defaultValue:null,description:"Translates object along _z_ axis in object space by {@link distance} units.\n@param distance Expects a `Float`",name:"translateZ",required:!1,type:{name:"(distance: number) => Object3D<Event>"}},localToWorld:{defaultValue:null,description:`Converts the vector from this object's local space to world space.
@param vector A vector representing a position in this object's local space.`,name:"localToWorld",required:!1,type:{name:"(vector: Vector3) => Vector3"}},worldToLocal:{defaultValue:null,description:`Converts the vector from world space to this object's local space.
@param vector A vector representing a position in world space.`,name:"worldToLocal",required:!1,type:{name:"(vector: Vector3) => Vector3"}},lookAt:{defaultValue:null,description:"Rotates the object to face a point in world space.\n@remarks This method does not support objects having non-uniformly-scaled parent(s).\n@param vector A vector representing a position in world space to look at.\n@remarks This method does not support objects having non-uniformly-scaled parent(s).\n@param x Expects a `Float`\n@param y Expects a `Float`\n@param z Expects a `Float`",name:"lookAt",required:!1,type:{name:"{ (vector: Vector3): void; (x: number, y: number, z: number): void; }"}},add:{defaultValue:null,description:`Adds another {@link Object3D} as child of this {@link Object3D}.
@remarks An arbitrary number of objects may be added
@remarks Any current parent on an {@link object } passed in here will be removed, since an {@link Object3D } can have at most one parent.
@see {@link attach }
@see {@link THREE.Group Group} for info on manually grouping objects.
@param object`,name:"add",required:!1,type:{name:"(...object: Object3D<Event>[]) => Object3D<Event>"}},remove:{defaultValue:null,description:`Removes a {@link Object3D} as child of this {@link Object3D}.
@remarks An arbitrary number of objects may be removed.
@see {@link THREE.Group Group} for info on manually grouping objects.
@param object`,name:"remove",required:!1,type:{name:"(...object: Object3D<Event>[]) => Object3D<Event>"}},removeFromParent:{defaultValue:null,description:"Removes this object from its current parent.",name:"removeFromParent",required:!1,type:{name:"() => Object3D<Event>"}},clear:{defaultValue:null,description:"Removes all child objects.",name:"clear",required:!1,type:{name:"() => Object3D<Event>"}},getObjectById:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself, and returns the first with a matching id.
@remarks Note that ids are assigned in chronological order: 1, 2, 3, ..., incrementing by one for each new object.
@see {@link id }
@param id Unique number of the object instance. Expects a \`Integer\``,name:"getObjectById",required:!1,type:{name:"(id: number) => Object3D<Event>"}},getObjectByName:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself, and returns the first with a matching name.
@remarks Note that for most objects the name is an empty string by default
@remarks You will have to set it manually to make use of this method.
@param name String to match to the children's Object3D.name property.`,name:"getObjectByName",required:!1,type:{name:"(name: string) => Object3D<Event>"}},getObjectByProperty:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself,
and returns the first with a property that matches the value given.
@param name - the property name to search for.
@param value - value of the given property.`,name:"getObjectByProperty",required:!1,type:{name:"(name: string, value: any) => Object3D<Event>"}},getObjectsByProperty:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself,
and returns the first with a property that matches the value given.
@param name The property name to search for.
@param value Value of the given property.`,name:"getObjectsByProperty",required:!1,type:{name:"(name: string, value: any) => Object3D<Event>[]"}},getWorldPosition:{defaultValue:null,description:`Returns a vector representing the position of the object in world space.
@param target The result will be copied into this Vector3.`,name:"getWorldPosition",required:!1,type:{name:"(target: Vector3) => Vector3"}},getWorldQuaternion:{defaultValue:null,description:`Returns a quaternion representing the rotation of the object in world space.
@param target The result will be copied into this Quaternion.`,name:"getWorldQuaternion",required:!1,type:{name:"(target: Quaternion) => Quaternion"}},getWorldScale:{defaultValue:null,description:`Returns a vector of the scaling factors applied to the object for each axis in world space.
@param target The result will be copied into this Vector3.`,name:"getWorldScale",required:!1,type:{name:"(target: Vector3) => Vector3"}},getWorldDirection:{defaultValue:null,description:`Returns a vector representing the direction of object's positive z-axis in world space.
@param target The result will be copied into this Vector3.`,name:"getWorldDirection",required:!1,type:{name:"(target: Vector3) => Vector3"}},raycast:{defaultValue:null,description:`Abstract (empty) method to get intersections between a casted ray and this object
@remarks Subclasses such as {@link THREE.Mesh Mesh}, {@link THREE.Line Line}, and {@link THREE.Points Points} implement this method in order to use raycasting.
@see {@link THREE.Raycaster Raycaster}
@param raycaster
@param intersects
@defaultValue \`() => {}\``,name:"raycast",required:!1,type:{name:"(raycaster: Raycaster, intersects: Intersection<Object3D<Event>>[]) => void"}},traverse:{defaultValue:null,description:`Executes the callback on this object and all descendants.
@remarks Note: Modifying the scene graph inside the callback is discouraged.
@param callback A function with as first argument an {@link Object3D } object.`,name:"traverse",required:!1,type:{name:"(callback: (object: Object3D<Event>) => any) => void"}},traverseVisible:{defaultValue:null,description:`Like traverse, but the callback will only be executed for visible objects
@remarks Descendants of invisible objects are not traversed.
@remarks Note: Modifying the scene graph inside the callback is discouraged.
@param callback A function with as first argument an {@link Object3D } object.`,name:"traverseVisible",required:!1,type:{name:"(callback: (object: Object3D<Event>) => any) => void"}},traverseAncestors:{defaultValue:null,description:`Executes the callback on all ancestors.
@remarks Note: Modifying the scene graph inside the callback is discouraged.
@param callback A function with as first argument an {@link Object3D } object.`,name:"traverseAncestors",required:!1,type:{name:"(callback: (object: Object3D<Event>) => any) => void"}},updateMatrix:{defaultValue:null,description:"Updates local transform.",name:"updateMatrix",required:!1,type:{name:"() => void"}},updateMatrixWorld:{defaultValue:null,description:"Updates the global transform of the object.\nAnd will update the object descendants if {@link matrixWorldNeedsUpdate.matrixWorldNeedsUpdate} is set to true or if the {@link force} parameter is set to `true`.\n@param force A boolean that can be used to bypass {@link matrixWorldAutoUpdate .matrixWorldAutoUpdate}, to recalculate the world matrix of the object and descendants on the current frame.\nUseful if you cannot wait for the renderer to update it on the next frame, assuming {@link matrixWorldAutoUpdate .matrixWorldAutoUpdate} set to `true`.",name:"updateMatrixWorld",required:!1,type:{name:"(force?: boolean) => void"}},updateWorldMatrix:{defaultValue:null,description:`Updates the global transform of the object.
@param updateParents Recursively updates global transform of ancestors.
@param updateChildren Recursively updates global transform of descendants.`,name:"updateWorldMatrix",required:!1,type:{name:"(updateParents: boolean, updateChildren: boolean) => void"}},toJSON:{defaultValue:null,description:`Convert the object to three.js {@link https://github.com/mrdoob/three.js/wiki/JSON-Object-Scene-format-4 | JSON Object/Scene format}.
@param meta Object containing metadata such as materials, textures or images for the object.`,name:"toJSON",required:!1,type:{name:"(meta?: { geometries: any; materials: any; textures: any; images: any; }) => any"}},clone:{defaultValue:null,description:"Returns a clone of `this` object and optionally all descendants.\n@param recursive If true, descendants of the object are also cloned. Default `true`",name:"clone",required:!1,type:{name:"(recursive?: boolean) => Object3D<Event>"}},copy:{defaultValue:null,description:`Copy the given object into this object
@remarks Note: event listeners and user-defined callbacks ({@link onAfterRender .onAfterRender} and {@link onBeforeRender .onBeforeRender}) are not copied.
@param source
@param recursive If true, descendants of the object are also copied. Default \`true\``,name:"copy",required:!1,type:{name:"(source: Object3D<Event>, recursive?: boolean) => Object3D<Event>"}},addEventListener:{defaultValue:null,description:`Adds a listener to an event type.
@param type The type of event to listen to.
@param listener The function that gets called when the event is fired.`,name:"addEventListener",required:!1,type:{name:"<T extends string>(type: T, listener: EventListener<Event, T, Object3D<Event>>) => void"}},hasEventListener:{defaultValue:null,description:`Checks if listener is added to an event type.
@param type The type of event to listen to.
@param listener The function that gets called when the event is fired.`,name:"hasEventListener",required:!1,type:{name:"<T extends string>(type: T, listener: EventListener<Event, T, Object3D<Event>>) => boolean"}},removeEventListener:{defaultValue:null,description:`Removes a listener from an event type.
@param type The type of the listener that gets removed.
@param listener The listener function that gets removed.`,name:"removeEventListener",required:!1,type:{name:"<T extends string>(type: T, listener: EventListener<Event, T, Object3D<Event>>) => void"}},dispatchEvent:{defaultValue:null,description:`Fire an event type.
@param event The event that gets fired.`,name:"dispatchEvent",required:!1,type:{name:"(event: Event) => void"}},onPointerUp:{defaultValue:null,description:"",name:"onPointerUp",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerDown:{defaultValue:null,description:"",name:"onPointerDown",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerEnter:{defaultValue:null,description:"",name:"onPointerEnter",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerLeave:{defaultValue:null,description:"",name:"onPointerLeave",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerMove:{defaultValue:null,description:"",name:"onPointerMove",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerMissed:{defaultValue:null,description:"",name:"onPointerMissed",required:!1,type:{name:"(event: MouseEvent) => void"}},onPointerCancel:{defaultValue:null,description:"",name:"onPointerCancel",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onWheel:{defaultValue:null,description:"",name:"onWheel",required:!1,type:{name:"(event: ThreeEvent<WheelEvent>) => void"}},image:{defaultValue:null,description:"The image to display on the icon.",name:"image",required:!0,type:{name:"string"}}}}}catch{}const zl=({color:t,id:e,size:n,opacity:r,node:i,svgFill:a,active:o,animated:s,image:l,...u})=>re.jsxs(re.Fragment,{children:[re.jsx(zr,{id:e,size:n,opacity:r,animated:s,color:t,node:i,active:o}),re.jsx(Ro,{...u,id:e,image:l,size:n,opacity:r,animated:s,color:a,node:i,active:o})]});zl.defaultProps={opacity:1,active:!1,selected:!1};try{zl.displayName="SphereWithSvg",zl.__docgenInfo={description:"",displayName:"SphereWithSvg",props:{image:{defaultValue:null,description:"The image to display on the icon.",name:"image",required:!0,type:{name:"string"}},svgFill:{defaultValue:null,description:"The color of the svg fill.",name:"svgFill",required:!1,type:{name:"ColorRepresentation"}},color:{defaultValue:null,description:"Color of the node. Handles selected/etc.",name:"color",required:!0,type:{name:"ColorRepresentation"}},node:{defaultValue:null,description:"The internal node model.",name:"node",required:!0,type:{name:"InternalGraphNode"}},size:{defaultValue:null,description:"Size of the node.",name:"size",required:!0,type:{name:"number"}},active:{defaultValue:{value:"false"},description:"Whether the node is active or not.",name:"active",required:!1,type:{name:"boolean"}},opacity:{defaultValue:{value:"1"},description:"Opacity of the node. Mainly used for selection.",name:"opacity",required:!1,type:{name:"number"}},animated:{defaultValue:null,description:"Animation of the node.",name:"animated",required:!0,type:{name:"boolean"}},id:{defaultValue:null,description:"ID of the node.",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"A Read-only _string_ to check `this` object type.\n@remarks This can be used to find a specific type of Object3D in a scene.\n@remarks Sub-classes will update this value.\n@defaultValue `Object3D`",name:"type",required:!1,type:{name:"string"}},position:{defaultValue:null,description:"",name:"position",required:!1,type:{name:"Vector3"}},onPointerOver:{defaultValue:null,description:"",name:"onPointerOver",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerOut:{defaultValue:null,description:"",name:"onPointerOut",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(event: ThreeEvent<MouseEvent>) => void"}},onDoubleClick:{defaultValue:null,description:"",name:"onDoubleClick",required:!1,type:{name:"(event: ThreeEvent<MouseEvent>) => void"}},onContextMenu:{defaultValue:null,description:"",name:"onContextMenu",required:!1,type:{name:"(event: ThreeEvent<MouseEvent>) => void"}},rotation:{defaultValue:null,description:"",name:"rotation",required:!1,type:{name:"Euler"}},up:{defaultValue:null,description:"",name:"up",required:!1,type:{name:"Vector3"}},scale:{defaultValue:null,description:"",name:"scale",required:!1,type:{name:"Vector3"}},matrix:{defaultValue:null,description:"",name:"matrix",required:!1,type:{name:"Matrix4"}},quaternion:{defaultValue:null,description:"",name:"quaternion",required:!1,type:{name:"Quaternion"}},layers:{defaultValue:null,description:"",name:"layers",required:!1,type:{name:"Layers"}},dispose:{defaultValue:null,description:"",name:"dispose",required:!1,type:{name:"() => void"}},isObject3D:{defaultValue:null,description:"Flag to check if a given object is of type {@link Object3D}.\n@remarks This is a _constant_ value\n@defaultValue `true`",name:"isObject3D",required:!1,type:{name:"true"}},uuid:{defaultValue:null,description:`{@link http://en.wikipedia.org/wiki/Universally_unique_identifier | UUID} of this object instance.
@remarks This gets automatically assigned and shouldn't be edited.`,name:"uuid",required:!1,type:{name:"string"}},name:{defaultValue:null,description:`Optional name of the object
@remarks _(doesn't need to be unique)_.
@defaultValue \`""\``,name:"name",required:!1,type:{name:"string"}},parent:{defaultValue:null,description:"Object's parent in the {@link https://en.wikipedia.org/wiki/Scene_graph | scene graph}.\n@remarks An object can have at most one parent.\n@defaultValue `null`",name:"parent",required:!1,type:{name:"Object3D<Event>"}},modelViewMatrix:{defaultValue:null,description:"@defaultValue `new THREE.Matrix4()`",name:"modelViewMatrix",required:!1,type:{name:"Matrix4"}},normalMatrix:{defaultValue:null,description:"@defaultValue `new THREE.Matrix3()`",name:"normalMatrix",required:!1,type:{name:"Matrix3"}},matrixWorld:{defaultValue:null,description:"The global transform of the object.\n@remarks If the {@link Object3D } has no parent, then it's identical to the local transform {@link THREE.Object3D.matrix .matrix}.\n@defaultValue `new THREE.Matrix4()`",name:"matrixWorld",required:!1,type:{name:"Matrix4"}},matrixAutoUpdate:{defaultValue:null,description:"When this is set, it calculates the matrix of position, (rotation or quaternion) and\nscale every frame and also recalculates the matrixWorld property.\n@defaultValue {@link DEFAULT_MATRIX_AUTO_UPDATE } - that is `(true)`.",name:"matrixAutoUpdate",required:!1,type:{name:"boolean"}},matrixWorldAutoUpdate:{defaultValue:null,description:"If set, then the renderer checks every frame if the object and its children need matrix updates.\nWhen it isn't, then you have to maintain all matrices in the object and its children yourself.\n@defaultValue {@link DEFAULT_MATRIX_WORLD_AUTO_UPDATE } - that is `(true)`.",name:"matrixWorldAutoUpdate",required:!1,type:{name:"boolean"}},matrixWorldNeedsUpdate:{defaultValue:null,description:"When this is set, it calculates the matrixWorld in that frame and resets this property to false.\n@defaultValue `false`",name:"matrixWorldNeedsUpdate",required:!1,type:{name:"boolean"}},visible:{defaultValue:null,description:"Object gets rendered if `true`.\n@defaultValue `true`",name:"visible",required:!1,type:{name:"boolean"}},castShadow:{defaultValue:null,description:"Whether the object gets rendered into shadow map.\n@defaultValue `false`",name:"castShadow",required:!1,type:{name:"boolean"}},receiveShadow:{defaultValue:null,description:"Whether the material receives shadows.\n@defaultValue `false`",name:"receiveShadow",required:!1,type:{name:"boolean"}},frustumCulled:{defaultValue:null,description:"When this is set, it checks every frame if the object is in the frustum of the camera before rendering the object.\nIf set to `false` the object gets rendered every frame even if it is not in the frustum of the camera.\n@defaultValue `true`",name:"frustumCulled",required:!1,type:{name:"boolean"}},renderOrder:{defaultValue:null,description:`This value allows the default rendering order of {@link https://en.wikipedia.org/wiki/Scene_graph | scene graph}
objects to be overridden although opaque and transparent objects remain sorted independently.
@remarks When this property is set for an instance of {@link Group Group}, all descendants objects will be sorted and rendered together.
@remarks Sorting is from lowest to highest renderOrder.
@defaultValue \`0\``,name:"renderOrder",required:!1,type:{name:"number"}},animations:{defaultValue:null,description:"Array with object's animation clips.\n@defaultValue `[]`",name:"animations",required:!1,type:{name:"AnimationClip[]"}},userData:{defaultValue:{value:"`{}`"},description:`An object that can be used to store custom data about the {@link Object3D}.
@remarks It should not hold references to _functions_ as these **will not** be cloned.`,name:"userData",required:!1,type:{name:"{ [key: string]: any; }"}},customDepthMaterial:{defaultValue:null,description:`Custom depth material to be used when rendering to the depth map.
@remarks Can only be used in context of meshes.
@remarks When shadow-casting with a {@link THREE.DirectionalLight DirectionalLight} or {@link THREE.SpotLight SpotLight},
if you are modifying vertex positions in the vertex shader you must specify a customDepthMaterial for proper shadows.
@defaultValue \`undefined\``,name:"customDepthMaterial",required:!1,type:{name:"Material"}},customDistanceMaterial:{defaultValue:null,description:"Same as {@link customDepthMaterial}, but used with {@link THREE.Object3DPointLight PointLight}.\n@defaultValue `undefined`",name:"customDistanceMaterial",required:!1,type:{name:"Material"}},onBeforeRender:{defaultValue:null,description:`An optional callback that is executed immediately before a 3D object is rendered.
@remarks This function is called with the following parameters: renderer, scene, camera, geometry, material, group.
@remarks Please notice that this callback is only executed for \`renderable\` 3D objects.
Meaning 3D objects which define their visual appearance with geometries and materials like
instances of {@link THREE.Object3DMesh Mesh}, {@link THREE.Object3DLine Line}, {@link THREE.Object3DPoints Points} or {@link THREE.Object3DSprite Sprite}.
Instances of {@link THREE.Object3DObject3D Object3D}, {@link THREE.Object3DGroup Group} or {@link THREE.Object3DBone Bone}are not renderable and thus this callback is not executed for such objects.
@defaultValue \`() => {}\``,name:"onBeforeRender",required:!1,type:{name:"(renderer: WebGLRenderer, scene: Scene, camera: Camera, geometry: BufferGeometry<NormalBufferAttributes>, material: Material, group: Group) => void"}},onAfterRender:{defaultValue:null,description:`An optional callback that is executed immediately after a 3D object is rendered.
@remarks This function is called with the following parameters: renderer, scene, camera, geometry, material, group.
@remarks Please notice that this callback is only executed for \`renderable\` 3D objects.
Meaning 3D objects which define their visual appearance with geometries and materials like
instances of {@link THREE.Object3DMesh Mesh}, {@link THREE.Object3DLine Line}, {@link THREE.Object3DPoints Points} or {@link THREE.Object3DSprite Sprite}.
Instances of {@link THREE.Object3DObject3D Object3D}, {@link THREE.Object3DGroup Group} or {@link THREE.Object3DBone Bone}are not renderable and thus this callback is not executed for such objects.
@defaultValue \`() => {}\``,name:"onAfterRender",required:!1,type:{name:"(renderer: WebGLRenderer, scene: Scene, camera: Camera, geometry: BufferGeometry<NormalBufferAttributes>, material: Material, group: Group) => void"}},applyMatrix4:{defaultValue:null,description:`Applies the matrix transform to the object and updates the object's position, rotation and scale.
@param matrix`,name:"applyMatrix4",required:!1,type:{name:"(matrix: Matrix4) => void"}},applyQuaternion:{defaultValue:null,description:`Applies the rotation represented by the quaternion to the object.
@param quaternion`,name:"applyQuaternion",required:!1,type:{name:"(quaternion: Quaternion) => Object3D<Event>"}},setRotationFromAxisAngle:{defaultValue:null,description:"Calls {@link THREE.Quaternion.setFromAxisAnglesetFromAxisAngle}({@link axis}, {@link angle}) on the {@link quaternion.quaternion}.\n@param axis A normalized vector in object space.\n@param angle Angle in radians. Expects a `Float`",name:"setRotationFromAxisAngle",required:!1,type:{name:"(axis: Vector3, angle: number) => void"}},setRotationFromEuler:{defaultValue:null,description:`Calls {@link THREE.Quaternion.setFromEulersetFromEuler}({@link euler}) on the {@link quaternion.quaternion}.
@param euler Euler angle specifying rotation amount.`,name:"setRotationFromEuler",required:!1,type:{name:"(euler: Euler) => void"}},setRotationFromMatrix:{defaultValue:null,description:`Calls {@link THREE.Quaternion.setFromRotationMatrixsetFromRotationMatrix}({@link m}) on the {@link quaternion.quaternion}.
@remarks Note that this assumes that the upper 3x3 of m is a pure rotation matrix (i.e, unscaled).
@param m Rotate the quaternion by the rotation component of the matrix.`,name:"setRotationFromMatrix",required:!1,type:{name:"(m: Matrix4) => void"}},setRotationFromQuaternion:{defaultValue:null,description:`Copy the given {@link THREE.QuaternionQuaternion} into {@link quaternion.quaternion}.
@param q Normalized Quaternion.`,name:"setRotationFromQuaternion",required:!1,type:{name:"(q: Quaternion) => void"}},rotateOnAxis:{defaultValue:null,description:`Rotate an object along an axis in object space.
@remarks The axis is assumed to be normalized.
@param axis A normalized vector in object space.
@param angle The angle in radians. Expects a \`Float\``,name:"rotateOnAxis",required:!1,type:{name:"(axis: Vector3, angle: number) => Object3D<Event>"}},rotateOnWorldAxis:{defaultValue:null,description:`Rotate an object along an axis in world space.
@remarks The axis is assumed to be normalized
@remarks Method Assumes no rotated parent.
@param axis A normalized vector in world space.
@param angle The angle in radians. Expects a \`Float\``,name:"rotateOnWorldAxis",required:!1,type:{name:"(axis: Vector3, angle: number) => Object3D<Event>"}},rotateX:{defaultValue:null,description:"Rotates the object around _x_ axis in local space.\n@param rad The angle to rotate in radians. Expects a `Float`",name:"rotateX",required:!1,type:{name:"(angle: number) => Object3D<Event>"}},rotateY:{defaultValue:null,description:"Rotates the object around _y_ axis in local space.\n@param rad The angle to rotate in radians. Expects a `Float`",name:"rotateY",required:!1,type:{name:"(angle: number) => Object3D<Event>"}},rotateZ:{defaultValue:null,description:"Rotates the object around _z_ axis in local space.\n@param rad The angle to rotate in radians. Expects a `Float`",name:"rotateZ",required:!1,type:{name:"(angle: number) => Object3D<Event>"}},translateOnAxis:{defaultValue:null,description:`Translate an object by distance along an axis in object space
@remarks The axis is assumed to be normalized.
@param axis A normalized vector in object space.
@param distance The distance to translate. Expects a \`Float\``,name:"translateOnAxis",required:!1,type:{name:"(axis: Vector3, distance: number) => Object3D<Event>"}},translateX:{defaultValue:null,description:"Translates object along x axis in object space by {@link distance} units.\n@param distance Expects a `Float`",name:"translateX",required:!1,type:{name:"(distance: number) => Object3D<Event>"}},translateY:{defaultValue:null,description:"Translates object along _y_ axis in object space by {@link distance} units.\n@param distance Expects a `Float`",name:"translateY",required:!1,type:{name:"(distance: number) => Object3D<Event>"}},translateZ:{defaultValue:null,description:"Translates object along _z_ axis in object space by {@link distance} units.\n@param distance Expects a `Float`",name:"translateZ",required:!1,type:{name:"(distance: number) => Object3D<Event>"}},localToWorld:{defaultValue:null,description:`Converts the vector from this object's local space to world space.
@param vector A vector representing a position in this object's local space.`,name:"localToWorld",required:!1,type:{name:"(vector: Vector3) => Vector3"}},worldToLocal:{defaultValue:null,description:`Converts the vector from world space to this object's local space.
@param vector A vector representing a position in world space.`,name:"worldToLocal",required:!1,type:{name:"(vector: Vector3) => Vector3"}},lookAt:{defaultValue:null,description:"Rotates the object to face a point in world space.\n@remarks This method does not support objects having non-uniformly-scaled parent(s).\n@param vector A vector representing a position in world space to look at.\n@remarks This method does not support objects having non-uniformly-scaled parent(s).\n@param x Expects a `Float`\n@param y Expects a `Float`\n@param z Expects a `Float`",name:"lookAt",required:!1,type:{name:"{ (vector: Vector3): void; (x: number, y: number, z: number): void; }"}},add:{defaultValue:null,description:`Adds another {@link Object3D} as child of this {@link Object3D}.
@remarks An arbitrary number of objects may be added
@remarks Any current parent on an {@link object } passed in here will be removed, since an {@link Object3D } can have at most one parent.
@see {@link attach }
@see {@link THREE.Group Group} for info on manually grouping objects.
@param object`,name:"add",required:!1,type:{name:"(...object: Object3D<Event>[]) => Object3D<Event>"}},remove:{defaultValue:null,description:`Removes a {@link Object3D} as child of this {@link Object3D}.
@remarks An arbitrary number of objects may be removed.
@see {@link THREE.Group Group} for info on manually grouping objects.
@param object`,name:"remove",required:!1,type:{name:"(...object: Object3D<Event>[]) => Object3D<Event>"}},removeFromParent:{defaultValue:null,description:"Removes this object from its current parent.",name:"removeFromParent",required:!1,type:{name:"() => Object3D<Event>"}},clear:{defaultValue:null,description:"Removes all child objects.",name:"clear",required:!1,type:{name:"() => Object3D<Event>"}},getObjectById:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself, and returns the first with a matching id.
@remarks Note that ids are assigned in chronological order: 1, 2, 3, ..., incrementing by one for each new object.
@see {@link id }
@param id Unique number of the object instance. Expects a \`Integer\``,name:"getObjectById",required:!1,type:{name:"(id: number) => Object3D<Event>"}},getObjectByName:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself, and returns the first with a matching name.
@remarks Note that for most objects the name is an empty string by default
@remarks You will have to set it manually to make use of this method.
@param name String to match to the children's Object3D.name property.`,name:"getObjectByName",required:!1,type:{name:"(name: string) => Object3D<Event>"}},getObjectByProperty:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself,
and returns the first with a property that matches the value given.
@param name - the property name to search for.
@param value - value of the given property.`,name:"getObjectByProperty",required:!1,type:{name:"(name: string, value: any) => Object3D<Event>"}},getObjectsByProperty:{defaultValue:null,description:`Searches through an object and its children, starting with the object itself,
and returns the first with a property that matches the value given.
@param name The property name to search for.
@param value Value of the given property.`,name:"getObjectsByProperty",required:!1,type:{name:"(name: string, value: any) => Object3D<Event>[]"}},getWorldPosition:{defaultValue:null,description:`Returns a vector representing the position of the object in world space.
@param target The result will be copied into this Vector3.`,name:"getWorldPosition",required:!1,type:{name:"(target: Vector3) => Vector3"}},getWorldQuaternion:{defaultValue:null,description:`Returns a quaternion representing the rotation of the object in world space.
@param target The result will be copied into this Quaternion.`,name:"getWorldQuaternion",required:!1,type:{name:"(target: Quaternion) => Quaternion"}},getWorldScale:{defaultValue:null,description:`Returns a vector of the scaling factors applied to the object for each axis in world space.
@param target The result will be copied into this Vector3.`,name:"getWorldScale",required:!1,type:{name:"(target: Vector3) => Vector3"}},getWorldDirection:{defaultValue:null,description:`Returns a vector representing the direction of object's positive z-axis in world space.
@param target The result will be copied into this Vector3.`,name:"getWorldDirection",required:!1,type:{name:"(target: Vector3) => Vector3"}},raycast:{defaultValue:null,description:`Abstract (empty) method to get intersections between a casted ray and this object
@remarks Subclasses such as {@link THREE.Mesh Mesh}, {@link THREE.Line Line}, and {@link THREE.Points Points} implement this method in order to use raycasting.
@see {@link THREE.Raycaster Raycaster}
@param raycaster
@param intersects
@defaultValue \`() => {}\``,name:"raycast",required:!1,type:{name:"(raycaster: Raycaster, intersects: Intersection<Object3D<Event>>[]) => void"}},traverse:{defaultValue:null,description:`Executes the callback on this object and all descendants.
@remarks Note: Modifying the scene graph inside the callback is discouraged.
@param callback A function with as first argument an {@link Object3D } object.`,name:"traverse",required:!1,type:{name:"(callback: (object: Object3D<Event>) => any) => void"}},traverseVisible:{defaultValue:null,description:`Like traverse, but the callback will only be executed for visible objects
@remarks Descendants of invisible objects are not traversed.
@remarks Note: Modifying the scene graph inside the callback is discouraged.
@param callback A function with as first argument an {@link Object3D } object.`,name:"traverseVisible",required:!1,type:{name:"(callback: (object: Object3D<Event>) => any) => void"}},traverseAncestors:{defaultValue:null,description:`Executes the callback on all ancestors.
@remarks Note: Modifying the scene graph inside the callback is discouraged.
@param callback A function with as first argument an {@link Object3D } object.`,name:"traverseAncestors",required:!1,type:{name:"(callback: (object: Object3D<Event>) => any) => void"}},updateMatrix:{defaultValue:null,description:"Updates local transform.",name:"updateMatrix",required:!1,type:{name:"() => void"}},updateMatrixWorld:{defaultValue:null,description:"Updates the global transform of the object.\nAnd will update the object descendants if {@link matrixWorldNeedsUpdate.matrixWorldNeedsUpdate} is set to true or if the {@link force} parameter is set to `true`.\n@param force A boolean that can be used to bypass {@link matrixWorldAutoUpdate .matrixWorldAutoUpdate}, to recalculate the world matrix of the object and descendants on the current frame.\nUseful if you cannot wait for the renderer to update it on the next frame, assuming {@link matrixWorldAutoUpdate .matrixWorldAutoUpdate} set to `true`.",name:"updateMatrixWorld",required:!1,type:{name:"(force?: boolean) => void"}},updateWorldMatrix:{defaultValue:null,description:`Updates the global transform of the object.
@param updateParents Recursively updates global transform of ancestors.
@param updateChildren Recursively updates global transform of descendants.`,name:"updateWorldMatrix",required:!1,type:{name:"(updateParents: boolean, updateChildren: boolean) => void"}},toJSON:{defaultValue:null,description:`Convert the object to three.js {@link https://github.com/mrdoob/three.js/wiki/JSON-Object-Scene-format-4 | JSON Object/Scene format}.
@param meta Object containing metadata such as materials, textures or images for the object.`,name:"toJSON",required:!1,type:{name:"(meta?: { geometries: any; materials: any; textures: any; images: any; }) => any"}},clone:{defaultValue:null,description:"Returns a clone of `this` object and optionally all descendants.\n@param recursive If true, descendants of the object are also cloned. Default `true`",name:"clone",required:!1,type:{name:"(recursive?: boolean) => Object3D<Event>"}},copy:{defaultValue:null,description:`Copy the given object into this object
@remarks Note: event listeners and user-defined callbacks ({@link onAfterRender .onAfterRender} and {@link onBeforeRender .onBeforeRender}) are not copied.
@param source
@param recursive If true, descendants of the object are also copied. Default \`true\``,name:"copy",required:!1,type:{name:"(source: Object3D<Event>, recursive?: boolean) => Object3D<Event>"}},addEventListener:{defaultValue:null,description:`Adds a listener to an event type.
@param type The type of event to listen to.
@param listener The function that gets called when the event is fired.`,name:"addEventListener",required:!1,type:{name:"<T extends string>(type: T, listener: EventListener<Event, T, Object3D<Event>>) => void"}},hasEventListener:{defaultValue:null,description:`Checks if listener is added to an event type.
@param type The type of event to listen to.
@param listener The function that gets called when the event is fired.`,name:"hasEventListener",required:!1,type:{name:"<T extends string>(type: T, listener: EventListener<Event, T, Object3D<Event>>) => boolean"}},removeEventListener:{defaultValue:null,description:`Removes a listener from an event type.
@param type The type of the listener that gets removed.
@param listener The listener function that gets removed.`,name:"removeEventListener",required:!1,type:{name:"<T extends string>(type: T, listener: EventListener<Event, T, Object3D<Event>>) => void"}},dispatchEvent:{defaultValue:null,description:`Fire an event type.
@param event The event that gets fired.`,name:"dispatchEvent",required:!1,type:{name:"(event: Event) => void"}},onPointerUp:{defaultValue:null,description:"",name:"onPointerUp",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerDown:{defaultValue:null,description:"",name:"onPointerDown",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerEnter:{defaultValue:null,description:"",name:"onPointerEnter",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerLeave:{defaultValue:null,description:"",name:"onPointerLeave",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerMove:{defaultValue:null,description:"",name:"onPointerMove",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerMissed:{defaultValue:null,description:"",name:"onPointerMissed",required:!1,type:{name:"(event: MouseEvent) => void"}},onPointerCancel:{defaultValue:null,description:"",name:"onPointerCancel",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onWheel:{defaultValue:null,description:"",name:"onWheel",required:!1,type:{name:"(event: ThreeEvent<WheelEvent>) => void"}}}}}catch{}const Io=({animated:t,disabled:e,id:n,draggable:r,labelFontUrl:i,contextMenu:a,onClick:o,onDoubleClick:s,onPointerOver:l,onDragged:u,onPointerOut:c,onContextMenu:f,renderNode:d})=>{var Y,ae,te;const h=Xu(),p=he(K=>K.theme),g=he(K=>K.nodes.find(U=>U.id===n)),m=he(K=>K.edges),v=he(K=>K.draggingId),_=he(K=>K.collapsedNodeIds),w=he(K=>K.setDraggingId),y=he(K=>K.setNodePosition),b=he(K=>K.setCollapsedNodeIds),S=he(K=>K.collapsedNodeIds.includes(n)),E=he(K=>{var U;return(U=K.actives)==null?void 0:U.includes(n)}),x=he(K=>{var U;return(U=K.selections)==null?void 0:U.includes(n)}),A=he(K=>{var U;return((U=K.selections)==null?void 0:U.length)>0}),V=v===n,{position:F,label:P,subLabel:N,size:W=7,labelVisible:H=!0}=g,L=I.useRef(null),[G,B]=I.useState(!1),[q,$]=I.useState(!1),R=A?x||G||E?p.node.selectedOpacity:p.node.inactiveOpacity:p.node.opacity,O=I.useMemo(()=>m.filter(U=>U.source===n).length>0||S,[m,n,S]),D=I.useCallback(()=>{O&&b(S?_.filter(K=>K!==n):[..._,n])},[O,_,n,S,b]),[{nodePosition:T,labelPosition:C,subLabelPosition:j}]=Ut(()=>({from:{nodePosition:[0,0,0],labelPosition:[0,-(W+7),2],subLabelPosition:[0,-(W+14),2]},to:{nodePosition:F?[F.x,F.y,F.z]:[0,0,0],labelPosition:[0,-(W+7),2],subLabelPosition:[0,-(W+14),2]},config:{...Lt,duration:t&&!v?void 0:0}}),[V,F,t,W]),k=f_({draggable:r,position:F,set:K=>y(n,K),onDragStart:()=>{w(n),B(!0),h.controls.enabled=!1},onDragEnd:()=>{w(null),B(!1),h.controls.enabled=!0,u==null||u(g)}});Vi(G&&!v&&o!==void 0,"pointer"),Vi(G&&r&&!V&&o===void 0,"grab"),Vi(V,"grabbing");const z=x||G||V||E,J=z?p.node.activeFill:g.fill||p.node.fill,{pointerOver:Q,pointerOut:X}=du({disabled:e||V,onPointerOver:()=>{B(!0),l==null||l(g)},onPointerOut:()=>{B(!1),c==null||c(g)}});return re.jsxs(Je.group,{userData:{id:n,type:"node"},ref:L,position:T,onPointerOver:Q,onPointerOut:X,onClick:()=>{!e&&!V&&(o==null||o(g,{canCollapse:O,isCollapsed:S}))},onDoubleClick:()=>{!e&&!V&&(s==null||s(g))},onContextMenu:()=>{e||($(!0),f==null||f(g,{canCollapse:O,isCollapsed:S,onCollapse:D}))},...k(),children:[d?d({id:n,color:J,size:W,active:z,opacity:R,animated:t,node:g}):re.jsx(re.Fragment,{children:g.icon?re.jsx(ia,{id:n,image:g.icon||"",size:W+8,opacity:R,animated:t,color:J,node:g,active:z}):re.jsx(zr,{id:n,size:W,opacity:R,animated:t,color:J,node:g,active:z})}),re.jsx(Po,{opacity:x?.5:0,size:W,animated:t,color:x||G?p.ring.activeFill:p.ring.fill}),q&&a&&re.jsx(Pu,{prepend:!0,center:!0,children:a({data:g,canCollapse:O,isCollapsed:S,onCollapse:D,onClose:()=>$(!1)})}),(H||x||G)&&P&&re.jsxs(re.Fragment,{children:[re.jsx(Je.group,{position:C,children:re.jsx(Yn,{text:P,fontUrl:i,opacity:R,stroke:p.node.label.stroke,active:x||G||V||E,color:x||G||V||E?p.node.label.activeColor:p.node.label.color})}),N&&re.jsx(Je.group,{position:j,children:re.jsx(Yn,{text:N,fontUrl:i,fontSize:5,opacity:R,stroke:(Y=p.node.subLabel)==null?void 0:Y.stroke,active:x||G||V||E,color:x||G||V||E?(ae=p.node.subLabel)==null?void 0:ae.activeColor:(te=p.node.subLabel)==null?void 0:te.color})})]})]})};Io.defaultProps={draggable:!1};try{Io.displayName="Node",Io.__docgenInfo={description:"",displayName:"Node",props:{id:{defaultValue:null,description:"The unique identifier for the node.",name:"id",required:!0,type:{name:"string"}},parents:{defaultValue:null,description:"The parent nodes of the node.",name:"parents",required:!1,type:{name:"string[]"}},disabled:{defaultValue:null,description:"Whether the node is disabled.",name:"disabled",required:!1,type:{name:"boolean"}},animated:{defaultValue:null,description:"Whether the node is animated.",name:"animated",required:!1,type:{name:"boolean"}},draggable:{defaultValue:{value:"false"},description:"Whether the node is draggable.",name:"draggable",required:!1,type:{name:"boolean"}},labelFontUrl:{defaultValue:null,description:"The url for the label font.",name:"labelFontUrl",required:!1,type:{name:"string"}},renderNode:{defaultValue:null,description:"The function to use to render the node.",name:"renderNode",required:!1,type:{name:"NodeRenderer"}},contextMenu:{defaultValue:null,description:"The context menu for the node.",name:"contextMenu",required:!1,type:{name:"(event: ContextMenuEvent) => ReactNode"}},onPointerOver:{defaultValue:null,description:"The function to call when the pointer is over the node.",name:"onPointerOver",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onPointerOut:{defaultValue:null,description:"The function to call when the pointer is out of the node.",name:"onPointerOut",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onClick:{defaultValue:null,description:"The function to call when the node is clicked.",name:"onClick",required:!1,type:{name:"(node: InternalGraphNode, props?: CollapseProps) => void"}},onDoubleClick:{defaultValue:null,description:"The function to call when the node is double clicked.",name:"onDoubleClick",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onContextMenu:{defaultValue:null,description:"The function to call when the node is right clicked.",name:"onContextMenu",required:!1,type:{name:"(node?: InternalGraphNode, props?: NodeContextMenuProps) => void"}},onDragged:{defaultValue:null,description:"Triggered after a node was dragged.",name:"onDragged",required:!1,type:{name:"(node: InternalGraphNode) => void"}}}}}catch{}const Lo=({animated:t,color:e,length:n,opacity:r,position:i,rotation:a,size:o,onActive:s,onContextMenu:l})=>{const u=I.useMemo(()=>new Xt(e),[e]),c=I.useRef(null),f=he(g=>g.draggingId),[{pos:d,arrowOpacity:h}]=Ut(()=>({from:{pos:[0,0,0],arrowOpacity:0},to:{pos:[i.x,i.y,i.z],arrowOpacity:r},config:{...Lt,duration:t&&!f?void 0:0}}),[t,f,r,i]),p=I.useCallback(()=>{var m;const g=new Ee(0,1,0);(m=c.current)==null||m.quaternion.setFromUnitVectors(g,a)},[a,c]);return I.useEffect(()=>p(),[p]),re.jsxs(Je.mesh,{position:d,ref:c,scale:[1,1,1],onPointerOver:()=>s(!0),onPointerOut:()=>s(!1),onPointerDown:g=>{g.nativeEvent.buttons===2&&(g.stopPropagation(),l())},children:[re.jsx("cylinderGeometry",{args:[0,o,n,20,1,!0],attach:"geometry"}),re.jsx(Je.meshBasicMaterial,{attach:"material",color:u,depthTest:!1,opacity:h,transparent:!0,side:yt,fog:!0})]})};Lo.defaultProps={size:1,opacity:.5,color:"#D8E6EA"};try{Lo.displayName="Arrow",Lo.__docgenInfo={description:"",displayName:"Arrow",props:{animated:{defaultValue:null,description:"Whether the arrow should be animated.",name:"animated",required:!1,type:{name:"boolean"}},color:{defaultValue:{value:"#D8E6EA"},description:"The color of the arrow.",name:"color",required:!1,type:{name:"ColorRepresentation"}},length:{defaultValue:null,description:"The length of the arrow.",name:"length",required:!0,type:{name:"number"}},opacity:{defaultValue:{value:"0.5"},description:"The opacity of the arrow.",name:"opacity",required:!1,type:{name:"number"}},position:{defaultValue:null,description:"The position of the arrow in 3D space.",name:"position",required:!0,type:{name:"Vector3"}},rotation:{defaultValue:null,description:"The rotation of the arrow in 3D space.",name:"rotation",required:!0,type:{name:"Vector3"}},size:{defaultValue:{value:"1"},description:"The size of the arrow.",name:"size",required:!1,type:{name:"number"}},onContextMenu:{defaultValue:null,description:"A function that is called when the arrow is right-clicked.",name:"onContextMenu",required:!1,type:{name:"() => void"}},onActive:{defaultValue:null,description:"A function that is called when the arrow is selected or deselected.",name:"onActive",required:!1,type:{name:"(state: boolean) => void"}}}}}catch{}const Uo=({animated:t,color:e,curve:n,curved:r=!1,id:i,opacity:a,size:o,onContextMenu:s,onClick:l,onPointerOver:u,onPointerOut:c})=>{const f=I.useRef(null),d=he(g=>g.draggingId),h=I.useMemo(()=>new Xt(e),[e]),{lineOpacity:p}=Ut({from:{lineOpacity:0},to:{lineOpacity:a},config:{...Lt,duration:t?void 0:0}});return Ut(()=>{const g=n.getPoint(0),m=n.getPoint(1);return{from:{fromVertices:[0,0,0],toVertices:[0,0,0]},to:{fromVertices:[g==null?void 0:g.x,g==null?void 0:g.y,(g==null?void 0:g.z)||0],toVertices:[m==null?void 0:m.x,m==null?void 0:m.y,(m==null?void 0:m.z)||0]},onChange:v=>{const{fromVertices:_,toVertices:w}=v.value,y=new Ee(..._),b=new Ee(...w),S=Xi(y,0,b,0,r);f.current.copy(new hl(S,20,o/2,5,!1))},config:{...Lt,duration:t&&!d?void 0:0}}},[t,d,n,o]),re.jsxs("mesh",{userData:{id:i,type:"edge"},onPointerOver:u,onPointerOut:c,onClick:l,onPointerDown:g=>{g.nativeEvent.buttons===2&&(g.stopPropagation(),s())},children:[re.jsx("tubeGeometry",{attach:"geometry",ref:f}),re.jsx(Je.meshBasicMaterial,{attach:"material",opacity:p,fog:!0,transparent:!0,depthTest:!1,color:h})]})};Uo.defaultProps={color:"#000",size:1,opacity:1};try{Uo.displayName="Line",Uo.__docgenInfo={description:"",displayName:"Line",props:{animated:{defaultValue:null,description:"Whether the line should be animated.",name:"animated",required:!1,type:{name:"boolean"}},color:{defaultValue:{value:"#000"},description:"The color of the line.",name:"color",required:!1,type:{name:"ColorRepresentation"}},curved:{defaultValue:{value:"false"},description:"Whether the line should be curved.",name:"curved",required:!1,type:{name:"boolean"}},curve:{defaultValue:null,description:"The curve of the line in 3D space.",name:"curve",required:!0,type:{name:"Curve<Vector3>"}},id:{defaultValue:null,description:"The unique identifier of the line.",name:"id",required:!0,type:{name:"string"}},opacity:{defaultValue:{value:"1"},description:"The opacity of the line.",name:"opacity",required:!1,type:{name:"number"}},size:{defaultValue:{value:"1"},description:"The size of the line.",name:"size",required:!1,type:{name:"number"}},onClick:{defaultValue:null,description:"A function that is called when the line is clicked.",name:"onClick",required:!1,type:{name:"() => void"}},onContextMenu:{defaultValue:null,description:"A function that is called when the line is right-clicked.",name:"onContextMenu",required:!1,type:{name:"() => void"}},onPointerOver:{defaultValue:null,description:"A function that is called when the mouse pointer is moved over the line.",name:"onPointerOver",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}},onPointerOut:{defaultValue:null,description:"A function that is called when the mouse pointer is moved out of the line.",name:"onPointerOut",required:!1,type:{name:"(event: ThreeEvent<PointerEvent>) => void"}}}}}catch{}const Vo=6,Fo=({animated:t,arrowPlacement:e,contextMenu:n,disabled:r,labelPlacement:i,id:a,interpolation:o,labelFontUrl:s,onContextMenu:l,onClick:u,onPointerOver:c,onPointerOut:f})=>{const d=he(j=>j.theme),h=he(j=>j.edges.find(k=>k.id===a)),{target:p,source:g,label:m,labelVisible:v=!1,size:_=1}=h,w=o==="curved",y=he(j=>j.nodes.find(k=>k.id===g)),b=he(j=>j.nodes.find(k=>k.id===p)),S=he(j=>j.draggingId),[E,x]=I.useState(!1),[A,V]=I.useState(!1),F=(_+Vo)/2,[P,N]=I.useMemo(()=>Vh(_),[_]),[W,H,L]=I.useMemo(()=>{const j=Zi(y),k=y.size,z=Zi(b),J=b.size;let Q=Xi(j,k,z,J,w);const[X,Y]=Uh(e,Q,P);return e==="end"&&(Q=Xi(j,k,X,0,w)),[Q,X,Y]},[w,y,b,e,P]),G=I.useMemo(()=>Fh(y.position,b.position,Ch(F,i)),[y.position,b.position,F,i]),B=he(j=>{var k;return(k=j.selections)==null?void 0:k.includes(a)}),q=he(j=>{var k;return(k=j.selections)==null?void 0:k.length}),$=he(j=>{var k;return(k=j.actives)==null?void 0:k.includes(a)}),R=q?B||$?d.edge.selectedOpacity:d.edge.inactiveOpacity:d.edge.opacity,[{labelPosition:O}]=Ut(()=>({from:{labelPosition:[0,0,0]},to:{labelPosition:[G.x,G.y,G.z]},config:{...Lt,duration:t&&!S?void 0:0}}),[G,t,S]),D=I.useMemo(()=>new Nd(0,0,i==="natural"?0:Math.atan((b.position.y-y.position.y)/(b.position.x-y.position.x))),[b.position.x,b.position.y,y.position.x,y.position.y,i]);Vi(E&&!S&&u!==void 0,"pointer");const{pointerOver:T,pointerOut:C}=du({disabled:r,onPointerOver:()=>{x(!0),c==null||c(h)},onPointerOut:()=>{x(!1),f==null||f(h)}});return re.jsxs("group",{children:[re.jsx(Uo,{animated:t,color:B||E||$?d.edge.activeFill:d.edge.fill,curve:W,curved:w,id:a,opacity:R,size:_,onClick:()=>{r||u==null||u(h)},onPointerOver:T,onPointerOut:C,onContextMenu:()=>{r||(V(!0),l==null||l(h))}}),e!=="none"&&re.jsx(Lo,{animated:t,color:B||E||$?d.arrow.activeFill:d.arrow.fill,length:P,opacity:R,position:H,rotation:L,size:N,onActive:x,onContextMenu:()=>{r||(V(!0),l==null||l(h))}}),v&&m&&re.jsx(Je.group,{position:O,rotation:D,children:re.jsx(Yn,{text:m,ellipsis:15,fontUrl:s,stroke:d.edge.label.stroke,color:B||E||$?d.edge.label.activeColor:d.edge.label.color,opacity:R,fontSize:Vo})}),A&&n&&re.jsx(Pu,{prepend:!0,center:!0,children:n({data:h,onClose:()=>V(!1)})})]})};Fo.defaultProps={labelPlacement:"inline",arrowPlacement:"end"};try{Fo.displayName="Edge",Fo.__docgenInfo={description:"",displayName:"Edge",props:{labelFontUrl:{defaultValue:null,description:"The url for the label font.",name:"labelFontUrl",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"The unique identifier of the edge.",name:"id",required:!0,type:{name:"string"}},animated:{defaultValue:null,description:"Whether the edge should be animated.",name:"animated",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"Whether the edge should be disabled.",name:"disabled",required:!1,type:{name:"boolean"}},labelPlacement:{defaultValue:{value:"inline"},description:"The placement of the edge label.",name:"labelPlacement",required:!1,type:{name:"enum",value:[{value:'"below"'},{value:'"above"'},{value:'"inline"'},{value:'"natural"'}]}},arrowPlacement:{defaultValue:{value:"end"},description:"The placement of the edge arrow.",name:"arrowPlacement",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"mid"'},{value:'"end"'}]}},interpolation:{defaultValue:null,description:"The type of interpolation used to draw the edge.",name:"interpolation",required:!0,type:{name:"enum",value:[{value:'"linear"'},{value:'"curved"'}]}},contextMenu:{defaultValue:null,description:"A function that returns the context menu for the edge.",name:"contextMenu",required:!1,type:{name:"(event: Partial<ContextMenuEvent>) => ReactNode"}},onClick:{defaultValue:null,description:"A function that is called when the edge is clicked.",name:"onClick",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onContextMenu:{defaultValue:null,description:"A function that is called when the edge is right-clicked.",name:"onContextMenu",required:!1,type:{name:"(edge?: InternalGraphEdge) => void"}},onPointerOver:{defaultValue:null,description:"A function that is called when the mouse pointer is moved over the edge.",name:"onPointerOver",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onPointerOut:{defaultValue:null,description:"A function that is called when the mouse pointer is moved out of the edge.",name:"onPointerOut",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}}}}}catch{}const Od=new bg(0,0,0);function W2(t,e){const n=I.useRef();he(s=>{n.current=s});const r=I.useRef(new Map),i=e==="curved",a=I.useCallback(s=>{const l=[],u=r.current,{nodes:c}=n.current;return s.forEach(f=>{const{target:d,source:h,size:p=1}=f,g=c.find(H=>H.id===h),m=c.find(H=>H.id===d);if(!g||!m)return;const v=`fromX:${g.position.x},fromY:${g.position.y},toX:${m.position.x}},toY:${m.position.y}`;if(u.has(v)){const H=u.get(v);l.push(H);return}const _=Zi(g),w=g.size+Vo,y=Zi(m),b=m.size+Vo;let S=Xi(_,w,y,b,i),E=new hl(S,20,p/2,5,!1);if(t==="none"){l.push(E),u.set(v,E);return}const[x,A]=Vh(p),[V,F]=Uh(t,S,x),P=new Gd;P.setFromUnitVectors(new Ee(0,1,0),F);const N=new _g(0,A,x,20,1,!0);if(N.applyQuaternion(P),N.translate(V.x,V.y,V.z),t&&t==="end"){const H=Xi(_,w,V,0,i);E=new hl(H,20,p/2,5,!1)}const W=qa([E,N]);l.push(W),u.set(v,W)}),l},[t,i]),o=I.useCallback((s,l)=>{const u=a(s),c=a(l);return qa([c.length?qa(c):Od,u.length?qa(u):Od],!0)},[a]);return{getGeometries:a,getGeometry:o}}function $2(t,e,n){const{onClick:r,onContextMenu:i,onPointerOut:a,onPointerOver:o}=t,s=he(p=>p.edgeContextMenus),l=he(p=>p.setEdgeContextMenus),u=I.useRef(!1),c=I.useCallback(()=>{u.current=!0},[]),f=I.useRef(!1),d=I.useCallback(()=>{f.current=!0},[]),h=I.useCallback((p,g)=>{r&&u.current&&(u.current=!1,n||g.forEach(m=>{r(m)})),(e||i)&&f.current&&(f.current=!1,n||g.forEach(m=>{s.has(m.id)||(l(new Set([...s,m.id])),i==null||i(m))})),o&&g.filter(v=>!p.includes(v)).forEach(v=>{o(v)}),a&&p.filter(v=>!g.includes(v)).forEach(v=>{a(v)})},[e,n,s,l,r,i,o,a]);return{handleClick:c,handleContextMenu:d,handleIntersections:h}}function H2(t,e){const n=I.useRef(t);I.useEffect(()=>{n.current=t},[t]);const r=I.useCallback(()=>{const a=n.current.getAttribute("position"),o=Array.from({length:a.array.length}).fill(0),s=Array.from(a.array);return{from:o,to:s}},[]),i=I.useCallback(a=>{const o=new Float32Array(a),s=new Ud(o,3,!1);n.current.setAttribute("position",s),s.needsUpdate=!0},[]);Ut(()=>{if(!e)return null;const a=r();return{from:{positions:a.from},to:{positions:a.to},onChange:o=>{i(o.value.positions)},config:{...Lt,duration:e?void 0:0}}},[e])}function Y2(t,e,n){const[{activeOpacity:r,inactiveOpacity:i}]=Ut(()=>({from:{activeOpacity:0,inactiveOpacity:0},to:{activeOpacity:e?n.edge.selectedOpacity:n.edge.opacity,inactiveOpacity:e?n.edge.inactiveOpacity:n.edge.opacity},config:{...Lt,duration:t?void 0:0}}),[t,e,n]);return{activeOpacity:r,inactiveOpacity:i}}const Dd=6,Go=({animated:t,color:e,contextMenu:n,edge:r,labelFontUrl:i,labelPlacement:a,opacity:o,theme:s})=>{const{target:l,source:u,label:c,labelVisible:f=!1,size:d=1}=r,h=he(x=>x.nodes),p=h.find(x=>x.id===u),g=h.find(x=>x.id===l),m=he(x=>x.draggingId),v=(d+Dd)/2,_=I.useMemo(()=>Fh(p.position,g.position,Ch(v,a)),[p.position,g.position,v,a]),w=he(x=>x.edgeContextMenus),y=he(x=>x.setEdgeContextMenus),[{labelPosition:b}]=Ut(()=>({from:{labelPosition:[0,0,0]},to:{labelPosition:[_.x,_.y,_.z]},config:{...Lt,duration:t&&!m?void 0:0}}),[_,t,m]),S=I.useCallback(x=>{w.delete(x.id),y(new Set(w.values()))},[w,y]),E=I.useMemo(()=>new Nd(0,0,a==="natural"?0:Math.atan((g.position.y-p.position.y)/(g.position.x-p.position.x))),[g.position.x,g.position.y,p.position.x,p.position.y,a]);return re.jsxs("group",{children:[f&&c&&re.jsx(Je.group,{position:b,rotation:E,children:re.jsx(Yn,{text:c,ellipsis:15,fontUrl:i,stroke:s.edge.label.stroke,color:e,opacity:o,fontSize:Dd})}),n&&w.has(r.id)&&re.jsx(Pu,{prepend:!0,center:!0,position:_,children:n({data:r,onClose:()=>S(r)})})]})};Go.defaultProps={labelPlacement:"inline"};try{Go.displayName="Edge",Go.__docgenInfo={description:"",displayName:"Edge",props:{animated:{defaultValue:null,description:"",name:"animated",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},color:{defaultValue:null,description:"",name:"color",required:!0,type:{name:"ColorRepresentation"}},contextMenu:{defaultValue:null,description:"",name:"contextMenu",required:!1,type:{name:"(event: Partial<ContextMenuEvent>) => ReactNode"}},edge:{defaultValue:null,description:"",name:"edge",required:!0,type:{name:"InternalGraphEdge"}},labelFontUrl:{defaultValue:null,description:"",name:"labelFontUrl",required:!1,type:{name:"string"}},labelPlacement:{defaultValue:{value:"inline"},description:"",name:"labelPlacement",required:!1,type:{name:"enum",value:[{value:'"below"'},{value:'"above"'},{value:'"inline"'},{value:'"natural"'}]}},opacity:{defaultValue:null,description:"",name:"opacity",required:!1,type:{name:"number"}},theme:{defaultValue:null,description:"",name:"theme",required:!0,type:{name:"Theme"}}}}}catch{}const ql=({animated:t,arrowPlacement:e="end",contextMenu:n,disabled:r,edges:i,interpolation:a="linear",labelFontUrl:o,labelPlacement:s="inline",theme:l,onClick:u,onContextMenu:c,onPointerOut:f,onPointerOver:d})=>{const{getGeometries:h,getGeometry:p}=W2(e,a),g=he($=>$.draggingId),m=he($=>$.edgeMeshes),v=he($=>$.setEdgeMeshes),_=he($=>$.actives||[]),w=he($=>$.selections||[]),[y,b,S,E]=I.useMemo(()=>{const $=[],R=[],O=[],D=[];return i.forEach(T=>{if(g===T.source||g===T.target){w.includes(T.id)||_.includes(T.id)?O.push(T):D.push(T);return}w.includes(T.id)||_.includes(T.id)?$.push(T):R.push(T)}),[$,R,O,D]},[i,_,w,g]),x=!!w.length,A=I.useMemo(()=>p(y,b),[p,y,b]),{activeOpacity:V,inactiveOpacity:F}=Y2(t,x,l);H2(A,t),I.useEffect(()=>{if(g===null){const R=h(i).map(O=>new Cr(O));v(R)}},[h,v,i,g]);const P=I.useRef(new Cr),N=I.useRef(new Cr),W=I.useCallback($=>{if(!$.camera)return[];const R=$.intersectObjects(m);return R.length?R.map(O=>i[m.indexOf(O.object)]):[]},[m,i]),{handleClick:H,handleContextMenu:L,handleIntersections:G}=$2({onClick:u,onContextMenu:c,onPointerOut:f,onPointerOver:d},n,r),B=I.useRef(null),q=I.useRef([]);return zo($=>{if(P.current.geometry=A,r)return;const R=B.current;if((g||g===null&&R!==null)&&(N.current.geometry=p(S,E)),B.current=g,g)return;const O=q.current,D=W($.raycaster);G(O,D),D.join()!==O.join()&&(N.current.geometry=p(D,[])),q.current=D}),re.jsxs("group",{onClick:H,onContextMenu:L,children:[re.jsxs("mesh",{ref:P,children:[re.jsx(Je.meshBasicMaterial,{attach:"material-0",color:l.edge.fill,depthTest:!1,fog:!0,opacity:F,side:yt,transparent:!0}),re.jsx(Je.meshBasicMaterial,{attach:"material-1",color:l.edge.activeFill,depthTest:!1,fog:!0,opacity:V,side:yt,transparent:!0})]}),re.jsxs("mesh",{ref:N,children:[re.jsx(Je.meshBasicMaterial,{attach:"material-0",color:l.edge.fill,depthTest:!1,fog:!0,opacity:F,side:yt,transparent:!0}),re.jsx(Je.meshBasicMaterial,{attach:"material-1",color:l.edge.activeFill,depthTest:!1,fog:!0,opacity:V,side:yt,transparent:!0})]}),i.map($=>re.jsx(Go,{animated:t,contextMenu:n,color:l.edge.label.color,disabled:r,edge:$,labelFontUrl:o,labelPlacement:s,theme:l},$.id))]})};try{ql.displayName="Edges",ql.__docgenInfo={description:`Three.js rendering starts to get slower if you have an individual mesh for each edge
and a high number of edges.

Instead, we take the edges and split them into their different render states:

 * - Active (any edges that are marked as "selected" or "active" in the state)
 * - Dragging (any edges that are connected to a node that is being dragged)
 * - Intersecting (any edges that are currently intersected by the ray from the mouse position)
 * - Inactive (any edges that aren't active, dragging, or intersected)

We generate the geometry for each edge in each of these groups, and then merge them
into a single geometry for each group. This merged mesh is rendered as one object
which gives much better performance. This means that we only need to update geometry
and positions when edges move between the different states, rather than updating all
edges whenever any other edge changes.

To get this all working, we have to do a few things outside the @react-three/fiber world,
specifically:

 * manually create edge/arrow geometries (see \`useEdgeGeometry\`)
 * manually track mouse/edge interactions and fire events (see \`useEdgeEvents\`)
 * manually update edge/arrow positions during aniamations (see \`useEdgeAnimations\`)`,displayName:"Edges",props:{animated:{defaultValue:null,description:"",name:"animated",required:!1,type:{name:"boolean"}},arrowPlacement:{defaultValue:{value:"end"},description:"",name:"arrowPlacement",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"mid"'},{value:'"end"'}]}},contextMenu:{defaultValue:null,description:"",name:"contextMenu",required:!1,type:{name:"(event: Partial<ContextMenuEvent>) => ReactNode"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},edges:{defaultValue:null,description:"",name:"edges",required:!0,type:{name:"InternalGraphEdge[]"}},labelFontUrl:{defaultValue:null,description:"",name:"labelFontUrl",required:!1,type:{name:"string"}},labelPlacement:{defaultValue:{value:"inline"},description:"",name:"labelPlacement",required:!1,type:{name:"enum",value:[{value:'"below"'},{value:'"above"'},{value:'"inline"'},{value:'"natural"'}]}},interpolation:{defaultValue:{value:"linear"},description:"",name:"interpolation",required:!1,type:{name:"enum",value:[{value:'"linear"'},{value:'"curved"'}]}},theme:{defaultValue:null,description:"",name:"theme",required:!0,type:{name:"Theme"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onContextMenu:{defaultValue:null,description:"",name:"onContextMenu",required:!1,type:{name:"(edge?: InternalGraphEdge) => void"}},onPointerOver:{defaultValue:null,description:"",name:"onPointerOver",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onPointerOut:{defaultValue:null,description:"",name:"onPointerOut",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}}}}}catch{}const No=({animated:t,position:e,padding:n,labelFontUrl:r,disabled:i,radius:a,nodes:o,label:s,onClick:l,onPointerOver:u,onPointerOut:c})=>{var F,P,N,W;const f=he(H=>H.theme),d=Math.max(e.width,e.height)/2,h=d-a+n,[p,g]=I.useState(!1),m=he(H=>{var L;return(L=H.actives)==null?void 0:L.some(G=>o.some(B=>B.id===G))}),v=he(H=>{var L;return(L=H.selections)==null?void 0:L.some(G=>o.some(B=>B.id===G))}),w=he(H=>{var L;return((L=H.selections)==null?void 0:L.length)>0})?v||p||m?f.cluster.selectedOpacity:f.cluster.inactiveOpacity:f.cluster.opacity,{circleOpacity:y,circlePosition:b,labelPosition:S}=Ut({from:{circlePosition:[0,0,-1],circleOpacity:0,labelPosition:[0,0,2]},to:{labelPosition:[0,-h,2],circlePosition:e?[e.x,e.y,-1]:[0,0,-1],circleOpacity:w},config:{...Lt,duration:t?void 0:0}}),E=I.useMemo(()=>{var H;return new Xt((H=f.cluster)==null?void 0:H.stroke)},[(F=f.cluster)==null?void 0:F.stroke]),x=I.useMemo(()=>{var H;return new Xt((H=f.cluster)==null?void 0:H.fill)},[(P=f.cluster)==null?void 0:P.fill]);Vi(p&&l!==void 0,"pointer");const{pointerOver:A,pointerOut:V}=du({disabled:i,onPointerOver:()=>{g(!0),u==null||u({nodes:o,label:s})},onPointerOut:()=>{g(!1),c==null||c({nodes:o,label:s})}});return re.jsx(re.Fragment,{children:f.cluster&&re.jsxs(Je.group,{position:b,onPointerOver:A,onPointerOut:V,onClick:()=>{i||l==null||l({nodes:o,label:s})},children:[re.jsxs("mesh",{children:[re.jsx("ringGeometry",{attach:"geometry",args:[h,0,128]}),re.jsx(Je.meshBasicMaterial,{attach:"material",color:x,transparent:!0,depthTest:!1,opacity:(N=f.cluster)!=null&&N.fill?y:0,side:yt,fog:!0})]}),re.jsxs("mesh",{children:[re.jsx("ringGeometry",{attach:"geometry",args:[h,d+n,128]}),re.jsx(Je.meshBasicMaterial,{attach:"material",color:E,transparent:!0,depthTest:!1,opacity:y,side:yt,fog:!0})]}),((W=f.cluster)==null?void 0:W.label)&&re.jsx(Je.group,{position:S,children:re.jsx(Yn,{text:s,opacity:w,fontUrl:r,stroke:f.cluster.label.stroke,active:!1,color:f.cluster.label.color,fontSize:12})})]})})};No.defaultProps={opacity:1,radius:2,padding:40};try{No.displayName="Cluster",No.__docgenInfo={description:"",displayName:"Cluster",props:{animated:{defaultValue:null,description:"Whether the circle should be animated.",name:"animated",required:!1,type:{name:"boolean"}},radius:{defaultValue:{value:"2"},description:"The radius of the circle. Default 1.",name:"radius",required:!1,type:{name:"number"}},padding:{defaultValue:{value:"40"},description:"The padding of the circle. Default 20.",name:"padding",required:!1,type:{name:"number"}},labelFontUrl:{defaultValue:null,description:"The url for the label font.",name:"labelFontUrl",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Whether the node is disabled.",name:"disabled",required:!1,type:{name:"boolean"}},onClick:{defaultValue:null,description:"When the cluster was clicked.",name:"onClick",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},onPointerOver:{defaultValue:null,description:"When a cluster recieves a pointer over event.",name:"onPointerOver",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},onPointerOut:{defaultValue:null,description:"When cluster recieves a pointer leave event.",name:"onPointerOut",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},nodes:{defaultValue:null,description:"",name:"nodes",required:!0,type:{name:"InternalGraphNode[]"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"CenterPositionVector"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}}}}}catch{}const jo=I.forwardRef(({onNodeClick:t,onNodeDoubleClick:e,onNodeContextMenu:n,onEdgeContextMenu:r,onEdgeClick:i,onEdgePointerOver:a,onEdgePointerOut:o,onNodePointerOver:s,onNodePointerOut:l,onClusterClick:u,onNodeDragged:c,onClusterPointerOver:f,onClusterPointerOut:d,contextMenu:h,theme:p,animated:g,disabled:m,draggable:v,edgeLabelPosition:_,edgeArrowPosition:w,edgeInterpolation:y,labelFontUrl:b,renderNode:S,...E},x)=>{const{mounted:A}=fE(E),V=he(G=>G.graph),F=he(G=>G.nodes),P=he(G=>G.edges),N=he(G=>[...G.clusters.values()]),W=I.useMemo(()=>F.map(G=>G.id),[F]),H=I.useMemo(()=>P.map(G=>G.id),[P]),{centerNodesById:L}=B2({animated:g});return I.useImperativeHandle(x,()=>({centerGraph:L,graph:V}),[L,V]),re.jsx(I.Fragment,{children:A&&re.jsxs(I.Fragment,{children:[W.map(G=>re.jsx(Io,{id:G,labelFontUrl:b,draggable:v,disabled:m,animated:g,contextMenu:h,renderNode:S,onClick:t,onDoubleClick:e,onContextMenu:n,onPointerOver:s,onPointerOut:l,onDragged:c},G)),g?H.map(G=>re.jsx(Fo,{id:G,disabled:m,animated:g,labelFontUrl:b,labelPlacement:_,arrowPlacement:w,interpolation:y,contextMenu:h,onClick:i,onContextMenu:r,onPointerOver:a,onPointerOut:o},G)):re.jsx(ql,{theme:p,edges:P,disabled:m,animated:g,labelFontUrl:b,labelPlacement:_,arrowPlacement:w,interpolation:y,contextMenu:h,onClick:i,onContextMenu:r,onPointerOver:a,onPointerOut:o}),N.map(G=>re.jsx(No,{animated:g,disabled:m,labelFontUrl:b,onClick:u,onPointerOver:f,onPointerOut:d,...G},G.label))]})})});jo.defaultProps={edgeInterpolation:"linear"};try{jo.displayName="GraphScene",jo.__docgenInfo={description:"",displayName:"GraphScene",props:{theme:{defaultValue:null,description:"Theme to use for the graph.",name:"theme",required:!0,type:{name:"Theme"}},layoutType:{defaultValue:null,description:"Type of layout.",name:"layoutType",required:!1,type:{name:"enum",value:[{value:'"forceDirected2d"'},{value:'"forceDirected3d"'},{value:'"circular2d"'},{value:'"treeTd2d"'},{value:'"treeTd3d"'},{value:'"treeLr2d"'},{value:'"treeLr3d"'},{value:'"radialOut2d"'},{value:'"radialOut3d"'},{value:'"hierarchicalTd"'},{value:'"hierarchicalLr"'},{value:'"nooverlap"'},{value:'"forceatlas2"'},{value:'"custom"'}]}},selections:{defaultValue:null,description:"List of ids that are selected.",name:"selections",required:!1,type:{name:"string[]"}},actives:{defaultValue:null,description:"List of ids that are active.",name:"actives",required:!1,type:{name:"string[]"}},collapsedNodeIds:{defaultValue:null,description:"List of node ids that are collapsed.",name:"collapsedNodeIds",required:!1,type:{name:"string[]"}},animated:{defaultValue:null,description:"Animate or not the graph positions.",name:"animated",required:!1,type:{name:"boolean"}},nodes:{defaultValue:null,description:"Nodes to pass to the graph.",name:"nodes",required:!0,type:{name:"GraphNode[]"}},edges:{defaultValue:null,description:"Edges to pass to the graph.",name:"edges",required:!0,type:{name:"GraphEdge[]"}},contextMenu:{defaultValue:null,description:"Context menu element.",name:"contextMenu",required:!1,type:{name:"(event: ContextMenuEvent) => ReactNode"}},sizingType:{defaultValue:null,description:"Type of sizing for nodes.",name:"sizingType",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"pagerank"'},{value:'"centrality"'},{value:'"attribute"'},{value:'"default"'}]}},labelType:{defaultValue:null,description:"Type of visibility for labels.",name:"labelType",required:!1,type:{name:"enum",value:[{value:'"nodes"'},{value:'"edges"'},{value:'"none"'},{value:'"all"'},{value:'"auto"'}]}},edgeLabelPosition:{defaultValue:null,description:"Place of visibility for edge labels.",name:"edgeLabelPosition",required:!1,type:{name:"enum",value:[{value:'"below"'},{value:'"above"'},{value:'"inline"'},{value:'"natural"'}]}},edgeArrowPosition:{defaultValue:null,description:"Placement of edge arrows.",name:"edgeArrowPosition",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"mid"'},{value:'"end"'}]}},edgeInterpolation:{defaultValue:{value:"linear"},description:"Shape of edge.",name:"edgeInterpolation",required:!1,type:{name:"enum",value:[{value:'"linear"'},{value:'"curved"'}]}},labelFontUrl:{defaultValue:null,description:`Font of label, same as troika-three-text
The URL of a custom font file to be used. Supported font formats are: * .ttf * .otf * .woff (.woff2 is not supported)
Default: The Roboto font loaded from Google Fonts CDN`,name:"labelFontUrl",required:!1,type:{name:"string"}},sizingAttribute:{defaultValue:null,description:"Attribute based sizing property.",name:"sizingAttribute",required:!1,type:{name:"string"}},defaultNodeSize:{defaultValue:null,description:"The default size to size nodes to. Default is 7.",name:"defaultNodeSize",required:!1,type:{name:"number"}},minNodeSize:{defaultValue:null,description:"When using sizing attributes, the min size a node can be.",name:"minNodeSize",required:!1,type:{name:"number"}},maxNodeSize:{defaultValue:null,description:"When using sizing attributes, the max size a node can be.",name:"maxNodeSize",required:!1,type:{name:"number"}},clusterAttribute:{defaultValue:null,description:"Attribute used for clustering.",name:"clusterAttribute",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Disable interactions or not.",name:"disabled",required:!1,type:{name:"boolean"}},draggable:{defaultValue:null,description:"Allow dragging of nodes.",name:"draggable",required:!1,type:{name:"boolean"}},renderNode:{defaultValue:null,description:"Render a custom node",name:"renderNode",required:!1,type:{name:"NodeRenderer"}},layoutOverrides:{defaultValue:null,description:"Advanced overrides for the layout.",name:"layoutOverrides",required:!1,type:{name:"LayoutOverrides"}},onNodeClick:{defaultValue:null,description:"When a node was clicked.",name:"onNodeClick",required:!1,type:{name:"(node: InternalGraphNode, props?: CollapseProps) => void"}},onNodeDoubleClick:{defaultValue:null,description:"When a node was double clicked.",name:"onNodeDoubleClick",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onNodeContextMenu:{defaultValue:null,description:"When a node context menu happened.",name:"onNodeContextMenu",required:!1,type:{name:"(node: InternalGraphNode, props?: NodeContextMenuProps) => void"}},onNodePointerOver:{defaultValue:null,description:"When node got a pointer over.",name:"onNodePointerOver",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onNodePointerOut:{defaultValue:null,description:"When node lost pointer over.",name:"onNodePointerOut",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onNodeDragged:{defaultValue:null,description:"Triggered after a node was dragged.",name:"onNodeDragged",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onEdgeContextMenu:{defaultValue:null,description:"When a edge context menu happened.",name:"onEdgeContextMenu",required:!1,type:{name:"(edge?: InternalGraphEdge) => void"}},onEdgeClick:{defaultValue:null,description:"When an edge was clicked.",name:"onEdgeClick",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onEdgePointerOver:{defaultValue:null,description:"When edge got a pointer over.",name:"onEdgePointerOver",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onEdgePointerOut:{defaultValue:null,description:"When edge lost pointer over.",name:"onEdgePointerOut",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onClusterClick:{defaultValue:null,description:"When a cluster was clicked.",name:"onClusterClick",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},onClusterPointerOver:{defaultValue:null,description:"When a cluster recieves a pointer over event.",name:"onClusterPointerOver",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},onClusterPointerOut:{defaultValue:null,description:"When cluster recieves a pointer leave event.",name:"onClusterPointerOut",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<GraphSceneRef>"}}}}}catch{}const K2={canvas:{background:"#fff"},node:{fill:"#7CA0AB",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.2,label:{color:"#2A6475",stroke:"#fff",activeColor:"#1DE9AC"},subLabel:{color:"#ddd",stroke:"transparent",activeColor:"#1DE9AC"}},lasso:{border:"1px solid #55aaff",background:"rgba(75, 160, 255, 0.1)"},ring:{fill:"#D8E6EA",activeFill:"#1DE9AC"},edge:{fill:"#D8E6EA",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#fff",color:"#2A6475",activeColor:"#1DE9AC"}},arrow:{fill:"#D8E6EA",activeFill:"#1DE9AC"},cluster:{stroke:"#D8E6EA",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#fff",color:"#2A6475"}}};function bT(t,e,n){e=Array.isArray(e)?e:[e];const r=[],i=[];for(const a of e){const o=[...t.inEdgeEntries(a)??[],...t.outEdgeEntries(a)??[]];if(o)for(const s of o){const l=s.attributes.id;if(n==="in"?s.target===a&&!i.includes(l)&&i.push(l):n==="out"?s.source===a&&!i.includes(l)&&i.push(l):i.includes(l)||i.push(l),n==="out"||n==="all"){const u=s.target;r.includes(u)||r.push(u)}(n==="in"||n==="all")&&(r.includes(s.source)||r.push(s.source))}}return{nodes:r,edges:i}}function Za(t,e,n){const{offsetX:r,offsetY:i}=t,{width:a,height:o}=n;e.set(r/a*2-1,-(i/o)*2+1)}function X2(t){const e=document.createElement("div");return e.style.pointerEvents="none",e.style.border=t.lasso.border,e.style.backgroundColor=t.lasso.background,e.style.position="fixed",e}const Bl=({children:t,theme:e,type:n="none",onLasso:r,onLassoEnd:i,disabled:a})=>{var P;const o=xt(N=>N.camera),s=xt(N=>N.gl),l=xt(N=>N.setEvents),u=xt(N=>N.size),c=xt(N=>N.get),f=xt(N=>N.scene),d=Xu(),h=he(N=>N.actives),p=he(N=>N.setActives),g=he(N=>N.edges),m=he(N=>N.edgeMeshes),v=I.useRef(!1),_=I.useRef(null),w=I.useRef(null),y=I.useRef(X2(e)),b=I.useRef(null),S=I.useRef(!1),E=I.useRef(c().events.enabled),x=I.useRef((P=d.controls)==null?void 0:P.enabled);I.useEffect(()=>{v.current&&(r==null||r(h)),v.current=!0},[h,r]);const A=I.useCallback(N=>{if(S.current){const[W,H,L]=b.current;L.x=Math.max(W.x,N.clientX),L.y=Math.max(W.y,N.clientY),H.x=Math.min(W.x,N.clientX),H.y=Math.min(W.y,N.clientY),y.current.style.left=`${H.x}px`,y.current.style.top=`${H.y}px`,y.current.style.width=`${L.x-H.x}px`,y.current.style.height=`${L.y-H.y}px`,Za(N,_.current.endPoint,u),Za(N,w.current.endPoint,u);const G=[],B=w.current.select().sort($=>$.uuid).map($=>g[m.indexOf($)].id);G.push(...B);const q=_.current.select().sort($=>$.uuid).filter($=>{var R,O;return $.isMesh&&((R=$.userData)==null?void 0:R.id)&&(((O=$.userData)==null?void 0:O.type)===n||n==="all")}).map($=>$.userData.id);G.push(...q),requestAnimationFrame(()=>{p(G)}),document.addEventListener("pointermove",A,{passive:!0,capture:!0,once:!0})}},[g,m,p,u,n]),V=I.useCallback(()=>{var N;S.current&&(l({enabled:E.current}),S.current=!1,(N=y.current.parentElement)==null||N.removeChild(y.current),d.controls.enabled=x.current,i==null||i(h),document.removeEventListener("pointermove",A),document.removeEventListener("pointerup",V))},[l,d.controls,i,h,A]),F=I.useCallback(N=>{var W,H;if(N.shiftKey){E.current=c().events.enabled,x.current=(W=d.controls)==null?void 0:W.enabled,_.current=new Jf(o,f);const L=new wg;m.length&&L.add(...m),w.current=new Jf(o,L),b.current=[new De,new De,new De];const[G]=b.current;d.controls.enabled=!1,l({enabled:!1}),S.current=!0,(H=s.domElement.parentElement)==null||H.appendChild(y.current),y.current.style.left=`${N.clientX}px`,y.current.style.top=`${N.clientY}px`,y.current.style.width="0px",y.current.style.height="0px",G.x=N.clientX,G.y=N.clientY,Za(N,_.current.startPoint,u),Za(N,w.current.startPoint,u),document.addEventListener("pointermove",A,{passive:!0,capture:!0,once:!0}),document.addEventListener("pointerup",V,{passive:!0})}},[o,d.controls,m,c,s.domElement.parentElement,A,V,f,l,u]);return I.useEffect(()=>{if(!(a||n==="none"))return document.addEventListener("pointerdown",F,{passive:!0}),document.addEventListener("pointermove",A,{passive:!0}),document.addEventListener("pointerup",V,{passive:!0}),()=>{document.removeEventListener("pointerdown",F),document.removeEventListener("pointermove",A),document.removeEventListener("pointerup",V)}},[n,a,F,A,V]),re.jsx("group",{children:t})};try{Bl.displayName="Lasso",Bl.__docgenInfo={description:"",displayName:"Lasso",props:{theme:{defaultValue:null,description:"",name:"theme",required:!0,type:{name:"Theme"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},type:{defaultValue:{value:"none"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"all"'},{value:'"node"'},{value:'"edge"'}]}},onLasso:{defaultValue:null,description:"",name:"onLasso",required:!1,type:{name:"(selections: string[]) => void"}},onLassoEnd:{defaultValue:null,description:"",name:"onLassoEnd",required:!1,type:{name:"(selections: string[]) => void"}}}}}catch{}const Z2="_canvas_670zp_1",Q2={canvas:Z2},J2={alpha:!0,antialias:!0},eT={position:[0,0,1e3],near:5,far:5e4,fov:10},Wl=I.forwardRef(({cameraMode:t,edges:e,children:n,nodes:r,theme:i,onCanvasClick:a,animated:o,disabled:s,lassoType:l,onLasso:u,onLassoEnd:c,glOptions:f,...d},h)=>{const p=I.useRef(null),g=I.useRef(null);I.useImperativeHandle(h,()=>({centerGraph:b=>{var S;return(S=p.current)==null?void 0:S.centerGraph(b)},zoomIn:()=>{var b;return(b=g.current)==null?void 0:b.zoomIn()},zoomOut:()=>{var b;return(b=g.current)==null?void 0:b.zoomOut()},panLeft:()=>{var b;return(b=g.current)==null?void 0:b.panLeft()},panRight:()=>{var b;return(b=g.current)==null?void 0:b.panRight()},panDown:()=>{var b;return(b=g.current)==null?void 0:b.panDown()},panUp:()=>{var b;return(b=g.current)==null?void 0:b.panUp()},resetControls:b=>{var S;return(S=g.current)==null?void 0:S.resetControls(b)},getControls:()=>{var b;return(b=g.current)==null?void 0:b.controls},getGraph:()=>{var b;return(b=p.current)==null?void 0:b.graph}}));const{selections:m,actives:v,collapsedNodeIds:_}=d,w=e.length+r.length>400?!1:o,y=I.useMemo(()=>({...f,...J2}),[f]);return re.jsx("div",{className:Q2.canvas,children:re.jsx(Ng,{legacy:!0,linear:!0,flat:!0,gl:y,camera:eT,onPointerMissed:a,children:re.jsxs(sE,{createStore:()=>lE({selections:m,actives:v,theme:i,collapsedNodeIds:_}),children:[re.jsx("color",{attach:"background",args:[i.canvas.background]}),re.jsx("ambientLight",{intensity:1}),n,i.canvas.fog&&re.jsx("fog",{attach:"fog",args:[i.canvas.fog,4e3,9e3]}),re.jsx(Mo,{mode:t,ref:g,animated:o,disabled:s,children:re.jsx(Bl,{theme:i,disabled:s,type:l,onLasso:u,onLassoEnd:c,children:re.jsx(I.Suspense,{children:re.jsx(jo,{ref:p,theme:i,disabled:s,animated:w,edges:e,nodes:r,...d})})})})]})})})});Wl.defaultProps={cameraMode:"pan",layoutType:"forceDirected2d",sizingType:"default",labelType:"auto",theme:K2,animated:!0,defaultNodeSize:7,minNodeSize:5,maxNodeSize:15,lassoType:"none",glOptions:{}};try{Wl.displayName="GraphCanvas",Wl.__docgenInfo={description:"",displayName:"GraphCanvas",props:{theme:{defaultValue:{value:`{
  canvas: {
    background: '#fff'
  },
  node: {
    fill: '#7CA0AB',
    activeFill: '#1DE9AC',
    opacity: 1,
    selectedOpacity: 1,
    inactiveOpacity: 0.2,
    label: {
      color: '#2A6475',
      stroke: '#fff',
      activeColor: '#1DE9AC'
    },
    subLabel: {
      color: '#ddd',
      stroke: 'transparent',
      activeColor: '#1DE9AC'
    }
  },
  lasso: {
    border: '1px solid #55aaff',
    background: 'rgba(75, 160, 255, 0.1)'
  },
  ring: {
    fill: '#D8E6EA',
    activeFill: '#1DE9AC'
  },
  edge: {
    fill: '#D8E6EA',
    activeFill: '#1DE9AC',
    opacity: 1,
    selectedOpacity: 1,
    inactiveOpacity: 0.1,
    label: {
      stroke: '#fff',
      color: '#2A6475',
      activeColor: '#1DE9AC'
    }
  },
  arrow: {
    fill: '#D8E6EA',
    activeFill: '#1DE9AC'
  },
  cluster: {
    stroke: '#D8E6EA',
    opacity: 1,
    selectedOpacity: 1,
    inactiveOpacity: 0.1,
    label: {
      stroke: '#fff',
      color: '#2A6475'
    }
  }
}`},description:"Theme to use for the graph.",name:"theme",required:!1,type:{name:"Theme"}},cameraMode:{defaultValue:{value:"pan"},description:"Type of camera interaction.",name:"cameraMode",required:!1,type:{name:"enum",value:[{value:'"pan"'},{value:'"rotate"'},{value:'"orbit"'}]}},onCanvasClick:{defaultValue:null,description:"When the canvas was clicked but didn't hit a node/edge.",name:"onCanvasClick",required:!1,type:{name:"(event: MouseEvent) => void"}},lassoType:{defaultValue:{value:"none"},description:"The type of lasso selection.",name:"lassoType",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"all"'},{value:'"node"'},{value:'"edge"'}]}},onLasso:{defaultValue:null,description:"When the canvas had a lasso selection.",name:"onLasso",required:!1,type:{name:"(selections: string[]) => void"}},onLassoEnd:{defaultValue:null,description:"When the canvas had a lasso selection end.",name:"onLassoEnd",required:!1,type:{name:"(selections: string[]) => void"}},children:{defaultValue:null,description:"Children to render in the canvas. Useful for things like lights.",name:"children",required:!1,type:{name:"ReactNode"}},glOptions:{defaultValue:{value:"{}"},description:"Ability to extend Cavas gl options. For example { preserveDrawingBuffer: true }",name:"glOptions",required:!1,type:{name:"Object"}},layoutType:{defaultValue:{value:"forceDirected2d"},description:"Type of layout.",name:"layoutType",required:!1,type:{name:"enum",value:[{value:'"forceDirected2d"'},{value:'"forceDirected3d"'},{value:'"circular2d"'},{value:'"treeTd2d"'},{value:'"treeTd3d"'},{value:'"treeLr2d"'},{value:'"treeLr3d"'},{value:'"radialOut2d"'},{value:'"radialOut3d"'},{value:'"hierarchicalTd"'},{value:'"hierarchicalLr"'},{value:'"nooverlap"'},{value:'"forceatlas2"'},{value:'"custom"'}]}},selections:{defaultValue:null,description:"List of ids that are selected.",name:"selections",required:!1,type:{name:"string[]"}},actives:{defaultValue:null,description:"List of ids that are active.",name:"actives",required:!1,type:{name:"string[]"}},collapsedNodeIds:{defaultValue:null,description:"List of node ids that are collapsed.",name:"collapsedNodeIds",required:!1,type:{name:"string[]"}},animated:{defaultValue:{value:"true"},description:"Animate or not the graph positions.",name:"animated",required:!1,type:{name:"boolean"}},nodes:{defaultValue:null,description:"Nodes to pass to the graph.",name:"nodes",required:!0,type:{name:"GraphNode[]"}},edges:{defaultValue:null,description:"Edges to pass to the graph.",name:"edges",required:!0,type:{name:"GraphEdge[]"}},contextMenu:{defaultValue:null,description:"Context menu element.",name:"contextMenu",required:!1,type:{name:"(event: ContextMenuEvent) => ReactNode"}},sizingType:{defaultValue:{value:"default"},description:"Type of sizing for nodes.",name:"sizingType",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"pagerank"'},{value:'"centrality"'},{value:'"attribute"'},{value:'"default"'}]}},labelType:{defaultValue:{value:"auto"},description:"Type of visibility for labels.",name:"labelType",required:!1,type:{name:"enum",value:[{value:'"nodes"'},{value:'"edges"'},{value:'"none"'},{value:'"all"'},{value:'"auto"'}]}},edgeLabelPosition:{defaultValue:null,description:"Place of visibility for edge labels.",name:"edgeLabelPosition",required:!1,type:{name:"enum",value:[{value:'"below"'},{value:'"above"'},{value:'"inline"'},{value:'"natural"'}]}},edgeArrowPosition:{defaultValue:null,description:"Placement of edge arrows.",name:"edgeArrowPosition",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"mid"'},{value:'"end"'}]}},edgeInterpolation:{defaultValue:null,description:"Shape of edge.",name:"edgeInterpolation",required:!1,type:{name:"enum",value:[{value:'"linear"'},{value:'"curved"'}]}},labelFontUrl:{defaultValue:null,description:`Font of label, same as troika-three-text
The URL of a custom font file to be used. Supported font formats are: * .ttf * .otf * .woff (.woff2 is not supported)
Default: The Roboto font loaded from Google Fonts CDN`,name:"labelFontUrl",required:!1,type:{name:"string"}},sizingAttribute:{defaultValue:null,description:"Attribute based sizing property.",name:"sizingAttribute",required:!1,type:{name:"string"}},defaultNodeSize:{defaultValue:{value:"7"},description:"The default size to size nodes to. Default is 7.",name:"defaultNodeSize",required:!1,type:{name:"number"}},minNodeSize:{defaultValue:{value:"5"},description:"When using sizing attributes, the min size a node can be.",name:"minNodeSize",required:!1,type:{name:"number"}},maxNodeSize:{defaultValue:{value:"15"},description:"When using sizing attributes, the max size a node can be.",name:"maxNodeSize",required:!1,type:{name:"number"}},clusterAttribute:{defaultValue:null,description:"Attribute used for clustering.",name:"clusterAttribute",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Disable interactions or not.",name:"disabled",required:!1,type:{name:"boolean"}},draggable:{defaultValue:null,description:"Allow dragging of nodes.",name:"draggable",required:!1,type:{name:"boolean"}},renderNode:{defaultValue:null,description:"Render a custom node",name:"renderNode",required:!1,type:{name:"NodeRenderer"}},layoutOverrides:{defaultValue:null,description:"Advanced overrides for the layout.",name:"layoutOverrides",required:!1,type:{name:"LayoutOverrides"}},onNodeClick:{defaultValue:null,description:"When a node was clicked.",name:"onNodeClick",required:!1,type:{name:"(node: InternalGraphNode, props?: CollapseProps) => void"}},onNodeDoubleClick:{defaultValue:null,description:"When a node was double clicked.",name:"onNodeDoubleClick",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onNodeContextMenu:{defaultValue:null,description:"When a node context menu happened.",name:"onNodeContextMenu",required:!1,type:{name:"(node: InternalGraphNode, props?: NodeContextMenuProps) => void"}},onNodePointerOver:{defaultValue:null,description:"When node got a pointer over.",name:"onNodePointerOver",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onNodePointerOut:{defaultValue:null,description:"When node lost pointer over.",name:"onNodePointerOut",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onNodeDragged:{defaultValue:null,description:"Triggered after a node was dragged.",name:"onNodeDragged",required:!1,type:{name:"(node: InternalGraphNode) => void"}},onEdgeContextMenu:{defaultValue:null,description:"When a edge context menu happened.",name:"onEdgeContextMenu",required:!1,type:{name:"(edge?: InternalGraphEdge) => void"}},onEdgeClick:{defaultValue:null,description:"When an edge was clicked.",name:"onEdgeClick",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onEdgePointerOver:{defaultValue:null,description:"When edge got a pointer over.",name:"onEdgePointerOver",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onEdgePointerOut:{defaultValue:null,description:"When edge lost pointer over.",name:"onEdgePointerOut",required:!1,type:{name:"(edge: InternalGraphEdge) => void"}},onClusterClick:{defaultValue:null,description:"When a cluster was clicked.",name:"onClusterClick",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},onClusterPointerOver:{defaultValue:null,description:"When a cluster recieves a pointer over event.",name:"onClusterPointerOver",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},onClusterPointerOut:{defaultValue:null,description:"When cluster recieves a pointer leave event.",name:"onClusterPointerOut",required:!1,type:{name:"(cluster: ClusterEventArgs) => void"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<GraphCanvasRef>"}}}}}catch{}var Dm={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var a=arguments[i];if(a){var o=typeof a;if(o==="string"||o==="number")r.push(a);else if(Array.isArray(a)){if(a.length){var s=n.apply(null,a);s&&r.push(s)}}else if(o==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){r.push(a.toString());continue}for(var l in a)e.call(a,l)&&a[l]&&r.push(l)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(Dm);var tT=Dm.exports;const Cm=Vt(tT),nT="_container_155l7_1",rT="_disabled_155l7_7",iT="_contentContainer_155l7_10",aT="_contentInner_155l7_35",oT="_content_155l7_10",Ri={container:nT,disabled:rT,contentContainer:iT,contentInner:aT,content:oT},$l=({label:t,centralAngle:e,startAngle:n,endAngle:r,polar:i,radius:a,className:o,icon:s,innerRadius:l,skew:u,disabled:c,onClick:f})=>re.jsx("div",{role:"menuitem",className:Cm(Ri.container,o,{[Ri.disabled]:c}),style:{width:e>90?"100%":"50%",height:e>90?"100%":"50%",bottom:e>90?"50%":"initial",right:e>90?"50%":"initial",transform:`rotate(${n+r}deg) skew(${u}deg)`},onClick:d=>{c||f(d)},children:re.jsx("div",{className:Ri.contentContainer,style:{transform:`skew(${-u}deg) rotate(${(i?90:e)/2-90}deg)`},children:re.jsx("div",{className:Ri.contentInner,style:{top:`calc((((${e>90?"50% + ":""}${a}px) - ${l}px) / 2) - 4em)`},children:re.jsxs("div",{className:Ri.content,style:{transform:`rotate(${-r}deg)`},title:t,children:[s,t]})})})});try{$l.displayName="RadialSlice",$l.__docgenInfo={description:"",displayName:"RadialSlice",props:{startAngle:{defaultValue:null,description:"",name:"startAngle",required:!0,type:{name:"number"}},endAngle:{defaultValue:null,description:"",name:"endAngle",required:!0,type:{name:"number"}},skew:{defaultValue:null,description:"",name:"skew",required:!0,type:{name:"number"}},polar:{defaultValue:null,description:"",name:"polar",required:!0,type:{name:"boolean"}},centralAngle:{defaultValue:null,description:"",name:"centralAngle",required:!0,type:{name:"number"}},radius:{defaultValue:null,description:"",name:"radius",required:!0,type:{name:"number"}},innerRadius:{defaultValue:null,description:"",name:"innerRadius",required:!0,type:{name:"number"}},label:{defaultValue:null,description:"Label to display on the menu item.",name:"label",required:!0,type:{name:"string"}},className:{defaultValue:null,description:"CSS Classname to apply to the slice.",name:"className",required:!1,type:{name:"string"}},icon:{defaultValue:null,description:"Optional icon to display on the menu item.",name:"icon",required:!1,type:{name:"ReactNode"}},disabled:{defaultValue:null,description:"Optional callback to detemine if the menu item is active.",name:"disabled",required:!1,type:{name:"boolean"}},onClick:{defaultValue:null,description:"Optional callback to handle when the menu item is clicked.",name:"onClick",required:!1,type:{name:"(event: MouseEvent<HTMLDivElement, MouseEvent>) => void"}}}}}catch{}function sT(t,e){const n=360/t.length||360,r=n%180===0,i=90-n,a=r?45:e+i+n/2;return{centralAngle:n,polar:r,startAngle:a,deltaAngle:i}}const lT="_container_x9hyx_1",uT={container:lT},Hl=({items:t,radius:e,className:n,innerRadius:r,startOffsetAngle:i,onClose:a})=>{const{centralAngle:o,polar:s,startAngle:l,deltaAngle:u}=I.useMemo(()=>sT(t,i),[t,i]),c=I.useRef(null);return I.useLayoutEffect(()=>{const f=c.current;return()=>clearTimeout(f)},[]),t.length===0?null:re.jsx("div",{role:"menu",className:Cm(uT.container,n),onPointerEnter:()=>clearTimeout(c.current),onPointerLeave:f=>{clearTimeout(c.current),c.current=setTimeout(()=>a==null?void 0:a(f),500)},children:t.map((f,d)=>re.jsx($l,{...f,radius:e,innerRadius:r,startAngle:l,endAngle:o*d,skew:s?0:u,polar:s,centralAngle:o,onClick:h=>{f==null||f.onClick(h),a==null||a(h)}},d))})};Hl.defaultProps={radius:175,innerRadius:25,startOffsetAngle:0};try{Hl.displayName="RadialMenu",Hl.__docgenInfo={description:"",displayName:"RadialMenu",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"MenuItem[]"}},radius:{defaultValue:{value:"175"},description:"",name:"radius",required:!1,type:{name:"number"}},innerRadius:{defaultValue:{value:"25"},description:"",name:"innerRadius",required:!1,type:{name:"number"}},startOffsetAngle:{defaultValue:{value:"0"},description:"",name:"startOffsetAngle",required:!1,type:{name:"number"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(event: MouseEvent<HTMLDivElement, MouseEvent>) => void"}}}}}catch{}export{Wl as G,Hl as R,jl as S,zl as a,Ro as b,gT as c,oh as d,uE as e,cE as f,bT as g,K2 as l,Om as u};
//# sourceMappingURL=RadialMenu-a21554b3.js.map
